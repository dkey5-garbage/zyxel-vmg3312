<script language="javascript">
<!-- hide
var SysUpTime;

// wlan 
var enbl;
var syncNvram;
var channel;
var phy;
var gmode;
var nmode;
var wmode;
var nbwcap;
var band;
var nreqd;
var wlanInfo;
var wl_mode;
var wl_wep;
var wps;
var wpsAP;
var currChannel;
var wlSSID;
var wanLevel;

var MemUsgInfo;
var ResolveDnsInfo;
var dhcpEnbl;
var currfwLevel;
var supportwlan;
var wanInfo;
var timestamp;

var timeNow;
var ntp_enabled;

var sendUrl;

var ttnetnolimit = '<%ejGetOther(sysInfo, buildttnetnolimit)%>';
var supportVoip = '<%ejGetOther(sysInfo, buildVoip)%>';
var supportdsl = '<%ejGetOther(sysInfo, buildAtm)%>' | '<%ejGetOther(sysInfo, buildPtm)%>';
var supportethwan = '<%ejGetOther(sysInfo, buildEthWan)%>';
var support3GBackup ='<%ejGetOther(sysInfo, build3GBackup)%>';
var dslStatus = '<%ejGetOther(sysInfo, dslStatus)%>';
//var dslInfo1 = 'RX:<%ejGetOther(lineRate, 1, 0)%>/ TX:<%ejGetOther(lineRate, 0, 0)%> (Kbps)';
var dslInfo1= '<%ejGetOther(lineRate, 1, 0)%>';
var dslInfo0= '<%ejGetOther(lineRate, 0, 0)%>';
var eth0portStatus = '<%ejGetOther(ifStatus,LAN,eth0,status)%>';
var eth0maxBitRate = '<%ejGetOther(ifStatus,LAN,eth0,maxBitRate)%>';
var eth0duplexMode = '<%ejGetOther(ifStatus,LAN,eth0,duplexMode)%>';
var eth1portStatus = '<%ejGetOther(ifStatus,LAN,eth1,status)%>';
var eth1maxBitRate = '<%ejGetOther(ifStatus,LAN,eth1,maxBitRate)%>';
var eth1duplexMode = '<%ejGetOther(ifStatus,LAN,eth1,duplexMode)%>';
var eth2portStatus = '<%ejGetOther(ifStatus,LAN,eth2,status)%>';
var eth2maxBitRate = '<%ejGetOther(ifStatus,LAN,eth2,maxBitRate)%>';
var eth2duplexMode = '<%ejGetOther(ifStatus,LAN,eth2,duplexMode)%>';
var eth3portStatus = '<%ejGetOther(ifStatus,LAN,eth3,status)%>';
var eth3maxBitRate = '<%ejGetOther(ifStatus,LAN,eth3,maxBitRate)%>';
var eth3duplexMode = '<%ejGetOther(ifStatus,LAN,eth3,duplexMode)%>';
var ethWanportStatus = '<%ejGetOther(ifStatus,WAN,eth0,status)%>';
var ethWanmaxBitRate = '<%ejGetOther(ifStatus,WAN,eth0,maxBitRate)%>';
var ethWanduplexMode = '<%ejGetOther(ifStatus,WAN,eth0,duplexMode)%>';
var wwanStatus ='<%ejGetOther(sysInfo, wwan)%>';
var wwanquality ='<%ejGetOther(sysInfo, wwanquality)%>';
var maxSp = '<%ejGetVoice(maxSp)%>'; // MaxProfileCount
var maxLines = '<%ejGetVoice(maxLines)%>'; //MaxLineCount
var currentSp = '<%ejGetVoice(numSp)%>'; //current Profile count
var currentAcnt = '<%ejGetVoice(numLines)%>'; //current sip accounts
var wlDevice = '<%ejGetWl(wlDevice)%>';
var tmpvpn = '<%ejGetVoice(VPName)%>';
var tmplc = '<%ejGetVoice(linesPerVP)%>'; //number of lines per profile
var tmpuad  = '<%ejGetVoice(domainName)%>';

var tmpacntNum = '<%ejGetVoice(linecmaNum)%>';
var tmpphonenum   = '<%ejGetVoice(extension)%>';
var tmplineStatus = '<%ejGetVoice(lineStatus)%>'; // get line register status

var supportUPS = '0';
var objInfoXMLHTTP = null;
var initXdsl=0;

var ttnetfeature='<%ejGetOther(sysInfo,ttnetFeature)%>'; //TTNET feature
var isTTFeature = '<%ejGetOther(sysInfo, ttaawvFeature)%>';

wanLevel = '<%ejGetOther(sysInfo, wanStatus)%>';
dhcpEnbl = '<%ejGet(enblDhcpSrv)%>';
currfwLevel = '<%ejGet(fwLevel)%>';
supportwlan = '<%ejGetOther(sysInfo, numWlAdaptor)%>';
wanInfo = '<%ejGetOther(sysInfo, wanInfo)%>';
SysUpTime = '<%ejGetOther(sysUptime)%>';
MemUsgInfo = '<%ejGetOther(memUsgInfo)%>';
ResolveDnsInfo = '<%ejGetOther(resolveDnsInfo)%>';
NatSessionUsgInfo = '<%ejGetOther(NatSessionUsgInfo)%>';
timeNow = '<%ejGetOther(sysInfo, dateTime)%>';
ntp_enabled = "<%ejGetSntp(ntp_enabled)%>";
var WlschedulEnbl = "<%ejGetOther(wlschedule_Enable)%>"; 

//ipv6 start
var buildMstcIPv6 = '<%ejGetOther(sysInfo, buildMstcIPv6)%>';
var IPv6Addr = '<%ejGetOther(lanIpv6Addr)%>';
var enblLanIPv6 = '<%ejGetOther(enblIpv6Lan, all)%>';
//ipv6 end

var forEircom  = '<%ejGetOther(sysInfo, forEircom)%>';
var enblParentCtl = "<%ejGetOther(activeParentCtl)%>";

var showDSL='<%ejGetOther(sysInfo,ShowDSL)%>';
var etherInfo='<%ejGetOther(sysInfo,EtherInfo)%>';
var ttfeature='<%ejGetOther(sysInfo,ttFeature)%>';
var tthomegwfeature='<%ejGetOther(sysInfo,tthomegwFeature)%>';

if(ttnetfeature == '1'){
var IsStatusPage ='1';
}else{
var IsStatusPage ='0';
}
var myDate_end;	//_MSTC_, Linda, change refresh interval value but GUI didn't referesh automatically in status page.
for (var i = 0; i < currentSp; i++) {

	eval( "var vpn" + i + " \= \"\" " ); //vpName
	eval( "var lc" + i + " \= \"\" " );  //line count per profile
	eval( "var uad" + i + " \= \"\" " ); //domainName
	eval(tmplc);  
	for (var m = 0; m < eval("lc"+i); m++) {
		eval( "var ex" + i + "_" + m + " \= \"\" " );   //phone number
		eval( "var ls" + i + "_" + m + " \= \"\" " );   //line status
		eval( "var lcma" + i + "_" + m + " \= \"\" ");   //linecmaNum  		
	}
}
if ( tmpvpn.search("ejGetVoice") < 0 ){
	eval(tmpvpn);
}
if ( tmplc.search("ejGetVoice") < 0 ){
	eval(tmplc);
}
if ( tmpuad.search("ejGetVoice") < 0 ){
	eval(tmpuad);
}
if ( tmpphonenum.search("ejGetVoice") < 0 ) {
   eval( tmpphonenum );
}
if ( tmplineStatus.search("ejGetVoice") < 0 ) {
   eval( tmplineStatus );
}
if ( tmpacntNum.search("ejGetVoice") < 0 ) {
   eval( tmpacntNum );
}


function initXdslInfo()
{
	if(initXdsl==0)
	{	
		if( ttfeature == 1){
			initXdsl=1;
			var xdsltxt='';
			if(showDSL == 1){ 
				var xdslbuf=document.getElementById("xdslarea").value;
				var info =xdslbuf.split('============================================================================');
				for (var i=1;i<3;i++){
				   xdsltxt+=info[i];
				}
				document.getElementById("xdslInfo").value=xdsltxt;
				$('#getxdsl').hide();
			}
			else{
				 //_MSTC_,YingYu, statistic
				if( etherInfo != null){
					var linkstatus = etherInfo.split('|')[0];
					var linkRate = etherInfo.split('|')[1];
					if( linkstatus == 'NoLink')
						xdsltxt = "Link Status: Down" + "\nLink Rate: ";
					else
						xdsltxt = "Link Status: " + linkstatus + "\nLink Rate: " + linkRate + " M";
				}
				document.getElementById("xdslInfo").value=xdsltxt;
				$('#getxdsl').hide();
			}	
		}
		else{
			initXdsl=1;
			var xdslbuf=document.getElementById("xdslarea").value;
			var info =xdslbuf.split('============================================================================');
			var xdsltxt='';
			for (var i=1;i<3;i++){
			   xdsltxt+=info[i];
			}
			document.getElementById("xdslInfo").value=xdsltxt;
			$('#getxdsl').hide();
		}
	}
}

// dhcp info
function initDHCPInfo()
{
   var str = '';

   if (dhcpEnbl == '0')
      str = "<%ejGetML(MLG_Common_DHCPDisable)%>";
   else if (dhcpEnbl == '1')
      str = "<%ejGetML(MLG_Common_DHCPServer)%>";
   else if (dhcpEnbl == '2')
      str = "<%ejGetML(MLG_Common_DHCPRelay)%>";

   $('#dhcpInfo').html(str);
}

// wireless status
function initWLANinfo()
{
   if ( supportwlan == '0' )
   {
      //$('#wlanStatus').hide();
      $('#wpsinfoview').hide();
      $('#WlanStatusInfo').hide();
      $('#wpsinfoview').css('visibility', 'hidden');
      $('#WlanStatusInfo').css('visibility', 'hidden');
   }
   else 
   {
      if (enbl == '0') {
        if(WlschedulEnbl == '0') 
         $('#wlEnbl').html("<%ejGetML(MLG_Common_Off)%>");
        else
         $('#wlEnbl').html("<%ejGetML(MLG_Common_Off)%>(Scheduling)");
      } else if (enbl == '1') {
         $('#wlEnbl').html("<%ejGetML(MLG_Common_On)%>");
      }

      var channelInfo = '';
      if (channel == '0') {
         channelInfo = MLG_Makestring("<%ejGetML(MLG_ConnStatus_Status_Str14)%>", currChannel);
      } else {
         channelInfo = channel;
      }
      $('#channelInfo').html(channelInfo);


      $('#wlBssid').html(wlBssid);

      $('#wlSSID').html(wlSSID);

	if (forEircom == 1)
	{
		var securityInfo = '';
		var security_pwdInfo = '';
		var wlKeycheck128 = '<%ejGetWl(wlKeyBit)%>'
	      switch (wl_mode) {
	         case 'open': 
	            if (wl_wep == 'enabled') {
	               securityInfo += "<%ejGetML(MLG_Common_WEP)%>";
			 if (wlKeycheck128)
			 	security_pwdInfo += "<%ejGetWl(wl128Key1)%>";
			 else
			 	security_pwdInfo += "<%ejGetWl(wl64Key1)%>";
	            } else {
			securityInfo += "No Security";
			security_pwdInfo += "No Security";
	            }
	            break;
	         case 'wpa':
	         case 'WPA':
			securityInfo += "<%ejGetML(MLG_Common_WPA)%>";
			security_pwdInfo += "<%ejGetWl(wlWpaPsk)%>";
	            break;
	         case 'wpa2':
	         case 'WPA2':
	            securityInfo += "<%ejGetML(MLG_Common_WPA2)%>";
		     security_pwdInfo += "<%ejGetWl(wlWpaPsk)%>";
	            break;
	         case 'wpa wpa2':
	         case 'WPA1WPA2':
	            securityInfo += "<%ejGetML(MLG_Common_MixedWPAWPA2)%>";
		     security_pwdInfo += "<%ejGetWl(wlWpaPsk)%>";
	            break;
	         case 'psk':
	         case 'WPAPSK':
	            securityInfo += "<%ejGetML(MLG_Common_WPAPSK)%>";
		     security_pwdInfo += "<%ejGetWl(wlWpaPsk)%>";
	            break;
	         case 'psk2':
	         case 'WPA2PSK':
	            securityInfo += "<%ejGetML(MLG_Common_WPA2PSK)%>";
		     security_pwdInfo += "<%ejGetWl(wlWpaPsk)%>";
	            break;
	         case 'psk psk2':
	         case 'WPAPSKWPA2PSK':
	            securityInfo += "<%ejGetML(MLG_Common_MixedWPAWPA2PSK)%>";
		     security_pwdInfo += "<%ejGetWl(wlWpaPsk)%>";
	            break;
	      }
	      $('#securityInfo').html(securityInfo);
	      $('#security_pwdInfo').html(security_pwdInfo);
	}
	else
	{
	      var securityInfo = '';
	      switch (wl_mode) {
	         case 'open': 
	            if (wl_wep == 'enabled') {
	               securityInfo += "<%ejGetML(MLG_Common_WEP)%>";
	            } else {
	               securityInfo += "No Security";
	            }
	            break;
	         case 'wpa':
	         case 'WPA':
	            securityInfo += "<%ejGetML(MLG_Common_WPA)%>";
	            break;
	         case 'wpa2':
	         case 'WPA2':
	            securityInfo += "<%ejGetML(MLG_Common_WPA2)%>";
	            break;
	         case 'wpa wpa2':
	         case 'WPA1WPA2':
	            securityInfo += "<%ejGetML(MLG_Common_MixedWPAWPA2)%>";
	            break;
	         case 'psk':
	         case 'WPAPSK':
	            securityInfo += "<%ejGetML(MLG_Common_WPAPSK)%>";
	            break;
	         case 'psk2':
	         case 'WPA2PSK':
	            securityInfo += "<%ejGetML(MLG_Common_WPA2PSK)%>";
	            break;
	         case 'psk psk2':
	         case 'WPAPSKWPA2PSK':
	            securityInfo += "<%ejGetML(MLG_Common_MixedWPAWPA2PSK)%>";
	            break;
	      }
		
	      $('#securityInfo').html(securityInfo);
	}

      var modeInfo = '';
      if (phy == 'n') 
      {
         if (nmode == 'off' && gmode == '0') { // 54g b only
            modeInfo = "<%ejGetML(MLG_Common_80211b)%>";
         } else if (nmode == 'off' && gmode == '4') { // 54g performance
            modeInfo = "<%ejGetML(MLG_Common_80211g)%>";
         } else if (nmode == 'off' && gmode == '1') { // 54g auto
            modeInfo = "<%ejGetML(MLG_Common_80211bg)%>";
         } else if (nmode == 'auto' && nreqd == '1') { // 11n only
            modeInfo = "<%ejGetML(MLG_Common_80211n)%>";
         } else if (nmode == 'auto' && nreqd == '0') { // 11b/g/n
            modeInfo = "<%ejGetML(MLG_Common_80211bgn)%>"
         }
      }
      else 
      {
         if (gmode == '0') {
            modeInfo = "<%ejGetML(MLG_Common_80211b)%>";
         } else if (gmode == '1') {
            modeInfo = "<%ejGetML(MLG_Common_80211bg)%>";
         } else if (gmode == '4') {
            modeInfo = "<%ejGetML(MLG_Common_80211g)%>";
         }
      }
   	$('#modeInfo').html(modeInfo);


      //$('#WlanStatusInfo').show();
      $("#wlanInfo").html(wlanInfo);

      if ( wlanInfo != 'Disabled' ) 
      {
         var wlanRate='';

         if ((phy == 'n') && (nmode == 'auto')) 
         {
            // 11n mode
            switch (nbwcap) {
               case '0':
                  wlanRate = '144.5M';
                  break;
               case '1':
                  wlanRate = '300M';
                  break;
               case '2':
                  if (band == '1') {
                     // 5G
                     wlanRate = '300M';
                  } else {
                     wlanRate = '144.5M';
                  }
                  break;
               default:
                  break;
            } 
         } 
         else if (gmode == '0') 
         { 
            // 11b mode
            wlanRate = '11M';
         } else { 
            // 11g mode
            wlanRate = '54M';
         }
         $("#wlanRate").html(wlanRate);
      }
      else 
      {
         $("#wlanRate").html("N/A");
      }

      $('#wpsinfoview').show();
      var wpsInfo = '';

      if (wps == 'disabled') {
         wpsInfo = "Off";
      } else if (wps == 'enabled') {
         if ( wpsAP == '1' ) {
            wpsInfo = "<%ejGetML(MLG_Common_Configured)%>";
         } else {
            wpsInfo = "<%ejGetML(MLG_Common_Unconfigured)%>";
         }
      }
      $('#wpsInfo').html(wpsInfo);
	}
}

if(parseInt(supportwlan) > 0 && wlDevice == '0'){
   // BRCM WLAN adpter 1
   enbl = '<%ejGetWl(wlEnbl_wl0v0)%>' | '<%ejGetWl(wlEnbl_wl0v1)%>' | '<%ejGetWl(wlEnbl_wl0v2)%>' | '<%ejGetWl(wlEnbl_wl0v3)%>';
   syncNvram = '<%ejGetWl(wlSyncNvram)%>';
   channel = '<%ejGetWl(wlChannel)%>';
   phy = '<%ejGetWl(wlPhyType)%>';
   gmode = '<%ejGetWl(wlgMode)%>';
   nmode = '<%ejGetWl(wlNmode)%>';
   nbwcap = '<%ejGetWl(wlNBwCap)%>';
   band = '<%ejGetWl(wlBand)%>';
   nreqd = '<%ejGetWl(wlNReqd)%>';
   wlanInfo = '<%ejGetOther(ifStatus,WLAN,wl0,status)%>';
   wl_mode = '<%ejGetWl(wlAuthMode_wl0v0)%>';
   wl_wep = '<%ejGetWl(wlWep_wl0v0)%>';
   wps = '<%ejGetWl(wlWscMode)%>';
   wpsAP = '<%ejGetWl(wlWscAPMode)%>';
   currChannel = '<%ejGetWl(wlCurrentChannel)%>';
   wlSSID = '<%ejGetWl(wlSsid_wl0v0)%>';
   var wlBssid ='<%ejGetWl(wlBssid_wl0v0)%>';
   var wl0_bands = '<%ejGetWl(wlBands)%>';

   if(supportwlan == '2'){
   // BRCM WLAN adpter 2
   var wl1_enbl = '<%ejGetWl(SwlEnbl_wl0v0)%>' | '<%ejGetWl(SwlEnbl_wl0v1)%>' | '<%ejGetWl(SwlEnbl_wl0v2)%>' | '<%ejGetWl(SwlEnbl_wl0v3)%>';
   var wl1_channel = '<%ejGetWl(SwlChannel)%>';
   var wl1_Bssid =  '<%ejGetWl(SwlBssid_wl0v0)%>';
   var wl1_phy  = '<%ejGetWl(SwlPhyType)%>';
   var wl1_gmode = '<%ejGetWl(SwlgMode)%>';
   var wl1_nmode = '<%ejGetWl(SwlNmode)%>';
   var wl1_nbwcap = '<%ejGetWl(SwlNBwCap)%>';
   var wl1_band = '<%ejGetWl(SwlBand)%>';
   var wl1_nreqd= '<%ejGetWl(SwlNReqd)%>';
   var wlan2Info = '<%ejGetOther(ifStatus,WLAN,wl1,status)%>';
   var wl1_mode = '<%ejGetWl(SwlAuthMode_wl0v0)%>';
   var wl1_wep = '<%ejGetWl(SwlWep_wl0v0)%>';
   var wl1_wps = '<%ejGetWl(SwlWscMode)%>';
   var wl1_wpsAP = '<%ejGetWl(SwlWscAPMode)%>';
   var wl1_currChannel = '<%ejGetWl(SwlCurrentChannel)%>';
   var wl1_SSID = '<%ejGetWl(SwlSsid_wl0v0)%>';
   var wl1_bands = '<%ejGetWl(SwlBands)%>';
   }
}else if (supportwlan == '2' && wlDevice == '1'){
   // BRCM WLAN adpter 2
   var wl1_enbl = '<%ejGetWl(wlEnbl_wl0v0)%>' | '<%ejGetWl(wlEnbl_wl0v1)%>' | '<%ejGetWl(wlEnbl_wl0v2)%>' | '<%ejGetWl(wlEnbl_wl0v3)%>';
   syncNvram = '<%ejGetWl(wlSyncNvram)%>';
   var wl1_channel = '<%ejGetWl(wlChannel)%>';
   var wl1_Bssid =  '<%ejGetWl(wlBssid_wl0v0)%>';
   var wl1_phy  = '<%ejGetWl(wlPhyType)%>';
   var wl1_gmode = '<%ejGetWl(wlgMode)%>';
   var wl1_nmode = '<%ejGetWl(wlNmode)%>';
   var wl1_nbwcap = '<%ejGetWl(wlNBwCap)%>';
   var wl1_band = '<%ejGetWl(wlBand)%>';
   var wl1_nreqd= '<%ejGetWl(wlNReqd)%>';
   var wlan2Info = '<%ejGetOther(ifStatus,WLAN,wl1,status)%>';
   var wl1_mode = '<%ejGetWl(wlAuthMode_wl0v0)%>';
   var wl1_wep = '<%ejGetWl(wlWep_wl0v0)%>';
   var wl1_wps = '<%ejGetWl(wlWscMode)%>';
   var wl1_wpsAP = '<%ejGetWl(wlWscAPMode)%>';
   var wl1_currChannel = '<%ejGetWl(wlCurrentChannel)%>';
   var wl1_SSID = '<%ejGetWl(wlSsid_wl0v0)%>';
   var wl1_bands = '<%ejGetWl(wlBands)%>';

   enbl = '<%ejGetWl(SwlEnbl_wl0v0)%>' | '<%ejGetWl(SwlEnbl_wl0v1)%>' | '<%ejGetWl(SwlEnbl_wl0v2)%>' | '<%ejGetWl(SwlEnbl_wl0v3)%>';
   channel = '<%ejGetWl(SwlChannel)%>';
   phy = '<%ejGetWl(SwlPhyType)%>';
   gmode = '<%ejGetWl(SwlgMode)%>';
   nmode = '<%ejGetWl(SwlNmode)%>';
   nbwcap = '<%ejGetWl(SwlNBwCap)%>';
   band = '<%ejGetWl(SwlBand)%>';
   nreqd = '<%ejGetWl(SwlNReqd)%>';
   wlanInfo = '<%ejGetOther(ifStatus,WLAN,wl0,status)%>';
   wl_mode = '<%ejGetWl(SwlAuthMode_wl0v0)%>';
   wl_wep = '<%ejGetWl(SwlWep_wl0v0)%>';
   wps = '<%ejGetWl(SwlWscMode)%>';
   wpsAP = '<%ejGetWl(SwlWscAPMode)%>';
   currChannel = '<%ejGetWl(SwlCurrentChannel)%>';
   wlSSID = '<%ejGetWl(SwlSsid_wl0v0)%>';
   var wlBssid ='<%ejGetWl(SwlBssid_wl0v0)%>';
   var wl0_bands = '<%ejGetWl(SwlBands)%>';
}

function initWLAN2info()
{
   if ( supportwlan != '2' )
   {
      //$('#wlanStatus').hide();
      $('#wl1_wpsinfoview').hide();
      $('#Wlan2StatusInfo').hide();
      $('#wl1_wpsinfoview').css('visibility', 'hidden');
      $('#Wlan2StatusInfo').css('visibility', 'hidden');
   }
   else 
   {
      $("#wlan2Info").html(wlan2Info);
      $('#wl1Bssid').html(wl1_Bssid);
      $('#wl1SSID').html(wl1_SSID);

      if (wl1_enbl == '0') {
        if(WlschedulEnbl == '0') 
         $('#wl1Enbl').html("<%ejGetML(MLG_Common_Off)%>");
        else
         $('#wl1Enbl').html("<%ejGetML(MLG_Common_Off)%>(Scheduling)");
      } else if (wl1_enbl == '1') {
         $('#wl1Enbl').html("<%ejGetML(MLG_Common_On)%>");
      }

      var channelInfo = '';
      if (wl1_channel == '0') {
         channelInfo = MLG_Makestring("<%ejGetML(MLG_ConnStatus_Status_Str14)%>", wl1_currChannel);
      } else {
         channelInfo = wl1_channel;
      }
      $('#wl1_channelInfo').html(channelInfo);



      var securityInfo = '';
      switch (wl1_mode) {
         case 'open': 
            if (wl1_wep == 'enabled') {
               securityInfo += "<%ejGetML(MLG_Common_WEP)%>";
            } else {
               securityInfo += "No Security";
            }
            break;
         case 'wpa':
         case 'WPA':
            securityInfo += "<%ejGetML(MLG_Common_WPA)%>";
            break;
         case 'wpa2':
         case 'WPA2':
            securityInfo += "<%ejGetML(MLG_Common_WPA2)%>";
            break;
         case 'wpa wpa2':
         case 'WPA1WPA2':
            securityInfo += "<%ejGetML(MLG_Common_MixedWPAWPA2)%>";
            break;
         case 'psk':
         case 'WPAPSK':
            securityInfo += "<%ejGetML(MLG_Common_WPAPSK)%>";
            break;
         case 'psk2':
         case 'WPA2PSK':
            securityInfo += "<%ejGetML(MLG_Common_WPA2PSK)%>";
            break;
         case 'psk psk2':
         case 'WPAPSKWPA2PSK':
            securityInfo += "<%ejGetML(MLG_Common_MixedWPAWPA2PSK)%>";
            break;
      }
      $('#wl1_securityInfo').html(securityInfo);

      var modeInfo = '';
      if (wl1_phy == 'v' && wl1_band == '1') 
      {
         if (wl1_nmode == 'off' && wl1_gmode == '0') { // a only
            modeInfo = "<%ejGetML(MLG_Common_80211a)%>";
         } else if (wl1_nmode == 'auto' && wl1_nreqd == '0' && wl1_nbwcap !='3' ) { // 11a/n
            modeInfo = "<%ejGetML(MLG_Common_80211an)%>";
         } else if (wl1_nmode == 'auto' && wl1_nreqd == '1' && wl1_nbwcap !='3' ) { // 11n only
            modeInfo = "<%ejGetML(MLG_Common_80211n)%>"
         }else if (wl1_nmode == 'auto' && wl1_nreqd == '0' && wl1_nbwcap =='3' ) { 
            modeInfo = "<%ejGetML(MLG_Common_80211anac)%>"
         }else if (wl1_nmode == 'auto' && wl1_nreqd == '1' && wl1_nbwcap =='3' ) { 
            modeInfo = "<%ejGetML(MLG_Common_80211nac)%>"
         }
      }
      else 
      {
       modeInfo = "N/A";
	  }

   	$('#wl1_modeInfo').html(modeInfo);


      //$('#WlanStatusInfo').show();
	  

      if ( wlan2Info != 'Disabled' ) 
      {
         var wlanRate='';

         if ((wl1_phy == 'v') && (wl1_nmode == 'auto')) 
         {
            // 11n mode
            switch (wl1_nbwcap) {
               case '0':
                  wlanRate = '225M';
                  break;
               case '1':
                  wlanRate = '450M';
                  break;
               case '2':
                  if (wl1_band == '1') {
                     // 5G
                     wlanRate = '450M';
                  } else {
                     wlanRate = '225M';
                  }
                  break;
			   case '3':
                     wlanRate = '1.3G';
                  break;
               default:
                  break;
            } 
         } 
         else{ 
            // 11a mode
            wlanRate = '54M';
         }
         $("#wlan2Rate").html(wlanRate);
      }
      else 
      {
         $("#wlan2Rate").html("N/A");
      }

      $('#wpsinfoview').show();
      var wpsInfo = '';

      if (wl1_wps == 'disabled') {
         wpsInfo = "Off";
      } else if (wl1_wps == 'enabled') {
         if ( wpsAP == '1' ) {
            wpsInfo = "<%ejGetML(MLG_Common_Configured)%>";
         } else {
            wpsInfo = "<%ejGetML(MLG_Common_Unconfigured)%>";
         }
      }
      $('#wl1_wpsInfo').html(wpsInfo);
	}
}
function sendControl () {
   BackgroundUrl(sendUrl);
   updateValue_take();
}

function IPoEControl( cmd, intf) {
   var msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_ConnectionStatus_AlertMsg_Str2)%>",intf)+'\n'+'<%ejGetML(MLG_ConnStatus_ConnectionStatus_AlertMsg_Str5)%>';

   sendUrl = 'connectionStatus-setipoerenew.cgi?intfName=' + intf + '&ipoeRenewAct=' + cmd + '&sessionKey=' + glbSessionKey;
   ConfirmOpen(msg , sendControl, frmLoad);
}

function PPPControl( cmd, intf ) {
   var msg = MLG_Makestring("<%ejGetML(MLG_ConnStatus_ConnectionStatus_AlertMsg_Str3)%>",intf, cmd)+'\n'+'<%ejGetML(MLG_ConnStatus_ConnectionStatus_AlertMsg_Str5)%>';

   sendUrl = 'connectionStatus-Setppp'+cmd+'.cgi?intfName='+intf + "&sessionKey=" + glbSessionKey;
   ConfirmOpen(msg , sendControl, frmLoad);
}

// wan info
function initWanInfo () {
   //Routing: WAN Type|IfName|connection status|Encapsulation|MAC addr|DHCP or Static|IP addr|<IP Mask>| uptime |
   //         IPv6 ConnStatus| IPv6 Uptime| WAN type@
   // Bridge: WAN Type|IfName|connection status|Encapsulation
   // if defined MSTC_IPV6
   // Routing and IPv4 only: WAN Type|IfName|connection status|Encapsulation|MAC addr|DHCP or Static|IP addr|IP Mask|
   //                        IPv6 mode|6RD|<6RD relay server addr>@
   // Routing and Dual Stack: WAN Type|IfName|connection status|Encapsulation|MAC addr|DHCP or Static|IP addr|IP Mask|
   //                        IPv6 mode|IPv6 global addr(s)|<IPv6 link local addr>@
   // Routing and IPv6 only: WAN Type|IfName|connection status|Encapsulation|MAC addr|DHCP or Static|IP addr|IP Mask|
   //                        IPv6 mode|IPv6 global addr(s)|IPv6 link local addr|DS-Lite|<DS-Lite relay server addr>@
   // Bridge: WAN Type|<Encapsulation>@

   wanInfo = wanInfo.replace(/%/ig, '/');
   var i = 0;
   var wan = wanInfo.split('@');
   var str = '';

   for ( i = 0; i < wan.length; i++ ) {
      if (wan[i] != '') {
         var fields = wan[i].split('|');

         if (fields != '' && ( ((fields[2] == 'Connected')&&(fields[11] =='IPv4')) ||((fields[17] == 'Connected')&&(fields[11] =='IPv6')) 
		 	|| (((fields[2] == 'Connected')||(fields[15] == 'Connected'))&&(fields[11] =='DualStack')) )) {
            if (fields[1] == 'Bridge'){
               // Bridge
               str += '<tr>';
               str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str6)%></td>';
               str += '  <td class="table_font w_blue">' + fields[0] + '</td>';
               str += '</tr>';
			   str += '<tr>';
               str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_WanName)%></td>';
               str += '  <td class="table_font w_blue">' + fields[17]+'/'+fields[1] + '</td>';
               str += '</tr>';
               str += '<tr>';
               str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str7)%>:</td>';
               str += '  <td class="table_font w_blue">' + fields[3] + '</td>';
               str += '</tr>';
            } else {
               // Routing
               str += '<tr>';
               str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str6)%></td>';
               str += '  <td class="table_font w_blue">' + fields[0] + '</td>';
               str += '</tr>';
			   str += '<tr>';
               str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_WanName)%></td>';
               str += '  <td class="table_font w_blue">' + fields[17]+'/'+fields[1] + '</td>';
               str += '</tr>';
			   if(fields[0]!='Cellular')
			   {
			   	 if(fields[3] != 'IPoA'){	
               			str += '<tr>';
               			str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_MACAddress)%>:</td>';
               			str += '  <td class="table_font w_blue">' + fields[4] + '</td>';
               			str += '</tr>';
			   	 }
			   }	
               if( buildMstcIPv6 == '1' )
               {
               	if(fields[11] == 'IPv4')
                  {
               		if(forEircom==1) /*jennifer*/
			   		{
               		str += '<tr>';
               		str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_EircomBoardband)%></td>';
               		str += '  <td class="table_font w_blue">' + fields[2] + '</td>';
               		str += '</tr>';
					
						if(fields[0]=='ATM' || fields[0]=='PTM')
						{
							var adslMode = "<%ejGetOther(adslMode)%>";
         					var adslModeField = adslMode.split('|');
							if(adslModeField != '')
							{
               					str += '<tr>';
               					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_WanName)%></td>';
               					str += '  <td class="table_font w_blue">' + adslModeField[0] + '</td>';
               					str += '</tr>';
               					str += '<tr>';
               					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_LineAttenuation)%></td>';
               					str += '  <td class="table_font w_blue">' + adslModeField[1] + '</td>';
               					str += '</tr>';
							}
							
							
						}
					
			   		}
                    str += '<tr>';
                     str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPAddress)%>:</td>';
                     if(!((fields[3] == 'PPPoA') || (fields[3] == 'PPPoE')))
                     {
                        // IPoE, use Release, Renew
                        if(fields[5] == 'DHCP') {
                           /*if(fields[6] == '0.0.0.0') {
                              // renew
                              str += '  <td class="table_font w_blue">' + fields[6];
                              str += '    &nbsp;&nbsp;<input type=button value="<%ejGetML(MLG_Common_Renew)%>" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" >';
                              //str += '    &nbsp;&nbsp;<input type=button value="Release" onClick="IPoEControl(\'0\',\'' + fields[1] + '\');" disabled>';
                              str += '  </td>';
                           } else {*/
                           if(fields[6] != '0.0.0.0') {
                              // release
                              str += '  <td class="table_font w_blue">' + fields[6];
                              //str += '    &nbsp;&nbsp;<input type="button" value="Renew" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" disabled />';
							  if(isTTFeature == '1')
								str += '    &nbsp;&nbsp;<input type="button" value="<%ejGetML(MLG_Common_RenewIP)%>" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" />';
							  else
                              	str += '    &nbsp;&nbsp;<input type="button" value="<%ejGetML(MLG_Common_Release)%>" onClick="IPoEControl(\'0\',\'' + fields[1] + '\');" />';
                              str += '  </td>';
                           }
                        } else {
                           str += '  <td class="table_font w_blue">' + fields[6] + '</td>';
                        }
                     }
                     else
                     {
                        // PPP, use Up, Down
                        if(fields[2] == 'Connected') {
                           str += '  <td class="table_font w_blue">' + fields[6];
                           str += '    &nbsp;&nbsp;<input type=button onClick="PPPControl(\'Down\', \'' + fields[1] + '\');" value="<%ejGetML(MLG_Common_Disconnect)%>" />';
                           str += '  </td>';
                        } 
//only show connected
                        /*else {
                           str += '  <td class="table_font w_blue">' + fields[6];
                           str += '    &nbsp;&nbsp;<input type=button  onClick="PPPControl(\'Up\', \'' + fields[1] + '\');" value="<%ejGetML(MLG_Common_Connect)%>" />';
                           str += '  </td>';
                        }*/
                     }
                     str += '</tr>';

                    if(!((fields[3] == 'PPPoA') || (fields[3] == 'PPPoE')))	{
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPSubnetMask)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[7] + '</td>';
                        str += '</tr>';
                     }

                    //Add uptime
                    if(fields[2] == 'Connected') {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_UpTime)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[14];
                        str += '  </td>';
                        str += '</tr>';
                     }

                     if(fields[12] == '1'){
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str98)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[13] + '</td>';
                        str += '</tr>';
                     }

					//IPv6 uptime
					 if(fields[15] == 'Connected') {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_v6UpTime)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[16];
                        str += '  </td>';
                        str += '</tr>';
                     }
					 if(fields[10] == 'y'){
						str += '<tr>';
						str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_Primary_DNS_server)%>:</td>';
						str += '  <td class="table_font w_blue">' + fields[8] + '</td>';
                        str += '</tr>';

						str += '<tr>';
						str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_Secondary_DNS_server)%>:</td>';
						str += '  <td class="table_font w_blue">' + fields[9] + '</td>';
						str += '</tr>';

                     }
                  }
                  else if(fields[11] == 'DualStack')
                  {
               		if(forEircom==1) /*jennifer*/
			   		{
               		str += '<tr>';
               		str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_EircomBoardband)%></td>';
               		str += '  <td class="table_font w_blue">' + fields[2] + '</td>';
               		str += '</tr>';

					if(fields[0]=='ATM' || fields[0]=='PTM')
						{
							var adslMode = "<%ejGetOther(adslMode)%>";
         					var adslModeField = adslMode.split('|');
							if(adslModeField != '')
							{
               					str += '<tr>';
               					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_WanName)%></td>';
               					str += '  <td class="table_font w_blue">' + adslModeField[0] + '</td>';
               					str += '</tr>';
               					str += '<tr>';
               					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_LineAttenuation)%></td>';
               					str += '  <td class="table_font w_blue">' + adslModeField[1] + '</td>';
               					str += '</tr>';
							}
							
							
						}
			   		}
                     if( fields[2] == 'Connected' ) //If IPv4 is connected.
                     {
                     str += '<tr>';
                     str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPAddress)%>:</td>';
                     if(!((fields[3] == 'PPPoA') || (fields[3] == 'PPPoE')))
                     {
                        // IPoE, use Release, Renew
                        if(fields[5] == 'DHCP') {
                           /*if(fields[6] == '0.0.0.0') {
                              // renew
                              str += '  <td class="table_font w_blue">' + fields[6];
                              str += '    &nbsp;&nbsp;<input type=button value="<%ejGetML(MLG_Common_Renew)%>" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" >';
                              //str += '    &nbsp;&nbsp;<input type=button value="Release" onClick="IPoEControl(\'0\',\'' + fields[1] + '\');" disabled>';
                              str += '  </td>';
                           } else {*/
//only show connected
				  if(fields[6] != '0.0.0.0') {
                              // release
                              str += '  <td class="table_font w_blue">' + fields[6];
                              //str += '    &nbsp;&nbsp;<input type="button" value="Renew" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" disabled />';
							  if(isTTFeature == '1')
								str += '    &nbsp;&nbsp;<input type="button" value="<%ejGetML(MLG_Common_RenewIP)%>" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" />';
							  else
                                str += '    &nbsp;&nbsp;<input type="button" value="<%ejGetML(MLG_Common_Release)%>" onClick="IPoEControl(\'0\',\'' + fields[1] + '\');" />';
                              str += '  </td>';
                           }
                        } else {
                           str += '  <td class="table_font w_blue">' + fields[6] + '</td>';
                        }
                     }
                     else
                     {
                        // PPP, use Up, Down
                        if(fields[2] == 'Connected') {
                           str += '  <td class="table_font w_blue">' + fields[6];
                           str += '    &nbsp;&nbsp;<input type=button onClick="PPPControl(\'Down\', \'' + fields[1] + '\');" value="<%ejGetML(MLG_Common_Disconnect)%>" />';
                           str += '  </td>';
                        } 
			   //only show connected
/*			   else {
                           str += '  <td class="table_font w_blue">' + fields[6];
                           str += '    &nbsp;&nbsp;<input type=button  onClick="PPPControl(\'Up\', \'' + fields[1] + '\');" value="<%ejGetML(MLG_Common_Connect)%>" />';
                           str += '  </td>';
                        }*/
                     }
                     str += '</tr>';

                    if(!((fields[3] == 'PPPoA') || (fields[3] == 'PPPoE'))) {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPSubnetMask)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[7] + '</td>';
                        str += '</tr>';
                     }

                    //Add uptime
                    if(fields[2] == 'Connected') {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_UpTime)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[14];
                        str += '  </td>';
                        str += '</tr>';
                     }
			}
			if( fields[15] == 'Connected' ) //If IPv6 is connected.
			{
                     //var globalAddr = fields[9].split(',');
                     str += '<tr>';
                     str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPv6Address)%>:</td>';
                     /*if(globalAddr != ''){
                        if(globalAddr.length == 1)
                        {
                           str += '  <td class="table_font w_blue">' + globalAddr + '</td>';
                        }
                        else
                        {
                           str += '  <table border=\"0\">';
                           for(var i = 0;i < globalAddr.length; i++)
                           {
                              str += '<tr><td>&nbsp;&nbsp;' + globalAddr[i] + '</td></tr>';
                           }
                        }
                        str += '  </table>';
                     }*/
                     /*if(globalAddr != ''){
                        str += '  <table border=\"0\">';
                        for(var i = 0;i < globalAddr.length; i++)
                        {
                           str += '<tr><td>&nbsp;&nbsp;' + globalAddr[i] + '</td></tr>';
                        }
                        str += '  </table>';
                     }*/
                     if(fields[12] != ''){
                        str += '  <td class="table_font w_blue textOverflow">' + fields[12] + '</td>';
                     }
                     else{
                        str += '  <td class="table_font w_blue textOverflow">' + '::' + '</td>';
                     }
                     str += '</tr>';

                     str += '<tr>';
                     str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str81)%>:</td>';
                     if(fields[13] != ''){
                        str += '  <td class="table_font w_blue textOverflow">' + fields[13] + '</td>';
                     }
                     else{
                        str += '  <td class="table_font w_blue textOverflow">' + '::' + '</td>';
                     }
                     str += '</tr>';

					//IPv6 uptime
					 if(fields[15] == 'Connected') {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_v6UpTime)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[16];
                        str += '  </td>';
                        str += '</tr>';
                     }
			}
					 
					 if(fields[10] == 'y'){
						str += '<tr>';
						str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_Primary_DNS_server)%>:</td>';
						str += '  <td class="table_font w_blue">' + fields[8] + '</td>';
						str += '</tr>';

						str += '<tr>';
						str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_Secondary_DNS_server)%>:</td>';
						str += '  <td class="table_font w_blue">' + fields[9] + '</td>';
						str += '</tr>';
                  	}
                  }
                  else if(fields[11] == 'IPv6')
                  {
                	if(forEircom==1) /*jennifer*/
			   		{
               		str += '<tr>';
               		str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_EircomBoardband)%></td>';
               		str += '  <td class="table_font w_blue">' + fields[2] + '</td>';
               		str += '</tr>';
					if(fields[0]=='ATM' || fields[0]=='PTM')
						{
							var adslMode = "<%ejGetOther(adslMode)%>";
         					var adslModeField = adslMode.split('|');
							if(adslModeField != '')
							{
               					str += '<tr>';
               					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_WanName)%></td>';
               					str += '  <td class="table_font w_blue">' + adslModeField[0] + '</td>';
               					str += '</tr>';
               					str += '<tr>';
               					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_LineAttenuation)%></td>';
               					str += '  <td class="table_font w_blue">' + adslModeField[1] + '</td>';
               					str += '</tr>';
							}
							
							
						}
			   		}
                   //Add uptime
                    if(fields[2] == 'Connected') {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_UpTime)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[16];
                        str += '  </td>';
                        str += '</tr>';
                    }

         //var globalAddr = fields[12].split(',');
                     str += '<tr>';
                     str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPv6Address)%>:</td>';
                     /*if(globalAddr != ''){
                        str += '  <table border=\"0\">';
                        for(var i = 0;i < globalAddr.length; i++)
                        {
                           str += '<tr><td>&nbsp;&nbsp;' + globalAddr[i] + '</td></tr>';
                        }
                        str += '  </table>';
                     }*/
                     if(fields[12] != ''){
                        str += '  <td class="table_font w_blue textOverflow">' + fields[12] + '</td>';
                     }
                     else{
                        str += '  <td class="table_font w_blue textOverflow">' + '::' + '</td>';
                     }
                     str += '</tr>';

                     str += '<tr>';
                      str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str81)%>:</td>';
                     if(fields[13] != ''){
                        str += '  <td class="table_font w_blue textOverflow">' + fields[13] + '</td>';
                     }
                     else{
                        str += '  <td class="table_font w_blue textOverflow">' + '::' + '</td>';
                     }
                     str += '</tr>';

					//IPv6 uptime
					if(fields[17] == 'Connected') {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_v6UpTime)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[18];
                        str += '  </td>';
                        str += '</tr>';
                    }

                     if(fields[14] == '1'){
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str82)%>:</td>';
                        str += '  <td class="table_font w_blue textOverflow">' + fields[15] + '</td>';
                        str += '</tr>';
                     }
                  }
               }
               else
               {
                 str += '<tr>';
                  str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPAddress)%>:</td>';

                  if(!((fields[3] == 'PPPoA') || (fields[3] == 'PPPoE')))
                  {
                     // IPoE, use Release, Renew
                     if(fields[5] == 'DHCP') {
                        /*if(fields[6] == '0.0.0.0') {
                           // renew
                           str += '  <td class="table_font w_blue">' + fields[6];
                           str += '    &nbsp;&nbsp;<input type=button value="<%ejGetML(MLG_Common_Renew)%>" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" >';
                           //str += '    &nbsp;&nbsp;<input type=button value="Release" onClick="IPoEControl(\'0\',\'' + fields[1] + '\');" disabled>';
                           str += '  </td>';
                        } else {*/
			   //only show connected
			      if(fields[6] != '0.0.0.0') {
                           // release
                           str += '  <td class="table_font w_blue">' + fields[6];
                           //str += '    &nbsp;&nbsp;<input type="button" value="Renew" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" disabled />';
						   if(isTTFeature == '1')
							 str += '    &nbsp;&nbsp;<input type="button" value="<%ejGetML(MLG_Common_RenewIP)%>" onClick="IPoEControl(\'1\',\'' + fields[1] + '\');" />';
						   else
                             str += '    &nbsp;&nbsp;<input type="button" value="<%ejGetML(MLG_Common_Release)%>" onClick="IPoEControl(\'0\',\'' + fields[1] + '\');" />';
                           str += '  </td>';
                        }
                     } else {
                        str += '  <td class="table_font w_blue">' + fields[6] + '</td>';
                     }
                  }
                  else
                  {
                     // PPP, use Up, Down
                     if(fields[2] == 'Connected') {
                        str += '  <td class="table_font w_blue">' + fields[6];
                        str += '    &nbsp;&nbsp;<input type=button onClick="PPPControl(\'Down\', \'' + fields[1] + '\');" value="<%ejGetML(MLG_Common_Disconnect)%>" />';
                        str += '  </td>';
                     }
			//only show connected
			/*
			else {
                        str += '  <td class="table_font w_blue">' + fields[6];
                        str += '    &nbsp;&nbsp;<input type=button  onClick="PPPControl(\'Up\', \'' + fields[1] + '\');" value="<%ejGetML(MLG_Common_Connect)%>" />';
                        str += '  </td>';
                     }*/
                  }

                  str += '</tr>';

                  if(!((fields[3] == 'PPPoA') || (fields[3] == 'PPPoE'))) {
                     str += '<tr>';
                     str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPSubnetMask)%>:</td>';
                     str += '  <td class="table_font w_blue">' + fields[7] + '</td>';
                     str += '</tr>';
                  }
                    //Add uptime
                    if(fields[2] == 'Connected') {
                        str += '<tr>';
                        str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_UpTime)%>:</td>';
                        str += '  <td class="table_font w_blue">' + fields[14];
                        str += '  </td>';
                        str += '</tr>';
                    }

				 if(fields[10] == 'y'){	
					str += '<tr>';
					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_Primary_DNS_server)%>:</td>';
					str += '  <td class="table_font w_blue">' + fields[8] + '</td>';
					str += '</tr>';

					str += '<tr>';
					str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_Secondary_DNS_server)%>:</td>';
					str += '  <td class="table_font w_blue">' + fields[9] + '</td>';
					str += '</tr>';
				 }  
               }
               str += '<tr>';
               str += '  <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str7)%>:</td>';
               str += '  <td class="table_font w_blue">' + fields[3] + '</td>';
               str += '</tr>';
            }

             str += '<tr>';
             str += '  <td class="table_font" colspan="2" >&nbsp;</td>';
             str += '</tr>';
         }
      }
   }

	$('#wanInfo').html(str);
}
function doOpenWindow(id){

	switch (id)
	{

		case 16:
			var loc = '/pages/connectionStatus/connectionStatus-wwan.cmd?action=Puk';
			loc += '&sessionKey=' + glbSessionKey;
			var db1 = window.parent.$.zyUiDialog({
		width: 500,
		height: 450,
		title: '<%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Need_PUK)%>',
		
		buttons: {
                 '<%ejGetML(MLG_Common_Cancel)%>': function(){ db1.dialog('close') },
                 '<%ejGetML(MLG_Common_Apply)%>':function(){}
		}
		});
		db1.load(loc);
		db1.dialog('open');
			break;
		case 17:
			var loc = '/pages/connectionStatus/connectionStatus-wwan.cmd?action=DamagedSIM';
			loc += '&sessionKey=' + glbSessionKey;
			var db1 = window.parent.$.zyUiDialog({
		width: 450,
		height: 300,
		title: '<%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Damaged_SIM)%>',
		
		buttons: {
		   '<%ejGetML(MLG_Common_OK)%>': function(){ db1.dialog('close'); }
		}
		});
		db1.load(loc);
		db1.dialog('open');
			break;
		case 20:
			var loc = '/pages/connectionStatus/connectionStatus-wwan.cmd?action=NoResp';
			loc += '&sessionKey=' + glbSessionKey;
			var db1 = window.parent.$.zyUiDialog({
		width: 450,
		height: 300,
		title: '<%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_No_Response)%>',

		buttons: {
		   '<%ejGetML(MLG_Common_OK)%>': function(){ db1.dialog('close'); }
		}
		});
		db1.load(loc);
		db1.dialog('open');
			break;
		case 21:
			var loc = '/pages/connectionStatus/connectionStatus-wwan.cmd?action=Pin';
			loc += '&sessionKey=' + glbSessionKey;
			var db1 = window.parent.$.zyUiDialog({
		width: 500,
		height: 400,
		title: '<%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Need_PIN)%>',
		
		buttons: {
                 '<%ejGetML(MLG_Common_Cancel)%>': function(){ db1.dialog('close') },
                 '<%ejGetML(MLG_Common_Apply)%>':function(){}
		}
		});
		db1.load(loc);
		db1.dialog('open');
			break;
	}
}
// VoIP info
function initVoipInfo()
{
	if ( supportVoip != '1' ) {
		$("#voipTable").hide();
		return;
	}
	else {
		$("#voipTable").show();
		
		eval(tmplineStatus);	// update lineStatus for updatenetworkMapInfo()
		
		var sp , j ;
		for (sp = 0; sp < currentSp; sp++) {
			for(j = 0; j < eval("lc"+sp); j++){	
				var acntNum = eval("lcma" + sp+"_" +j); 
				// Show lineStatus
				var idName = "lineStatus"+acntNum;
				//_MSTC_, Linda, Change to Turkey Language.
				if( eval("ls"+sp+"_"+j) == 'Inactive')
					document.getElementById(idName).innerHTML ='<%ejGetML(MLG_VoIP_Inactive)%>';
				else if( eval("ls"+sp+"_"+j) == 'OnRegister')
					document.getElementById(idName).innerHTML ='<%ejGetML(MLG_VoIP_Registered_Onregister)%>';
				else if( eval("ls"+sp+"_"+j) == 'Not Registered')
					document.getElementById(idName).innerHTML ='<%ejGetML(MLG_VoIP_Registered_Notregister)%>';
				else
					document.getElementById(idName).innerHTML = eval("ls"+sp+"_"+j);
				//_MSTC_, Linda, Change to Turkey Language_END.
				// Show registerBtn
				idName = "registerBtn" + acntNum;
				var registerBtn = document.getElementById( idName );
				
				if(eval("ls"+sp+"_"+j) == 'OnRegister'){
					registerBtn.disabled = false;
					registerBtn.value = '<%ejGetML(MLG_VoIP_Unregister)%>';			
				}
				else if(eval("ls"+sp+"_"+j) == 'Inactive'){
					registerBtn.disabled = true;
				}
				else{
					registerBtn.disabled = false;
					registerBtn.value = '<%ejGetML(MLG_VoIP_Register)%>';			
				}	
				// Show SPsipAcntNum
				//_MSTC_, Linda, Change to Turkey Language.
				var idName = "SPsipAcntNum"+acntNum;
				var sipAcnt1;
				var sipAcnt2;
				if( eval("vpn"+sp) == 'ServiceProvider-1')
					sipAcnt1 = '<%ejGetML(MLG_VoIP_ServiceProvider1)%>';
				else if(eval("vpn"+sp) == 'changeme')
					sipAcnt1 = '<%ejGetML(MLG_VoIP_changeme)%>';
				else
					sipAcnt1 = eval("vpn"+sp);
				if( eval("ex"+ sp+"_" +j) == 'changeme')
					sipAcnt2 = '<%ejGetML(MLG_VoIP_changeme)%>';
				else
					sipAcnt2 = eval("ex"+ sp+"_" +j);
				document.getElementById(idName).innerHTML = sipAcnt1 + " / " + sipAcnt2;
				//_MSTC_, Linda, Change to Turkey Language_END.
				// Show sipUrl
				idName = "sipUri" + acntNum;			
				//_MSTC_, Linda, Change to Turkey Language.
				if( eval("ex"+ sp+"_" +j) == 'changeme')
					document.getElementById(idName).innerHTML = '<%ejGetML(MLG_VoIP_changeme)%>' + '@' + eval("uad"+ sp);
				else
					document.getElementById(idName).innerHTML = eval("ex"+ sp+"_" +j) + '@' + eval("uad"+ sp);
				//_MSTC_, Linda, Change to Turkey Language_END.	
			}		
		}
	}
}

// VoIP Register function
function btnStartReg(acnt) {
	 var current_view='home';
	 var loc;
	 var i,j,found = 0;
	 var code ;
	 for(i=0;i<currentSp;i++){
		for(j=0;j<eval("lc"+i);j++){
			if(parseInt(eval('lcma'+i+"_"+j)) == acnt ){	
				found = 1;
				if(eval('ls'+i+"_"+j) == 'OnRegister'){
					loc = 'voipStatus-voicesipderegister.cmd?';
				}
				else{
					loc = 'voipStatus-voicesipregister.cmd?';
				}
				loc += 'currentview='+ current_view;
				loc += '&cmacnt='+acnt;
				loc += '&sessionKey='+ glbSessionKey;
			}
		}
	 }
	 
	 if(!(found == 1)){
		alert("Wrong SIP Account Number");
	 }else{
		   BackgroundUrl(loc);
		   updateValue_take();
	 }
}

// VoIP Registration Status
function createSipAccountList() {
	var cont="";
	var i,j;
	for (i = 0; i < currentSp; i++) {
		for(j = 0; j < eval("lc"+i); j++){
			var acntNum = eval("lcma"+ i + "_" + j);
			var acntNum_new = parseInt(acntNum) + 1;	// from SIP1, SIP2, ...
			cont += "<tr align='center'>";
			cont += "<td class='table_font'>SIP " + acntNum_new + "</td>";
			cont +="<td class='table_font'><input value='<%ejGetML(MLG_VoIP_Register)%>' onClick='btnStartReg(" + acntNum +")' type='button' id='registerBtn"+ acntNum +"'> </td>";
			cont +="<td class='table_font' id='lineStatus" + acntNum + "'>Inactive</td>";
			cont +="<td class='table_font' id='SPsipAcntNum" + acntNum + "'>" + eval("vpn"+i) + " / " + eval("ex"+ i + "_" + j) + "</td>";	
			cont +="<td class='table_font' id='sipUri" + acntNum + "'>ChangeMe@ChangeMe</td>";			
			cont +="</tr>";
		}
	}
	
   $('#registrationStatus').append(cont);
}

// firewall info
function initFWInfo()
{
   if(currfwLevel=="Low")
	{
		currfwLevel = "<%ejGetML(MLG_Security_Low)%>";
	}
	else if(currfwLevel=="Medium")
	{
		currfwLevel = "<%ejGetML(MLG_Security_Medium)%>";
	}
	else if(currfwLevel=="High")
	{
		currfwLevel = "<%ejGetML(MLG_Security_High)%>";
	}
	else
	{
		currfwLevel = "<%ejGetML(MLG_Common_Disabled)%>";
	}
	  
   $('#fwInfo').html(currfwLevel);

	if(forEircom==1)
	{
		$('#contentFilter').fadeIn(0);
   		if(enblParentCtl==1)
   		{
      		$('#fwContent').html("Enabled");
   		}
   		else
   		{
      		$('#fwContent').html("Disabled");
   		}
	}
	else
	{
		$('#contentFilter').fadeOut(0);
	}


   
}

//IPv6 LAN
function initIPv6Info () {
   $('#IPv6Addr').html(IPv6Addr);
}

//systime
var objTimeXMLHTTP = null;

function strFormat(str,iLen) {   
	if (str.length < iLen) {
		for (iIndex = 0 ; iIndex < iLen-str.length ; iIndex++) {
			str = "0" + str;   
		}
		return str;
	}
	else {
		return str;
	}
}

function IncreaseSec() {
	var now = new Date(timestamp);
	var days = strFormat(now.getDate().toString(),2);
	var years = now.getFullYear();
	var months = now.toString().substr(4,3);
	var hr = strFormat(now.getHours().toString(),2);
	var min = strFormat(now.getMinutes().toString(),2);
	var sec = strFormat(now.getSeconds().toString(),2);
	document.getElementById("clock1").innerHTML = days + " " + changeMonthString(months) + "  " + years;
	document.getElementById("showTime").innerHTML = hr + ":" + min + ":" + sec;
	document.getElementById("uptime").innerHTML = SysUpTime;
	timestamp += 1000;
	inctimetask = setTimeout('IncreaseSec()', 1000);
}

function changeMonthString(month)
{
	switch (month)
	{
		case 'Jan':
			return "<%ejGetML(MLG_ConnStatus_Status_Str62)%>";
		case 'Feb':
			return "<%ejGetML(MLG_ConnStatus_Status_Str63)%>";
		case 'Mar':
			return "<%ejGetML(MLG_ConnStatus_Status_Str64)%>";
		case 'Apr':
			return "<%ejGetML(MLG_ConnStatus_Status_Str65)%>";
		case 'May':
			return "<%ejGetML(MLG_ConnStatus_Status_Str66)%>";
		case 'Jun':
			return "<%ejGetML(MLG_ConnStatus_Status_Str67)%>";
		case 'Jul':
			return "<%ejGetML(MLG_ConnStatus_Status_Str68)%>";
		case 'Aug':
			return "<%ejGetML(MLG_ConnStatus_Status_Str69)%>";
		case 'Sep':
			return "<%ejGetML(MLG_ConnStatus_Status_Str70)%>";
		case 'Oct':
			return "<%ejGetML(MLG_ConnStatus_Status_Str71)%>";
		case 'Nov':
			return "<%ejGetML(MLG_ConnStatus_Status_Str72)%>";
		case 'Dec':
			return "<%ejGetML(MLG_ConnStatus_Status_Str73)%>";
	    default:
			return 0;
	}
}

function getonlinetime()
{
	if ( objTimeXMLHTTP != null ) {
		objTimeXMLHTTP.open("POST","/pages/connectionStatus/TimeZoneGetNew.html",true);
		objTimeXMLHTTP.onreadystatechange = function() 
		{
			if(objTimeXMLHTTP.readyState == 4) {
				var now;
				var servertime=objTimeXMLHTTP.responseText;
				var servertimestamp = Date.parse(servertime);
				servernow = new Date(servertimestamp);
				now = new Date(timestamp);
				
				if ( now.getDate() != servernow.getDate() ||
						now.getMonth() != servernow.getMonth() ||
						now.getFullYear() != servernow.getFullYear() ) {
					timestamp = servertimestamp;
				}
				timetask = setTimeout('getonlinetime()', 10000);
			}
		}
	
		objTimeXMLHTTP.send(null);
	
	}
}

function initTime()
{
	timestamp = Date.parse(timeNow);
	IncreaseSec();
	if ( ntp_enabled == 1 ) {
		if (window.XMLHttpRequest) {
			objTimeXMLHTTP=new XMLHttpRequest();
			timetask = setTimeout('getonlinetime()', 10000);
		}// code for IE
		else if (window.ActiveXObject) {
			objTimeXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
			timetask = setTimeout('getonlinetime()', 10000);
		}
	}
}

//cpuusg
var objCpuUsgXMLHTTP = null;
var objDnsUsgXMLHTTP = null;


function showNatSessionUsg(){
   var natStr = '';
   natStr += '<table width="' + NatSessionUsgInfo + '%" border="0" cellspacing="0" cellpadding="0">';
   natStr += '  <tr>';
   natStr += '    <td height="18" background="../../images/i_percentage_blue.gif">&nbsp;</td>';
   natStr += '  </tr>';
   natStr += '</table>';

   //Memory Usage Information.
   document.getElementById("natSessionUsgID").innerHTML =natStr;
   document.getElementById("natSessionInfo").innerHTML = NatSessionUsgInfo;
}

function init3ginfo(){
	var wwanStr = '';
	var test = '';
	if ( support3GBackup==0) {
		$("#wwan3g").hide();
		return;
	}
	else {
		$("#wwan3g").show();
	}
	
   		if (wwanStatus=='InvalidPIN')
      		wwanStr += '<a href="javascript: doOpenWindow(21);"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Need_PIN)%>';
  		 else if (wwanStatus=='NeedPUK')
        	wwanStr += '<a href="javascript: doOpenWindow(16);"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Need_PUK)%>';
   		else if (wwanStatus=='InvalidSIM')
       		wwanStr += '<a href="javascript: doOpenWindow(17);"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Damaged_SIM)%>';
   		else if (wwanStatus=='NoResponse')
        	wwanStr += '<a href="javascript: doOpenWindow(20);"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_No_Response)%>';
   		else
   			wwanStr += wwanStatus;
			
		if( wwanStatus =='Up')
   		{
   			if( wwanquality =='Excellent')
          		test += '<img src=\"../../images/rssi_level_5.gif\">';
   			if( wwanquality =='Good')
           		test += '<img src=\"../../images/rssi_level_4.gif\">';
   			if( wwanquality =='Fair')
           		test += '<img src=\"../../images/rssi_level_3.gif\">';
   			if( wwanquality =='Poor')
           		test += '<img src=\"../../images/rssi_level_2.gif\">';
   			if( wwanquality =='Very Poor')
           		test += '<img src=\"../../images/rssi_level_1.gif\">';
   			if( wwanquality =='No Service')
           		test += '<img src=\"../../images/rssi_level_0.gif\">';
   		}
   		else
        	test += 'N/A';

		document.getElementById("wwanID").innerHTML =wwanStr;
  		document.getElementById("wwanInfo").innerHTML =test;
}
function showMemUsg(){
   var memStr = '';
   memStr += '<table width="' + MemUsgInfo + '%" border="0" cellspacing="0" cellpadding="0">';
   memStr += '  <tr>';
   memStr += '    <td height="18" background="../../images/i_percentage_blue.gif">&nbsp;</td>';
   memStr += '  </tr>';
   memStr += '</table>';

   /*Memory Usage Information.*/
   document.getElementById("memUsgID").innerHTML = memStr;
   document.getElementById("memInfo").innerHTML = MemUsgInfo;
}

function showCpuUsg(usg)
{

   var cpuStr = '';
   cpuStr += '<table width="' + usg + '%" height="18" border="0" cellspacing="0" cellpadding="0">';
   cpuStr += '  <tr>';
   cpuStr += '    <td height="18" background="../../images/i_percentage_blue.gif">&nbsp;</td>';
   cpuStr += '  </tr>';
   cpuStr += '</table>';

   document.getElementById("cpuUsgId").innerHTML = cpuStr;
   document.getElementById("cpuNumId").innerHTML = usg;
}

function getCpuUsg(){
	var datetmp = new Date();
	var date = (datetmp.toString()).split('(');
   if ( objCpuUsgXMLHTTP != null ) {
      objCpuUsgXMLHTTP.open("POST","/pages/connectionStatus/cpuUsg.html", true);
      objCpuUsgXMLHTTP.setRequestHeader("If-Modified-Since",date[0]);
      objCpuUsgXMLHTTP.onreadystatechange = function() 
      {
         if(objCpuUsgXMLHTTP.readyState == 4) {
            var result = objCpuUsgXMLHTTP.responseText;
            if (result.indexOf("%") >= 0) {
               showCpuUsg(result);
               showMemUsg();
               if(ttnetnolimit=='1')
                  showNatSessionUsg();
            }
         }
      }
      objCpuUsgXMLHTTP.send(null);
   }
   if( (ttnetfeature == 0) || (selecting == 0))	//_MSTC_, Linda, change refresh interval value but GUI didn't referesh automatically in status page.
   	cputask = setTimeout("getCpuUsg()",5000); 
}

function getDnsUsg(){
	
   if ( objDnsUsgXMLHTTP != null ) {
		objDnsUsgXMLHTTP.open("POST","/pages/connectionStatus/GetDnsInfo.html", true);
		//objDnsUsgXMLHTTP.setRequestHeader("If-Modified-Since",new Date(0));
		objDnsUsgXMLHTTP.onreadystatechange = function() 
		{
			if(objDnsUsgXMLHTTP.readyState == 4) {
				
				wanInfo = objDnsUsgXMLHTTP.responseText;
				initWanInfo();
 
				if( (ttnetfeature == 1) && (selecting != 0)) //_MSTC_, Linda, change refresh interval value but GUI didn't referesh automatically in status page. 
				{
					myDate_end = new Date();
					var sec = myDate_end - myDate_start; 
					var newtime;
					
					clearTimeout(timeValue);	
					
					if (selecting == 1) {
						if(sec > 5000)
							timeValue = setTimeout('updateValue_take()', 0);  
						else{
							newtime = 5000 - sec;
							timeValue = setTimeout('updateValue_take()', newtime);
						}
					} else if (selecting == 2) {
						if(sec > 10000)
							timeValue = setTimeout('updateValue_take()', 0);  
						else{
							newtime = 10000 - sec;
							timeValue = setTimeout('updateValue_take()', newtime);
						}
					} else if (selecting == 3) {
						if(sec > 15000)
							timeValue = setTimeout('updateValue_take()', 0);  
						else{
							newtime = 15000 - sec;
							timeValue = setTimeout('updateValue_take()', newtime);
						}
					} else if (selecting == 4) {
						if(sec > 20000)
							timeValue = setTimeout('updateValue_take()', 0);  
						else{
							newtime = 20000 - sec;
							timeValue = setTimeout('updateValue_take()', newtime);
						}
					} else if (selecting == 5) {
						if(sec > 25000)
							timeValue = setTimeout('updateValue_take()', 0);  
						else{
							newtime = 25000 - sec;
							timeValue = setTimeout('updateValue_take()', newtime);
						}
					} else if (selecting == 6) {
						if(sec > 30000)
							timeValue = setTimeout('updateValue_take()', 0);  
						else{
							newtime = 30000 - sec;
							timeValue = setTimeout('updateValue_take()', newtime);
						}
					   } else {
						clearTimeout(timeValue);
					}
				}//_MSTC_, Linda, change refresh interval value but GUI didn't referesh automatically in status page. _END
		 	}
		}

		objDnsUsgXMLHTTP.send(null);
   }

   if( (ttnetfeature == 0) || (selecting == 0))	//_MSTC_, Linda, change refresh interval value but GUI didn't referesh automatically in status page.
   	dnstask = setTimeout("getDnsUsg()",5000); 

}


function initEthInfo()
{

	$('#eth0Status').html(eth0portStatus);	
	if ( eth0portStatus == 'NoLink' || eth0portStatus == 'Disabled' ) {
		$('#eth0Info').html('N/A');
	}
	else {
		$('#eth0Info').html(eth0maxBitRate+'&nbsp;/&nbsp;'+eth0duplexMode);
	}
	$('#eth1Status').html(eth1portStatus);	
	if ( eth1portStatus == 'NoLink' || eth1portStatus == 'Disabled' ) {
		$('#eth1Info').html('N/A');
	}
	else {
		$('#eth1Info').html(eth1maxBitRate+'&nbsp;/&nbsp;'+eth1duplexMode);
	}
	$('#eth2Status').html(eth2portStatus);	
	if ( eth2portStatus == 'NoLink' || eth2portStatus == 'Disabled' ) {
		$('#eth2Info').html('N/A');
	}
	else {
		$('#eth2Info').html(eth2maxBitRate+'&nbsp;/&nbsp;'+eth2duplexMode);
	}
	$('#eth3Status').html(eth3portStatus);	
	if ( eth3portStatus == 'NoLink' || eth3portStatus == 'Disabled' ) {
		$('#eth3Info').html('N/A');
	}
	else {
		$('#eth3Info').html(eth3maxBitRate+'&nbsp;/&nbsp;'+eth3duplexMode);
	}
}

function initCPUUsg () {
   if (window.XMLHttpRequest) {
      objCpuUsgXMLHTTP=new XMLHttpRequest();
      getCpuUsg();
   } else if (window.ActiveXObject) {
      // code for IE
      objCpuUsgXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
      getCpuUsg();
   }
}

function initDnsInfoUsg () {
   if (window.XMLHttpRequest) {
      objDnsUsgXMLHTTP=new XMLHttpRequest();
      getDnsUsg();
   } else if (window.ActiveXObject) {
      // code for IE
      objDnsUsgXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
      getDnsUsg();
   }
}


function initEthWanInfo()
{
	if ( supportethwan != '1' ) {
		$("#ethwan").hide();
		return;
	}
	else {
		$("#ethwan").show();
	}
	$('#ethWanStatus').html(ethWanportStatus);	
	if ( ethWanportStatus == 'NoLink' ) {
		$('#ethWanInfo').html('N/A');
	}
	else {
		$('#ethWanInfo').html(ethWanmaxBitRate+'&nbsp;/&nbsp;'+ethWanduplexMode);
	}
}
function initDslInfo()
{
	if ( supportdsl != '1' ) {
		$("#dslwan").hide();
		return;
	}
	else {
		if( tthomegwfeature == '1')
			$("#dslwan").hide();
		else
			$("#dslwan").show();
	}
	$('#dslStatus').html(dslStatus);
	var tmp='';
	tmp +='RX:' + dslInfo1;
	tmp += '/ TX:'+dslInfo0+'(Kbps)';
	if ( dslStatus == 'NoLink' ) {
		$('#dslInfo').html('N/A');
	}
	else {
		$('#dslInfo').html(tmp);
	}
}

function updateValue(msg){
   var upDate = msg.replace(/\r\n/ig, "");
   upDate = upDate.replace(/\n/ig, "");
   var upDates = upDate.split('##');

   wanLevel = upDates[0];
   dhcpEnbl = upDates[1];
   currfwLevel = upDates[2];
   supportwlan = upDates[3];
   wanInfo = (((upDates[4] == undefined) || (upDates[4] == '')) ? '' : upDates[4]);
   SysUpTime = upDates[5];
   MemUsgInfo = upDates[6];
   timeNow = upDates[7];
   ntp_enabled = (((upDates[8] == undefined) || (upDates[8] == '')) ? 0 : parseInt(upDates[8]));


	tmplineStatus = upDates[25];		// VoIP lineStatus
	dslStatus=upDates[26];
	eth0portStatus = upDates[27];
	eth0maxBitRate = upDates[28];
	eth0duplexMode = upDates[29];
	eth1portStatus = upDates[30];
	eth1maxBitRate = upDates[31];
	eth1duplexMode = upDates[32];
	eth2portStatus = upDates[33];
	eth2maxBitRate = upDates[34];
	eth2duplexMode = upDates[35];
	eth3portStatus = upDates[36];
	eth3maxBitRate = upDates[37];
	eth3duplexMode = upDates[38];
	ethWanportStatus = upDates[39];
	ethWanmaxBitRate = upDates[40];
	ethWanduplexMode = upDates[41];	
	dslInfo1=upDates[42];
	dslInfo0=upDates[43];
	wwanStatus=upDates[44];
	wwanquality=upDates[45];
   frmLoad(0);
}

if (window.XMLHttpRequest) {
	objInfoXMLHTTP=new XMLHttpRequest();
}// code for IE
else if (window.ActiveXObject) {
	objInfoXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
}

function updatexdslStatisticsInfo (req)
{
	if( ttfeature == 1){//_MSTC_,YingYu, statistic
		var xdsltxt='';
		var xdslbuf='';	
		var buf= req.responseText;
		
		if ( buf != "" && buf!= null ) {
			var WANinfo = buf.split('@@');
			showDSL = WANinfo[0];
			
			if(showDSL == 1){ 
				xdslbuf = WANinfo[2];
				if ( xdslbuf != "" && xdslbuf != null ) {
					var info =xdslbuf.split('============================================================================');
					for (var i=1;i<3;i++){
					   xdsltxt+=info[i];
					}
					if (info  != "" )
						document.getElementById("xdslInfo").value=xdsltxt;		
				}
				$('#ether_up').hide();
				$('#dsl_up').show();
				
			}
			else{	
				xdslbuf = WANinfo[1];
				if ( xdslbuf != "" && xdslbuf != null ) {
					var linkstatus = xdslbuf.split('|')[0];
					var linkRate = xdslbuf.split('|')[1];
					if( linkstatus == 'NoLink')
						xdsltxt = "Link Status: Down\nLink Rate: ";
					else
						xdsltxt = "Link Status: " + linkstatus + "\nLink Rate: " + linkRate + " M";
					document.getElementById("xdslInfo").value=xdsltxt;
				}
				$('#dsl_up').hide();
				$('#ether_up').show();
			}
		}
		$('#getxdsl').hide();
	}
	else{
		var xdslbuf=req.responseText;
		if ( xdslbuf != "" && xdslbuf != null ) {
			var info =xdslbuf.split('============================================================================');
			var xdsltxt='';
			for (var i=1;i<3;i++){
			   xdsltxt+=info[i];
			}
			if (info  != "" )
				document.getElementById("xdslInfo").value=xdsltxt;
					
		}
		$('#getxdsl').hide();
	}
	
}
function AutoRefresh()
{
	if( ttfeature == 1){//_MSTC_,YingYu, statistic
		if ( objInfoXMLHTTP != null ) {
			objInfoXMLHTTP.open("POST","/pages/systemMonitoring/xdslStatistics/GetDSLorEthernetStatistics.html",true);
			objInfoXMLHTTP.onreadystatechange = function() 
			{
				if(objInfoXMLHTTP.readyState == 4){
					updatexdslStatisticsInfo(objInfoXMLHTTP);
				}
			}
			objInfoXMLHTTP.send(null);
		}
	
	}//_MSTC_,YingYu, statistic, end
	else{
		if ( objInfoXMLHTTP != null ) {
			objInfoXMLHTTP.open("POST","/pages/systemMonitoring/xdslStatistics/GetxdslStatistics.html",true);
			objInfoXMLHTTP.onreadystatechange = function() 
			{
				if(objInfoXMLHTTP.readyState == 4)
					updatexdslStatisticsInfo(objInfoXMLHTTP);
			}
			objInfoXMLHTTP.send(null);
		}
		
	}
}

function frmLoad(init) {


   if( ttfeature == 1){   //_MSTC_,YingYu, statistic
   	/* To find is DSLWAN link up or not. If not, it will show etherWAN*/
   	if(showDSL == 1){
	   	$('#dsl_up').show();
		$('#ether_up').hide();
   	}
   	else{
	   	$('#dsl_up').hide();
		$('#ether_up').show();					
   	}
   }  //_MSTC_,YingYu, statistic, end
   else{
   	$('#dsl_up').show();
	$('#ether_up').hide();
   }

   if(ttnetnolimit=='1')
     {
      $('#natseesionusage').show();
      $('#XDslStatus').hide();
     }
   else
     {
       $('#natseesionusage').hide();
       $('#XDslStatus').show();
      }
   // init dhcp info
   initDHCPInfo();

   // init WLAN info
   initWLANinfo();

   // init Firewall info
   initFWInfo();

   // init WAN info
   initWanInfo();

   //init lan info
   initEthInfo();

   //init eth wan info
   initEthWanInfo();

   //init dsl info
   initDslInfo();
	
   //init 3g info
   init3ginfo();

   // init Xdsl info
   if(ttnetnolimit=='0')//jim
   initXdslInfo();
   $('#getxdsl').hide();

    //init VoIP
	initVoipInfo();
   if(buildMstcIPv6 == '1' && enblLanIPv6 == '1')
   {
      $('#Ipv6LanInfo').show();
      //init IPv6Info
      initIPv6Info();
   }
   else
      $('#Ipv6LanInfo').hide();

   if(init == 1) {
      // current date/time
      initTime();

      // CPU usage
      initCPUUsg();

      // DnsInfo usage
      initDnsInfoUsg();  
   }
   if(supportwlan == '2')
   {
      $('#wlan2').show();
      $('#Wlan2StatusInfo').show();
      //init wlanInfo
         initWLAN2info();  
       
   }
   else
   {
      $('#Wlan2StatusInfo').hide();
      $('#wlan2').hide();
   }

   if(supportUPS == '1'){
      $('#upsStatus').show();
   } else {
      $('#upsStatus').hide();
      $('#upsStatus').css('visibility', 'hidden');
   }

   if(supportVoip == '1'){
      $('#sipStatus').show();
   } else {
      $('#sipStatus').hide();
      $('#sipStatus').css('visibility', 'hidden');
   }

   if(wanLevel == '0') {
      connection(true, wanLevel);
   } else {
      connection(false, wanLevel);
   }

	if(forEircom==1)
	{
		$('#serialNumber').fadeIn(0);
		$('#SecurityKey').fadeIn(0);
		$('#tthgwmodelName').hide();
	}
	else if ( tthomegwfeature == '1')//TT: Serial number
	{
		$('#serialNumber').show();
		$('#modelName').hide();
	}
	else
	{
		$('#serialNumber').fadeOut(0);
		$('#SecurityKey').fadeOut(0);
		$('#tthgwmodelName').hide();
	}
   
}


$(function()
{
	$('.textOverflow').each(function(){ $(this).attr('title', $(this).text());} );  
});
// done hiding -->
</script>

<script type="text/javascript" src="../../js/jquery.text-overflow.js"></script>
<div id="statusView" class='naviView' style='position: relative;'>
  <table width="98%" border="0" align="center" cellpadding="0" cellspacing="0">
    <tr>
      <td width="50%">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td valign="top">&nbsp;</td>
      <td valign="top">&nbsp;</td>
    </tr>
    <tr>
      <td valign="top"><div class="w_text3">
        <table width="92%" align="center" cellpadding="0" cellspacing="0" class="table_frame" id="deviceInformation">
          <tr >
            <td colspan="2" class="top_font"><%ejGetML(MLG_ConnStatus_Status_Str1)%></td>
          </tr>
          <tr >
            <td width="40%"  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str2)%> </td>
            <td  class="table_font w_blue"><%ejGet(manufacturerName)%></td>
          </tr>
          <tr >
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str3)%> </td>
            <td  id="modelName" class="table_font w_blue" ><%ejGet(modelName)%></td>
            <td  id="tthgwmodelName" class="table_font w_blue" ><%ejGetML(MLG_Common_TTHGW_Model_Name)%></td>
          </tr>
          <tr id="serialNumber" style="display:none;">
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str301)%> </td>
            <td  class="table_font w_blue" ><%ejGet(serialNumber)%></td>
          </tr>
          <tr >
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str4)%> </td>
            <td  class="table_font w_blue"><%ejGet(sysVersion)%></td>
          </tr>
          <tr >
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str5_1)%> </td>
            <td  class="table_font">&nbsp;</td>
          </tr>
          <tbody id="wanInfo"></tbody>
<!--
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- MAC Address:</td>
            <td  class="table_font w_blue">00:19:cb:a2:08:6b </td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;-  IP Address: </td>
            <td  class="table_font w_blue">172.23.30.105</td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- IP Subnet Mask:</td>
            <td  class="table_font w_blue">255.255.255.0 </td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- DHCP: </td>
            <td  class="table_font w_blue"></td>
          </tr>
-->
          <tr >
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str8_1)%></td>
            <td  class="table_font">&nbsp;</td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;-  <%ejGetML(MLG_Common_IPAddress)%>: </td>
            <td  class="table_font w_blue"><%ejGet(ethIpAddress)%></td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPSubnetMask)%>:</td>
            <td  class="table_font w_blue"><%ejGet(ethSubnetMask)%></td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str9)%></td>
            <td id="dhcpInfo"  class="table_font w_blue"></td>
          </tr>
<!--IPv6 begin-->
          <tbody id="Ipv6LanInfo">
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_IPv6Address)%>: </td>
              <td id="IPv6Addr" class="table_font w_blue">&nbsp;</td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str81)%>: </td>
              <td class="table_font w_blue"><%ejGetOther(lanIpv6LinkLocalAddr)%></td>
            </tr>
          </tbody>
<!--IPv6 end-->
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_MACAddress)%>:</td>
            <td  class="table_font w_blue"><%ejGetOther(sysInfo, baseMacAddress)%></td>
          </tr>
          <tbody id="WlanStatusInfo">
<script language="javascript">
<!-- hide
var tempStr = '';
	  tempStr += '<tr>\n';
if(supportwlan == '2')
	  tempStr += '<td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str10_24)%></td>\n';
else
	  tempStr += '<td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str10_1)%></td>\n';
	  tempStr += '<td  class="table_font">&nbsp;</td>\n';				  
	  tempStr += '</tr>\n';
	  $('#WlanStatusInfo').prepend(tempStr);
// done hiding -->
</script>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_MACAddress)%>:</td>
              <td id="wlBssid" class="table_font w_blue"></td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str11)%> </td>
              <td id="wlEnbl" class="table_font w_blue"></td>
            </tr>
            <tr >
              <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str88)%>:</td>
              <td id="wlSSID" class="table_font w_blue">My SSID</td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str13)%> </td>
              <td id="channelInfo" class="table_font w_blue"></td>
            </tr>
            <tr >
              <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str89)%>:</td>
              <td id="securityInfo" class="table_font w_blue"></td>
            </tr>
            <tr id="SecurityKey" style="display:none;">
              <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str302)%> </td>
              <td id="security_pwdInfo" class="table_font w_blue"></td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str90)%>: </td>
              <td id="modeInfo" class="table_font w_blue"></td>
            </tr>
            <tr id="wpsinfoview">
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str16)%></td>
              <td id="wpsInfo" class="table_font w_blue"></td>
            </tr>
          </tbody>
          <tbody id="Wlan2StatusInfo">
<!--     
            <tr >
              <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str10_5)%></td>
              <td  class="table_font">&nbsp;</td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_Common_MACAddress)%>:</td>
              <td id="wl1Bssid" class="table_font w_blue"></td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str11)%> </td>
              <td id="wl1Enbl" class="table_font w_blue"></td>
            </tr>
            <tr >
              <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str88)%>:</td>
              <td id="wl1SSID" class="table_font w_blue">My SSID</td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str13)%> </td>
              <td id="wl1_channelInfo" class="table_font w_blue"></td>
            </tr>
            <tr >
              <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str89)%>:</td>
              <td id="wl1_securityInfo" class="table_font w_blue"></td>
            </tr>
            <tr>
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str90)%>: </td>
              <td id="wl1_modeInfo" class="table_font w_blue"></td>
            </tr>
            <tr id="wl1_wpsinfoview">
              <td class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str16)%></td>
              <td id="wl1_wpsInfo" class="table_font w_blue"></td>
            </tr>
-->
          </tbody>
          <tr >
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str89)%></td>
            <td  class="table_font">&nbsp;</td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str91)%> :</td>
            <td id="fwInfo" class="table_font w_blue"></td>
          </tr>
          <tr id="contentFilter" style="display:none;">
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_ContentFilter)%> :</td>
            <td id="fwContent" class="table_font w_blue"></td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;</td>
            <td  class="table_font">&nbsp;</td>
          </tr>
        </table>
      </div></td>
      <td valign="top">
        <table width="92%" border="0" align="center"  cellpadding="0" cellspacing="0" class="table_frame" id="systemStatus">
          <tr >
            <td colspan="3" class="top_font"><%ejGetML(MLG_ConnStatus_Status_Str42)%></td>
          </tr>
          <tr >
            <td width="40%"  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str43)%> </td>
            <td colspan="2"  class="table_font w_blue"><span id='uptime'></span></td>
          </tr>
          <tr >
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str44)%> </td>
            <td colspan="2"  class="table_font w_blue"><span id='clock1'></span>&nbsp;<span id = "showTime"></td>
          </tr>
          <tbody id="upsStatus">
<!--
            <tr >
              <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str92)%>: </td>
              <td colspan="2"  class="table_font w_blue"><%ejGetML(MLG_ConnStatus_Status_Str99)%> </td>
            </tr>
            <tr >
              <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str93)%>:</td>
              <td colspan="2"  class="table_font"style="display:none;"><span class="table_font w_blue"><%ejGetML(MLG_ConnStatus_Status_Str94)%></span></td>
              <td colspan="2"  class="table_font" style="display:none;"><span class="table_font w_blue"><%ejGetML(MLG_ConnStatus_Status_Str95)%></span></td>
              <td colspan="2"  class="table_font" ><span class="table_font w_blue"><%ejGetML(MLG_ConnStatus_Status_Str95)%> <span  style="color: #993300;"><%ejGetML(MLG_ConnStatus_Status_Str96)%></span></span></td>
              <td colspan="2"  class="table_font" style="display:none;"><span class="table_font w_blue"><%ejGetML(MLG_ConnStatus_Status_Str94)%> <span  style="color: #993300;"><%ejGetML(MLG_ConnStatus_Status_Str97)%></span></span></td>
            </tr>
-->
          </tbody>
          <tr >
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str47)%></td>
            <td colspan="2"  class="table_font w_blue">&nbsp;</td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str48)%></td>
              <td width="38%" height="18"class="table_font"><table width="100%" height="18" border="1" cellpadding="0" cellspacing="0" bordercolor="#7895c8">
                <tr>
                  <td background="../../images/i_percentage_center.gif">
                    <span id='cpuUsgId'>
                      <table width="50%" height="18" border="0" cellspacing="0" cellpadding="0">
                        <tr>
                          <td height="18" background="../../images/i_percentage_blue.gif">&nbsp;</td>
                        </tr>
                      </table>
                    </span>
                  </td>
                </tr>
              </table>
            </td>
            <td  class="table_font w_blue"><span id='cpuNumId'></span></td>
          </tr>
          <tr >
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_Str49)%></td>
            <td  class="table_font">
              <table width="100%" height="18" border="1" cellpadding="0" cellspacing="0" bordercolor="#7895c8">
                <tr>
                  <td background="../../images/i_percentage_center.gif">
                    <span id='memUsgID'>
                      <table width="50%" border="0" cellspacing="0" cellpadding="0">
                        <tr>
                          <td height="18" background="../../images/i_percentage_blue.gif">&nbsp;</td>
                        </tr>
                      </table>
                    </span>
                  </td>
                </tr>
              </table>
            </td>
            <td  class="table_font w_blue"><span id='memInfo'></span>%</td>
          </tr>

          <tr id="natseesionusage">
            <td  class="table_font">&nbsp;&nbsp;- <%ejGetML(MLG_ConnStatus_Status_nat_usage)%>:</td>
            <td  class="table_font">
              <table width="100%" height="18" border="1" cellpadding="0" cellspacing="0" bordercolor="#7895c8">
                <tr>
                  <td background="../../images/i_percentage_center.gif">
                    <span id='natSessionUsgID'>
                      <table width="50%" border="0" cellspacing="0" cellpadding="0">
                        <tr>
                          <td height="18" background="../../images/i_percentage_blue.gif">&nbsp;</td>
                        </tr>
                      </table>
                    </span>
                  </td>
                </tr>
              </table>
            </td>
            <td  class="table_font w_blue"><span id='natSessionInfo'></span>%</td> 
          </tr>		  

          <tr >
            <td  class="table_font">&nbsp;</td>
            <td colspan="2"  class="table_font">&nbsp;</td>
          </tr>
        </table>
        <br>
	<table width="92%" border="0" align="center"  cellpadding="0" cellspacing="0" class="table_frame" id="InterfaceStatus">
          <tr >
            <td colspan="3" class="top_font"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_title)%></td>
          </tr>	
          <tr align="center" valign="top">
               <td class="table_font2"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Interface)%></td>
               <td class="table_font2"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Status)%></td>
               <td class="table_font2"><%ejGetML(MLG_ConnStatus_Status_InterfaceStatus_Rate)%></td>
          </tr>
          <tr id="ethPort1" align="center"> 
               <td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str26)%></td>
               <td id="eth0Status" class="table_font"></td>
               <td id="eth0Info" class="table_font"></td>
          </tr>
          <tr id="ethPort2" align="center">
               <td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str27)%></td>
               <td id="eth1Status" class="table_font"></td>
               <td id="eth1Info" class="table_font"></td>
          </tr>
          <tr id="ethPort3" align="center">
               <td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str28)%></td>
               <td id="eth2Status" class="table_font"></td>
               <td id="eth2Info" class="table_font"></td>
          </tr>
          <tr id="ethPort4" align="center">
               <td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str29)%></td>
               <td id="eth3Status" class="table_font"></td>
               <td id="eth3Info" class="table_font"></td>
          </tr>
          <tbody id="wlan">
<script language="javascript">
<!-- hide
var tempStr = '';
	  tempStr += '<tr id="wlanStatus" align="center" class = tabcolor2> \n';
if(supportwlan == '2')
	  tempStr += '<td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str33_24)%></td>\n';
else
	  tempStr += '<td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str33)%></td>\n';
	  tempStr += '<td id="wlanInfo" class="table_font"></td>\n';
	  tempStr += '<td id="wlanRate" class="table_font"></td>\n';				  
	  tempStr += '</tr>\n';
	  $('#wlan').append(tempStr);
// done hiding -->
</script>
		  </tbody>
          <tbody id="wlan2">
<!--
               <tr id="wlan2Status" align="center" class = tabcolor2 > 
               <td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str33_5)%></td>
               <td id="wlan2Info" class="table_font"></td>
               <td id="wlan2Rate" class="table_font"></td>
          </tr>
-->
          </tbody>
          <tr id="ethwan" align="center">
               <td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str38)%></td>
               <td id="ethWanStatus" class="table_font"></td>
               <td id="ethWanInfo" class="table_font"></td>
          </tr>
<!--  //_MSTC_, Linda, Hide Interface Status of "DSL"  -->
          <tr id="dslwan" align="center">
               <td class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str39)%></td>
               <td id="dslStatus" class="table_font"></td>
               <td id="dslInfo" class="table_font"></td>
          </tr>		  
          <tr id="wwan3g" align="center">
            <td  class="table_font"><%ejGetML(MLG_ConnStatus_Status_Str41)%></td>
               <td  class="table_font w_blue"><span id='wwanID'></span></td>
            <td  class="table_font w_blue"><span id='wwanInfo'></span></td>
          </tr>		  
        </table>
        <br>
		<table width="92%" border="0" align="center"  cellpadding="0" cellspacing="0" class="table_frame" id="XDslStatus">
			<tr>
				<td id="dsl_up" colspan="1" class="top_font"><%ejGetML(MLG_Menu_xDSLStatistics)%></td>
				<td id="ether_up" colspan="1" class="top_font"><%ejGetML(MLG_Menu_EthStatistics)%></td>
			</tr>
			<tr>
				<td colspan="1" class="table_font w_blue" ><center>
					<textarea id="xdslInfo" rows="20" wrap="off" readonly style="width: 99%; overflow-x: scroll; overflow-y: hidden; border:0; font-family:COURIER NEW,Helvetica, sans-serif;font-size:11px" class="table_font">
						
					</textarea>
				</center></td>
			</tr>
			<tr>
				<td id="getxdsl">
					<textarea id="xdslarea">
						<%ejGetOtherBig(vdslStatus, 0, 0)%>
					</textarea>
				</td>
			</tr>
		</table>
      </td>
    </tr>
  </table>
  <br>
       <!-- VoIP Registration Status Start -->			
            <table id="voipTable" width="94%" border="0" align="center"  cellpadding="0" cellspacing="0">
          <tr>
            <td>
              <table width="100%" cellpadding="0" cellspacing="0" >
                <tr >
                  <td class="top_font"><%ejGetML(MLG_ConnStatus_Status_Str55)%> </td>
                </tr>
                <tr >
                  <td  class="table_font">
                    <!--Table define start-->
                    <table width="95%" align="center" cellpadding="0" cellspacing="0" class="table_frame" id="registrationStatus">
                      <tr align="center" valign="top">
                        <td class="table_font2"><%ejGetML(MLG_ConnStatus_Status_Str56)%></td>
                        <td width="80" class="table_font2"><%ejGetML(MLG_ConnStatus_Status_Str57)%></td>
                        <td class="table_font2 textOverflow"><%ejGetML(MLG_ConnStatus_Status_Str58)%></td>
                        <td class="table_font2 textOverflow"><%ejGetML(MLG_Network_DynamicDNS_Str5)%></td>
                        <td class="table_font2"><%ejGetML(MLG_ConnStatus_Status_Str60)%></td>
                      </tr>
					  <span id='SipAccountList'>
                      <script TYPE="text/javascript">				  
                         createSipAccountList();
                      </script>
					  </span>
                    </table>
                  </td>
                </tr>
                <tr >
                  <td  class="table_font">&nbsp;</td>
                </tr>
              </table>
	  </td>
          </tr>
        </table>
        <!-- VoIP Registration Status End -->
   <br>
</div>
<script language='JavaScript'>
<!--
$(document).ready(function() {

	frmLoad(1);
});
//-->
</script>

