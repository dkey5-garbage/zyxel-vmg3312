<script type="text/javascript" src="../../js/wireless.js"></script>
<script language="javascript">
<!-- hide
var syncNvram = '<%ejGetWl(wlSyncNvram)%>';
var ssid = '<%ejGetWl(wlSsid)%>';
var ssidIdx = parseInt('<%ejGetWl(wlSsidIdx)%>');
var enbl = '<%ejGetWl(wlEnbl)%>';
var hide = '<%ejGetWl(wlHide)%>';
var apisolate = '<%ejGetWl(wlAPIsolation)%>';
var mbssisolate = '<%ejGetWl(wlBssidIsolation)%>';
var mode = '<%ejGetWl(wlAuthMode)%>';
var wlRefresh = '<%ejGetWl(wlRefresh)%>';
var bands = '<%ejGetWl(wlBands)%>';
var band = '<%ejGetWl(wlBand)%>';
var nbwcap = '<%ejGetWl(wlNBwCap)%>'; 
var nctrlsb = '<%ejGetWl(wlNCtrlsb)%>';
var obsscoex = '<%ejGetWl(wlObssCoex)%>';  //yingyu
var phy = '<%ejGetWl(wlPhyType)%>';
var radiusServerIP = '<%ejGetWl(wlRadiusServerIP)%>';
var bit = '<%ejGetWl(wlKeyBit)%>';
var keys128 = new Array( "<%ejGetWl(wl128Key1)%>", "<%ejGetWl(wl128Key2)%>","<%ejGetWl(wl128Key3)%>", "<%ejGetWl(wl128Key4)%>" );
var keys64 = new Array( "<%ejGetWl(wl64Key1)%>", "<%ejGetWl(wl64Key2)%>","<%ejGetWl(wl64Key3)%>", "<%ejGetWl(wl64Key4)%>" );
var autoWepKey64 = '<%ejGetWl(wlDefaultKey64)%>';
var autoWepKey128 = '<%ejGetWl(wlDefaultKey128)%>';
var autoWpaKey = '<%ejGetWl(wlDefaultWpaKey)%>';
var useDefaultWepKey = '<%ejGetWl(wlUseDefaultWepKey)%>';
var useDefaultWpaKey = '<%ejGetWl(wlUseDefaultWpaKey)%>';
var keyIdx = '<%ejGetWl(wlKeyIndex)%>';
var wpaPskKey = '<%ejGetWl(wlWpaPsk)%>';
var wpaGTKRekey = '<%ejGetWl(wlWpaGTKRekey)%>';
var radiusPort = '<%ejGetWl(wlRadiusPort)%>';
var radiusKey = '<%ejGetWl(wlRadiusKey)%>';
var wep = '<%ejGetWl(wlWep)%>';
var wpa = '<%ejGetWl(wlWpa)%>';
var auth = '<%ejGetWl(wlAuth)%>';
var wlCorerev = '<%ejGetWl(wlCoreRev)%>';
var varPreauth = '<%ejGetWl(wlPreauth)%>';
var varNetReauth = '<%ejGetWl(wlNetReauth)%>';
var WscMode = '<%ejGetWl(wlWscMode)%>';
var WscAPMode  = '<%ejGetWl(wlWscAPMode)%>';
var enableWmf = '<%ejGetWl(wlEnableWmf)%>';
var wpswifibutton = '<%ejGetWl(wlEnableButtom)%>';

var wmf = '<%ejGetWl(wlHasWmf)%>';
var channel = '<%ejGetWl(wlChannel)%>';
var wlCurrentChannel = '<%ejGetWl(wlCurrentChannel)%>';
var wlmode = '<%ejGetWl(wlMode)%>';
var nmode = '<%ejGetWl(wlNmode)%>';
var nreqd = '<%ejGetWl(wlNReqd)%>'; 
var wllazy = '<%ejGetWl(wlLazyWds)%>';
var sessionkey = '<%ejGetOther(sessionKey)%>';
var passphraseUI = '<%ejGetWl(wlPassphraseUI)%>';
var oldWepPassphraseKey = '<%ejGetWl(wlWepPassphraseKey)%>';
var newWepPassphraseKey = '<%ejGetWl(wlWepPassphraseKey)%>';
var WscMode = '<%ejGetWl(wlWscMode)%>';
var ttnetnolimit = '<%ejGetOther(sysInfo,buildttnetnolimit)%>';
if(ttnetnolimit == '1'){
var maxAssoc = '<%ejGetWl(wlMaxAssoc)%>';
}
var forEircom  = '<%ejGetOther(sysInfo, forEircom)%>';
var forNorwaywl  = '<%ejGetOther(sysInfo, forNorwaywl)%>';
if(ttnetnolimit == '1'){
var maxBandwidth = '<%ejGetWl(wlMaxBandwidth)%>';
}
var upRate = '<%ejGetOther(lineRate, 0, 0)%>';
var downRate = '<%ejGetOther(lineRate, 1, 0)%>';
var Device = '<%ejGetWl(wlDevice)%>';
/* switch for WPS 1.0 and 2.0, __TELEFONICA__, MitraStar Curtis, 20120322 */
var WscVer2    = '<%ejGetWl(wlWscVer2)%>';
var periousValue;
var oldpKey1, oldpKey2, oldpKey3, oldpKey4, oldpKey0;
var wepAsterisk = "***************************";
var wpaAsterisk = "*****************************************************************";
if(ttnetnolimit == '1'){
var maxDownBW = '<%ejGetWl(wlMaxDownBandwidth)%>'; 
}
var supportwlan = '<%ejGetOther(sysInfo, numWlAdaptor)%>';

var onlyttnetfeature='<%ejGetOther(sysInfo,onlyttnetFeature)%>'; //TTNET feature
if(onlyttnetfeature == '1'){	/* _MSTC_, Linda, WLAN Button, GUI, RadioEnabled and Status Relation.  */
var radenbl = '<%ejGetWl(RadioEnbl)%>';
}
//var wlSendEmailEnable='<%ejGetWl(wlEmailEnable)%>';	//user set to choose whether to send email or not. by JuWen
//var wlEmailSelect= '<%ejGetWl(wlSelectEmailSend)%>';	//choose mail server to send email by JuWen
//var wl_sendmailto = '<%ejGetWl(wlSendEmailTo)%>';		//Send email to by JuWen
//var wl_sendmailti = '<%ejGetWl(wlSendEmailTitle)%>';	//Send email title by JuWen
//var supportEmailNotification='<%ejGetOther(sysInfo, buildEmailNotification)%>';	//Send email title by JuWen

var ttfeature='<%ejGetOther(sysInfo,ttFeature)%>';
var softgre='<%ejGet(softgre)%>';
var tthomegwfeature='<%ejGetOther(sysInfo,tthomegwFeature)%>';

var TTNETMultiUser='<%ejGetOther(sysInfo,ttnetMultiUser)%>';
var curloginLevel = "<%ejGet(curloginLevel)%>";
var VisibilityLevel = "<%ejGet(generalv)%>";
var Limitation = "<%ejGet(generalLimitation)%>";
var Lock = "<%ejGet(generalLock)%>";
function VisibilityLevelshow(){
	if(curloginLevel == "admin")
	{
		if (VisibilityLevel == 2)
		{
			document.getElementById("s1").style.display="none";
		}
		else if(Limitation==0)
		{
			if(Lock ==0)
			{
				document.getElementById("s2").style.display="block";
				document.getElementById("WLBSSID").style.display="block";
				document.getElementById("security_title").style.display="block";
				//all content is displayed 
			}
			else if(Lock ==1)
			{
				document.getElementById("s2").style.display="block";
				document.getElementById("WLBSSID").style.display="block";
				document.getElementById("security_title").style.display="block";

				wlEnbl_Enable.disabled="ture";
				wlEnbl_Disable.disabled="ture";
				wlChannel.disabled="ture";
				wlSsid.disabled="ture";
				wl_hide.disabled="ture";
				wl_apisolate.disabled="ture";
				wl_mbssisolate.disabled="ture";
				wl_enablewmf.disabled="ture";
				wl_usedefaultwepkey.disabled="ture";
				wlWepEncryption.disabled="ture";
				moreSecurity.disabled="ture";
				wl_usedefaultwpakey.disabled="ture";
				sysSubmit.disabled="ture";
				sysCancel.disabled="ture";

				//ALL content will be grayed-out for admin
			}
		}
		else if (Limitation==1)
		{
			if(Lock ==0)
			{
				document.getElementById("s2").style.display="none";
				document.getElementById("WLBSSID").style.display="none";
				document.getElementById("security_title").style.display="none";
				document.getElementById("wepmode").style.display="none";
				document.getElementById("secmode").style.display="none";
				//Admin will see the limited version of the page
			}
			else if(Lock ==1)
			{
				document.getElementById("s2").style.display="none";
				document.getElementById("WLBSSID").style.display="none";
				document.getElementById("security_title").style.display="none";
				document.getElementById("wepmode").style.display="none";
				document.getElementById("secmode").style.display="none";

				wlEnbl_Enable.disabled="ture";
				wlEnbl_Disable.disabled="ture";
				wlChannel.disabled="ture";
				wlSsid.disabled="ture";
				wl_hide.disabled="ture";
				wl_apisolate.disabled="ture";
				wl_mbssisolate.disabled="ture";
				wl_enablewmf.disabled="ture";
				wl_usedefaultwepkey.disabled="ture";
				wlWepEncryption.disabled="ture";
				moreSecurity.disabled="ture";
				wl_usedefaultwpakey.disabled="ture";
				sysSubmit.disabled="ture";
				sysCancel.disabled="ture";
				//grayed-out with Limitation parameter
			}
		}
	}
	else if(curloginLevel == "root")
	{

		if(Lock ==0)
		{
			document.getElementById("s2").style.display="block";
			document.getElementById("WLBSSID").style.display="block";
			document.getElementById("security_title").style.display="block";
			//see/modify all content of the page
		}
		else if(Lock ==1)
		{
			document.getElementById("s2").style.display="block";
			document.getElementById("WLBSSID").style.display="block";
			document.getElementById("security_title").style.display="block";
			
			wlEnbl_Enable.disabled="ture";
			wlEnbl_Disable.disabled="ture";
			wlChannel.disabled="ture";
			wlSsid.disabled="ture";
			wl_hide.disabled="ture";
			wl_apisolate.disabled="ture";
			wl_mbssisolate.disabled="ture";
			wl_enablewmf.disabled="ture";
			wl_usedefaultwepkey.disabled="ture";
			wlWepEncryption.disabled="ture";
			moreSecurity.disabled="ture";
			wl_usedefaultwpakey.disabled="ture";
			sysSubmit.disabled="ture";
			sysCancel.disabled="ture";
			//see all content grayed-out
		}
	}
}

function acceptFonSSID(fonssid){
	var ssidstr=fonssid.toUpperCase();
	if((ssidstr.match("FON")== null) && (ssidstr.match("F0N")==null))
		return true;	//check okay. not including str 'fon'. 
	return false;
}
function phyChange() {
   with ( document.forms[0] ) {
      if (phy == "n" || phy == "v") {
         $("#btn_more").show();
      } else {
         $("#btn_more").hide();
      }
   }
}

function loadChannelList(OnPageLoad)
{
   var sel_ch;
   var sel_band;
   var sel_nbw_cap;
   var sel_sb;
   var idx;

   /* save selected */
   if (OnPageLoad) {
      sel_ch = channel;
      sel_band = band;
      sel_nbw_cap = nbwcap;
      sel_sb = nctrlsb;
   } else {
      sel_ch = document.forms[0].wlChannel.value;
      sel_band = document.forms[0].wlBand.value;
      sel_nbw_cap = document.forms[0].wlNBwCap.value;
      sel_sb = document.forms[0].wlNCtrlsb.value;
   }
   /* load list */
   document.forms[0].wlChannel.length = 0;

   if ((sel_band == "2") && ((phy != "n") && (phy != "v"))) {
      <%ejGetWl(wlChannelList, b, b, 20)%>
   }
   else  if ((sel_band == "1") && ((phy != "n") && (phy != "v"))) {
      <%ejGetWl(wlChannelList, a, a, 20)%>
   }
   else if ((sel_band == "2") && (phy == "n") ) {
      if (sel_nbw_cap == "1") {
         if (sel_sb == 1) {
            <%ejGetWl(wlChannelList, n, b, 40, "upper")%>
            //__MSTC__, Cinmex, For multi language
            document.forms[0].wlChannel[0] = new Option("<%ejGetML(MLG_Common_Auto)%>", "0")
         } else {
            <%ejGetWl(wlChannelList, n, b, 40, "lower")%>
            //__MSTC__, Cinmex, For multi language
            document.forms[0].wlChannel[0] = new Option("<%ejGetML(MLG_Common_Auto)%>", "0")
         }
      } else if(sel_nbw_cap == "0" || sel_nbw_cap == "2"){
         <%ejGetWl(wlChannelList, n, b, 20 )%>
            //__MSTC__, Cinmex, For multi language
         document.forms[0].wlChannel[0] = new Option("<%ejGetML(MLG_Common_Auto)%>", "0")
      }         
   }
   else  if ((sel_band == "1") && (phy == "n") ) {
      if(sel_nbw_cap == "1" || sel_nbw_cap == "2") {
         if (sel_sb == 1) {
            <%ejGetWl(wlChannelList, n, a, 40, "upper")%>
         } else {
            <%ejGetWl(wlChannelList, n, a, 40, "lower")%>
         }  
      } else if (sel_nbw_cap == "0") {
         <%ejGetWl(wlChannelList, n, a, 20 )%>
      }         
   }      
   else if ((sel_band == "1") && (phy == "v") && (sel_nbw_cap == "3")) {    
      /* Band a and AC phy and 80M */
      <%ejGetWl(wlChannelList, v, a, 80 )%>
   }
   else  if ((sel_band == "2") && (phy == "v") ) { 
      if(sel_nbw_cap == "1") {
         if(sel_sb == 1) {

            <%ejGetWl(wlChannelList, v, b, 40, "upper")%>
         } else {

            <%ejGetWl(wlChannelList, v, b, 40, "lower")%>         
         }            
      } else if(sel_nbw_cap == "0" || sel_nbw_cap == "2"){  
  
         <%ejGetWl(wlChannelList, v, b, 20 )%>
      }         
   }
   else  if ((sel_band == "1") && (phy == "v")) {   
      if(sel_nbw_cap == "1" || sel_nbw_cap == "2") {
         if(sel_sb == 1) {

            <%ejGetWl(wlChannelList, v, a, 40, "upper")%>
         } else {

            <%ejGetWl(wlChannelList, v, a, 40, "lower")%>         
         }  
      } else if (sel_nbw_cap == "0") {

         <%ejGetWl(wlChannelList, v, a, 20 )%>
      }         
   }      
   else {
      document.forms[0].wlChannel[0] = new Option("<%ejGetML(MLG_Common_Auto)%>", "0")
   }

   /* mark selected */
   for (idx=0; idx<document.forms[0].wlChannel.options.length; idx++) {
      if (document.forms[0].wlChannel.options[idx].value == sel_ch) {
         document.forms[0].wlChannel.options[idx].selected = true;
         break;
      }
   }

   /* set to first channel none-auto if not found */
   if (idx == document.forms[0].wlChannel.options.length) {
      document.forms[0].wlChannel.options[1].selected = true;
   }
}

function sidebandChange(OnPageLoad) {

   with ( document.forms[0] ) {	
      //note. if value == 2?
      if (wlNBwCap.options[wlNBwCap.selectedIndex].value == '1') {
         wlNCtrlsb.disabled = false;
         wlNCtrlsb.options[0].value = -1;
         wlNCtrlsb.options[0].text = "<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str16)%>";//__MSTC__, Cinmex, fix MultiLanguage
	   if(wlNBwCap.selectedIndex==2)	 
	   	wlObssCoex.value = 1;
	   else
	   	wlObssCoex.value = 0;
      } else if (wlNBwCap.options[wlNBwCap.selectedIndex].value == '2' && wlBand.value == "1") {
         wlNCtrlsb.disabled = false;
         wlNCtrlsb.options[0].value = -1;
         wlNCtrlsb.options[0].text = "<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str16)%>";//__MSTC__, Cinmex, fix MultiLanguage
      } else if (wlNBwCap.options[wlNBwCap.selectedIndex].value == '3' && wlBand.value == "1"){
	     wlNCtrlsb.disabled = false;
         wlNCtrlsb.options[0].value = -1;
         wlNCtrlsb.options[0].text = "<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str16)%>";//__MSTC__, Cinmex, fix MultiLanguage
      } else {
         wlNCtrlsb.disabled = true;
         wlNCtrlsb.selectedIndex = 0;
         wlNCtrlsb.options[0].value = 0;
         wlNCtrlsb.options[0].text = "None";
      }
   }

   loadChannelList(OnPageLoad);
}

function updateCurChannel() {
   if (document.forms[0].wlChannel.value == '0' || bands == '1')
   {
	    var delay = 500;
		setTimeout(function(){

		   if (window.XMLHttpRequest) {
		      objChScanXMLHTTP=new XMLHttpRequest();
			  postCurChannelCmd();
		   } else if (window.ActiveXObject) {
		      // code for IE
		      objChScanXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
		      postCurChannelCmd();
		   }

		   function postCurChannelCmd()
		   {
			  if ( objChScanXMLHTTP != null ) {
			      objChScanXMLHTTP.open("POST","wireless-curChannal.cmd", true);
			      objChScanXMLHTTP.onreadystatechange = function() 
			      {
			         if(objChScanXMLHTTP.readyState == 4) {
			            var result = objChScanXMLHTTP.responseText;
			            if (result != "") {
						delay = 0;
						document.getElementById("cur_channel").innerHTML = "<%ejGetML(MLG_WLAN_Currnet)%>: " + result;
			            }
			         }
			      }
			      objChScanXMLHTTP.send(null);
			  }
		   }
		}, delay);

	  
   } else {
      document.getElementById("cur_channel").innerHTML = "";
   }
}

/* Know issue: can't work with IE7
see http://api.jquery.com/jQuery.browser/ to using JQuery get browser information
see http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx to check IE Compatibility Modes
It will cause error when we using "EmulateIE7" with IE8
To check the Compatibility Mode, refer to http://msdn.microsoft.com/en-us/library/cc196988%28v=vs.85%29.aspx

It is tag on root meta tag, like below:
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" >  
: Peter.Lee.MitraStar 2012-09-20*/

function updateCurwepkey() {
/*check is IE? and version under 8? : Peter.Lee.MitraStar 2012-09-20*/
   if($.browser.msie && (parseInt($.browser.version, 10) < 8))
			return;

   with (document.forms[0]) {	
   var obj_old,keyindex;
   var obj_array=new Array("","","","");
   var chk1,chk2;

    if( box_unmaskwepkey.checked==true) 
	{
		var objXMLHTTP;
			
		    if (window.XMLHttpRequest) {
			      objXMLHTTP=new XMLHttpRequest();
			} else if (window.ActiveXObject) {
			      // code for IE
			      objXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
			}
		   
			if ( objXMLHTTP != null ) {
			    objXMLHTTP.open("POST","wireless-wepkey.cmd?encry="+wlWepEncryption.value+"&", true);
			  //  objXMLHTTP.open("POST","wireless-wepkey.cmd?index="+(keyindex+1)+"&encry="+wlWepEncryption.value+"&", false);
			    objXMLHTTP.onreadystatechange = function() 
			    {
							//success response
			         if((objXMLHTTP.readyState == 4) && objXMLHTTP.status == 200) {
					 	//TODO: using responseXML?
			            var result = objXMLHTTP.responseText;
			            if (result != "") {	
							var index_num=0;					
							var split_buf=result.split(/\r?\n/);

							//catch the min index number, so that to avoid undefine error
							index_num= Math.min(obj_array.length,split_buf.length);
							
							for(i=0;i<index_num;i++)
							{
								var temp="WepKey"+(i+1);
								var temp_ch1="input_wlKey"+(i+1);
								chk1= document.getElementById(temp_ch1).value;
								chk2=chk1.charCodeAt(0);
								if( split_buf[i].search(/temp/)) {								   
									if( (split_buf[i].substring(temp.length+1)) == chk1 || (chk2 == '42') ){
	 									obj_array[i].value = split_buf[i].substring(temp.length+1);
									}else{
										obj_array[i].value = chk1;
									}
								}
							}
			            }
			         }
		         }
	   	         objXMLHTTP.send(null);
			} //end if( objXMLHTTP != null )

	  	 	for( i=0; i< wlKeyIndex.length ; i++)	{
				//obj_old = wlKeys[i];
		 		obj_array[i]=changeInputType(wlKeys[i], 'text');
	  		}		

	} else {
	
	   	for( i=0; i< wlKeyIndex.length ; i++)	{
			//	obj_old = wlKeys[i];
				obj_array[i]=changeInputType(wlKeys[i], 'password');
	   	}//end for loop
	  
    }
   }
}


function updateCurwpakey() {
   if($.browser.msie && (parseInt($.browser.version, 10) < 8))
			return;

   with (document.forms[0]) {	
	var new_obj;
	var chk1,chk2;
                           
    if( box_unmaskwpakey.checked==true)
	{
		var objXMLHTTP;
		
	    if (window.XMLHttpRequest) {
		      objXMLHTTP=new XMLHttpRequest();
		} else if (window.ActiveXObject) {
		      // code for IE
		      objXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
		}

		if ( objXMLHTTP != null ) {
		    objXMLHTTP.open("POST","wireless-wpakey.cmd", true);
		    objXMLHTTP.onreadystatechange = function() 
		    {
						//success response
		         if(objXMLHTTP.readyState == 4) {
		            var result = objXMLHTTP.responseText;
		            if (result != "") {
						chk1 = document.getElementById("input_wlWpaPsk").value;
						chk2=chk1.charCodeAt(0);					
						if( (result == chk1) || (chk2 == '42') ){
							new_obj.value = result;
						}else{
							new_obj.value = chk1;
						}
					}
		         }
	         }
   	         objXMLHTTP.send(null);
		} //end if( objXMLHTTP != null )
	   new_obj=changeInputType(wlWpaPsk, 'text');

	} else {
	  new_obj=changeInputType(wlWpaPsk, 'password');
    }
   }
}

function updateCurRadiuskey() {
   if($.browser.msie && (parseInt($.browser.version, 10) < 8))
			return;
   with (document.forms[0]) {	
	var new_obj;
	var chk1,chk2;;
                           
    if( box_unmaskradiuskey.checked==true)
	{
		var objXMLHTTP;
		
	    if (window.XMLHttpRequest) {
		      objXMLHTTP=new XMLHttpRequest();
		} else if (window.ActiveXObject) {
		      // code for IE
		      objXMLHTTP=new ActiveXObject("Microsoft.XMLHTTP");
		}

		if ( objXMLHTTP != null ) {
		    objXMLHTTP.open("POST","wireless-RadiusKey.cmd", true);
		    objXMLHTTP.onreadystatechange = function() 
		    {
				//success response
		        if(objXMLHTTP.readyState == 4) {
		           var result = objXMLHTTP.responseText;
		           chk1 = document.getElementById("wlRadiusKey").value;
		           chk2=chk1.charCodeAt(0);		
		           if (result != "") {
						if( (result == chk1) || (chk2 == '42') ){
							new_obj.value = result;
						} else {
							new_obj.value = chk1;
						}
		           }else{
				 		 if(chk2 == '42'){
		            		new_obj.value = "";
				  		}else{
		            		new_obj.value = chk1;
				  		}
		           }
		        }
	         }
   	         objXMLHTTP.send(null);
		} //end if( objXMLHTTP != null )
	   new_obj=changeInputType(wlRadiusKey, 'text');

	} else {
	  new_obj=changeInputType(wlRadiusKey, 'password');
    }
   }
}

//replace input box type
//only for brower support 
//using javascript to change input box attribute between "text" and "password"
//This method is restricted by browser, for example: the version of IE which under 7 will cause "null object" fail
function changeInputType(oldObject, oType) {
   if($.browser.msie && (parseInt($.browser.version, 10) < 8))
   		return;
  with (document.forms[0]) {

	  var newObject = document.createElement('input');
	
	  newObject.type = oType;
	  if(oldObject.size) newObject.size = oldObject.size;
	  if(oldObject.value) newObject.value = oldObject.value;
	  if(oldObject.name) newObject.name = oldObject.name;
	  if(oldObject.id) newObject.id = oldObject.id;
	  if(oldObject.className) newObject.className = oldObject.className;
  	  if(oldObject.maxlength) newObject.maxlength = oldObject.maxlength;

	  oldObject.parentNode.replaceChild(newObject,oldObject);
      return newObject;
  }  
}


//hide all selections	
function stopSilde(silderValue){
   for (var x = 1; x <= optionLength - 1; x++) {
      if (silderValue == x) 
         continue;
      $('#select_' + x).find('._on').attr('style', 'display:none;');
      $('#select_' + x).find('._off').removeAttr('style');
   }
   $('#error_mssage').fadeOut('fast');
}

function changeWlan()
{
   with (document.forms[0]) {
      if (wlEnbl[0].checked == true) {
         $("#WLBSSID").show();
      } else {
         $("#WLBSSID").hide();
      }
   }
}

var CACHE_NUM = 4;
var arrayPassphraseCache = new Array(CACHE_NUM);
for(i = 0; i < CACHE_NUM; i++){arrayPassphraseCache[i] = new Array("","","","","","","");}
function setPassphraseCache(pass, wep64_1, wep64_2, wep64_3, wep64_4, wep128, wpapsk){
   for(i = 1; i < CACHE_NUM; i++){
      arrayPassphraseCache[i-1] = arrayPassphraseCache[i];      
   }
   arrayPassphraseCache[CACHE_NUM -1] = new Array(pass, wep64_1, wep64_2, wep64_3, wep64_4, wep128, wpapsk);

}

function getPassphraseCache(pass){
   var tempArray;
   var isFound = 0;
   for(i = 0; i < CACHE_NUM; i++){
      tempArray = arrayPassphraseCache[i];
      if(tempArray[0] == pass){
         isFound = 1;
         break;
      }
   }

   if(isFound == 1){
      return tempArray;
   }else{
      return new Array("","","","","","","");
   }
}


//detectPassphraseKey()
//Call this funtion when you want to calculate the key from ui, and wait user to completed keying
//Parameters:
//    delay
//       >0: call from user input, and wait ? ms for finish keying
//       =0: call from function, not trigger by key input
//Returns:
//    none
var detectVal = 0;
function detectPassphraseKey(e, delay){
   with(document.forms[0]) {
      var icon_delay = 250;
      if(delay == 0){
         icon_delay = 0;
      }

      //denied the left, up, right, down key which is user input
      var event = window.event||e;
      if(event.type == "keyup"){
         //no change, no calculate
         if(wlPassphraseUI.value == 1){
            if($('#pKey1').attr('value') == oldpKey1 &&
               $('#pKey2').attr('value') == oldpKey2 &&
               $('#pKey3').attr('value') == oldpKey3 &&
               $('#pKey4').attr('value') == oldpKey4){
               return;
            }
         }else if(wlPassphraseUI.value == 2){
            if($('#pKey0').attr('value') == oldpKey0){
               return;
            }
         }
      }
      
      var tempDetect;
      var tempPassphrase;
      
      if(detectVal + 1 > 10000){
         detectVal = 0;
         tempDetect = 0;
      }else{
         detectVal++;
         tempDetect = detectVal;
      }
      
      //clean icon
      $('#span_pkCheck').html("");      

      //clean the setting fields
      if(wl_usedefaultwepkey.checked == true){
         $('#text_wlKey1').html("<img src=\"../../images/grid-loading.gif\" width=\"16\" height=\"16\"/>");
         $('#text_wlKey2').html("<img src=\"../../images/grid-loading.gif\" width=\"16\" height=\"16\"/>");
         $('#text_wlKey3').html("<img src=\"../../images/grid-loading.gif\" width=\"16\" height=\"16\"/>");
         $('#text_wlKey4').html("<img src=\"../../images/grid-loading.gif\" width=\"16\" height=\"16\"/>");
      }

      if(wl_usedefaultwpakey.checked == true){
         $('#text_wlWpaPsk').html("<img src=\"../../images/grid-loading.gif\" width=\"16\" height=\"16\"/>");

      }
      
      setTimeout(function(){
         if(detectVal == tempDetect){
            
            //"none" mode does not need to check passphrase
            if(wlPassphraseUI.value != 0){

               //get latest passphrase
               if(wlPassphraseUI.value == 1){
                  tempPassphrase = $('#pKey1').attr('value') + $('#pKey2').attr('value') + $('#pKey3').attr('value') + $('#pKey4').attr('value');      
               }else if(wlPassphraseUI.value == 2){
                  tempPassphrase = $('#pKey0').attr('value');
               }
               
               //sync
               syncPassphraseKey(tempPassphrase);

               //is user key in?
               if(delay != 0){
                  //invalid password
/*
                  if(tempPassphrase.length < 16 ||
                     isValidKeyPassphrase(tempPassphrase) == false){
*/
                  if(tempPassphrase.length == 0) {
                     $("#text_wlKey1").html("N/A");
                     $("#text_wlKey2").html("N/A");
                     $("#text_wlKey3").html("N/A");
                     $("#text_wlKey4").html("N/A");
                     $('#text_wlWpaPsk').html("N/A");

                     //denied icon
                     $('#span_pkCheck').hide();
                     $('#span_pkCheck').html("<img src=\"../../images/i_block_on.gif\" width=\"10\" height=\"10\"/>");
                     $('#span_pkCheck').fadeIn('slow');
                     
                     return;
                  }
               
                  //accept icon
                  $('#span_pkCheck').hide();
                  $('#span_pkCheck').html("<img src=\"../../images/i_accept_on.gif\" width=\"10\" height=\"10\"/>");
                  $('#span_pkCheck').fadeIn('slow');

               }
            }

            //for icon show correctly, open another thread
            setTimeout(function(){
               changePassphraseKey();
            }, icon_delay);
            
         }
      }, delay);
   }
}

//changePassphraseKey()
//update all key field from keypassphrase
function changePassphraseKey(){
   with(document.forms[0]) {
      var tempPassphrase;
      var tempWpa = "";
      var tempWep;
      var tempWarp;

      if(wlPassphraseUI.value == 0){

         //write the default value
         if(wl_usedefaultwepkey.checked == true){
            //128bits or 64 bits? set 1st~3rd value
            if (wlWepEncryption.selectedIndex == 0) {

//            wlKeys[1].value = wepAsterisk;
//            wlKeys[2].value = wepAsterisk;
//            wlKeys[3].value = wepAsterisk;

		 wlKeys[1].value = keys128[1];
               wlKeys[2].value = keys128[2];
               wlKeys[3].value = keys128[3];

               $('#text_wlKey2').text(wlKeys[1].value);
               $('#text_wlKey3').text(wlKeys[2].value);
               $('#text_wlKey4').text(wlKeys[3].value);
               
            } else {

//            wlKeys[1].value = wepAsterisk;
//            wlKeys[2].value = wepAsterisk;
//            wlKeys[3].value = wepAsterisk;

		 wlKeys[1].value = keys64[1];
               wlKeys[2].value = keys64[2];
               wlKeys[3].value = keys64[3];


               $('#text_wlKey2').text(wlKeys[1].value);
               $('#text_wlKey3').text(wlKeys[2].value);
               $('#text_wlKey4').text(wlKeys[3].value);
            }

            //set the 0 index default value
            if (wlWepEncryption.selectedIndex == 0){
               tempWarp = strWarp(autoWepKey128, 13);
               $('#text_wlKey1').html(tempWarp);
               wlKeys[0].value = autoWepKey128;
            }else{

               $('#text_wlKey1').text(autoWepKey64);
               wlKeys[0].value = autoWepKey64;
            }
         }else{
            if (wlWepEncryption.selectedIndex == 0) {
               //user input
               wlKeys[0].value = keys128[0];
               wlKeys[1].value = keys128[1];
               wlKeys[2].value = keys128[2];
               wlKeys[3].value = keys128[3];
            }else{
               wlKeys[0].value = keys64[0];
               wlKeys[1].value = keys64[1];
               wlKeys[2].value = keys64[2];
               wlKeys[3].value = keys64[3];
            }
         }         
         

         if(wl_usedefaultwpakey.checked == true){
            wlWpaPsk.value = autoWpaKey;
            if (forNorwaywl == 1){
               tempWarp = strWarp(autoWpaKey, 13);
            }else{
               tempWarp = strWarp(autoWpaKey, 13);
            }
            $('#text_wlWpaPsk').html(tempWarp);
         }else{
            wlWpaPsk.value = wpaPskKey;
         }

         return;
      }else if(wlPassphraseUI.value == 1){
         //get latest passphrase
         tempPassphrase = $('#pKey1').attr('value') + $('#pKey2').attr('value') + $('#pKey3').attr('value') + $('#pKey4').attr('value');      

         //write the default value
         if(wl_usedefaultwepkey.checked == true){
            //do nothing
         }else{
            if (wlWepEncryption.selectedIndex == 0){
               //user input
               wlKeys[0].value = keys128[0];
               wlKeys[1].value = keys128[1];
               wlKeys[2].value = keys128[2];
               wlKeys[3].value = keys128[3];
            }else{
               wlKeys[0].value = keys64[0];
               wlKeys[1].value = keys64[1];
               wlKeys[2].value = keys64[2];
               wlKeys[3].value = keys64[3];
            }
         }

         if(wl_usedefaultwpakey.checked == true){
            //do nothing
         }else{
            wlWpaPsk.value = wpaPskKey;
         }
         
      }else if(wlPassphraseUI.value == 2){
         //get latest passphrase
         tempPassphrase = $('#pKey0').attr('value');

         //write the default value
         if(wl_usedefaultwepkey.checked == true){
            //do nothing
         }else{
            if (wlWepEncryption.selectedIndex == 0){
               //user input
               wlKeys[0].value = keys128[0];
               wlKeys[1].value = keys128[1];
               wlKeys[2].value = keys128[2];
               wlKeys[3].value = keys128[3];
            }else{
               wlKeys[0].value = keys64[0];
               wlKeys[1].value = keys64[1];
               wlKeys[2].value = keys64[2];
               wlKeys[3].value = keys64[3];
            }
         }

         if(wl_usedefaultwpakey.checked == true){
            //do nothing
         }else{
            wlWpaPsk.value = wpaPskKey;
         }
      }
/*
      //invalid password
      if(tempPassphrase.length < 16 ||
         isValidKeyPassphrase(tempPassphrase) == false){
*/
      if(tempPassphrase.length == 0) {
         $("#text_wlKey1").html("N/A");
         $("#text_wlKey2").html("N/A");
         $("#text_wlKey3").html("N/A");
         $("#text_wlKey4").html("N/A");
         $('#text_wlWpaPsk').html("N/A");
         
         return;
      }

      //cache pass
      var tempCache = getPassphraseCache(tempPassphrase);
      if(tempCache[0] != ""){
         tempWep = new Array(tempCache[1],tempCache[2],tempCache[3],tempCache[4],tempCache[5]);
         tempWpa = tempCache[6];
      }else{
         tempWep = getWepKeyFromPassphrase(tempPassphrase);

         if((navigator.userAgent.search("MSIE") > -1) == true){
            //IE core
            $.ajax({
              url: "wireless-wpapass.cmd",
              type: 'POST',
              async: false,
              cache: false,
              timeout: 10000,
              data:  "sessionKey=" + sessionkey + "&passphrase=" + tempPassphrase + "&ssid=" + $('#wlSsid').attr('value'),
              success:  function(data){
                           var params = data.split("@");
                           sessionkey = params[0];
                           tempWpa = params[1];
                        }
            });
         }else{
            //non-IE core
            tempWpa = getWpaPskKeyFromPassphrase(tempPassphrase, $('#wlSsid').attr('value'));
         }

         setPassphraseCache(tempPassphrase, tempWep[0], tempWep[1], tempWep[2], tempWep[3], tempWep[4], tempWpa);
      }

      //wep      
      if(wl_usedefaultwepkey.checked == true){
         if($("#wlWepEncryption").attr("selectedIndex") == '1'){
            //64 bits
            $("#text_wlKey1").html(tempWep[0]);
            $("#text_wlKey2").html(tempWep[1]);
            $("#text_wlKey3").html(tempWep[2]);
            $("#text_wlKey4").html(tempWep[3]);
            wlKeys[0].value = tempWep[0];
            wlKeys[1].value = tempWep[1];
            wlKeys[2].value = tempWep[2];
            wlKeys[3].value = tempWep[3];
         }else{
            //128 bits
            tempWarp = strWarp(tempWep[4], 13);
            $("#text_wlKey1").html(tempWarp);
            wlKeys[0].value = tempWep[4];

            wlKeys[1].value = keys128[1];
            wlKeys[2].value = keys128[2];
            wlKeys[3].value = keys128[3];

            var wlWpaPskWarp;
            if(isRepeatedStr(wlKeys[1].value, "*", 27) == false){
               wlWpaPskWarp = strWarp(wlKeys[1].value, 13);
               $('#text_wlKey2').html(wlWpaPskWarp);
            }else{
               $('#text_wlKey2').text(wlKeys[1].value);
            }

            if(isRepeatedStr(wlKeys[2].value, "*", 27) == false){
               wlWpaPskWarp = strWarp(wlKeys[2].value, 13);
               $('#text_wlKey3').html(wlWpaPskWarp);
            }else{
               $('#text_wlKey3').text(wlKeys[2].value);
            }

            if(isRepeatedStr(wlKeys[3].value, "*", 27) == false){
               wlWpaPskWarp = strWarp(wlKeys[3].value, 13);
               $('#text_wlKey4').html(wlWpaPskWarp);
            }else{
               $('#text_wlKey4').text(wlKeys[3].value);
            }
         }
      }

      //wpa        
      if(wl_usedefaultwpakey.checked == true){
         tempWarp = strWarp(tempWpa, 20);
         $('#text_wlWpaPsk').html(tempWarp);
         wlWpaPsk.value = tempWpa;
      }
   }

   
}

//changePassphraseType
//Trigger when password type is set
//onLoadPage
//    0: Normal
//    1: First load
//    2: No trigger update newWepPassphraseKey
function changePassphraseType(onLoadPage){
   with(document.forms[0]) {
      if(onLoadPage == 1){
         if(newWepPassphraseKey != "" && passphraseUI == 0){
            wlPassphraseUI.value = 1;
         }else{
            wlPassphraseUI.value = passphraseUI;
         }
         
         if(newWepPassphraseKey.length > 16){
            wlPassphraseUI.value = 2;
         }else if(useDefaultWepKey == '1' || useDefaultWpaKey == '1'){
            wlPassphraseUI.value = 0;
         }else if(newWepPassphraseKey == "" && useDefaultWepKey == '0' && useDefaultWpaKey == '0'){
            wlPassphraseUI.value = 0;
         }
      }

      if(wlPassphraseUI.value == 0) {
         $('#div_passphrase2').hide();
         
      }else if(wlPassphraseUI.value == 1) {

         if(onLoadPage == 0){
            //update val from another
            newWepPassphraseKey = $('#pKey0').attr('value');
         }else if(onLoadPage == 1){
            //copy val to another when frmLoad
            syncPassphraseKey(newWepPassphraseKey);
         }

         if($('#div_passphrase').css('display') == 'block'){
            $('#div_passphrase2').show();
         }else{
            $('#div_passphrase2').hide();
         }
         
         $('#span_pkFixed').show();
         $('#span_pkVariable').hide();

         $('#pKey1').attr('value', newWepPassphraseKey.substring(0, 4));
         if(newWepPassphraseKey.length > 4) $('#pKey2').attr('value', newWepPassphraseKey.substring(4, 8)); else $('#pKey2').attr('value', "");
         if(newWepPassphraseKey.length > 8) $('#pKey3').attr('value', newWepPassphraseKey.substring(8, 12)); else $('#pKey3').attr('value', "");
         if(newWepPassphraseKey.length > 12) $('#pKey4').attr('value', newWepPassphraseKey.substring(12, 16)); else $('#pKey4').attr('value', "");
         if(newWepPassphraseKey.length > 16) $('#pKey5').attr('value', newWepPassphraseKey.substring(16, newWepPassphraseKey.length)); else $('#pKey5').attr('value', "");
      }else if(wlPassphraseUI.value == 2){

         if(onLoadPage == 0){
            //update val from another
            newWepPassphraseKey = $('#pKey1').attr('value') + $('#pKey2').attr('value') + $('#pKey3').attr('value') + $('#pKey4').attr('value') + $('#pKey5').attr('value');
         }else if(onLoadPage == 1){
            //copy val to another when frmLoad
            syncPassphraseKey(newWepPassphraseKey);
         }

         if($('#div_passphrase').css('display') == 'block'){
            $('#div_passphrase2').show();
         }else{
            $('#div_passphrase2').hide();
         }
         
         $('#span_pkFixed').hide();
         $('#span_pkVariable').show();
         $('#pKey0').attr('value', newWepPassphraseKey);
      }
   }
}

function syncPassphraseKey(pass){
   //sync newWepPassphraseKey
   newWepPassphraseKey = pass;

   //sync wep
   $('#pKey1').attr('value', newWepPassphraseKey.substring(0, 4));
   if(newWepPassphraseKey.length > 4) $('#pKey2').attr('value', newWepPassphraseKey.substring(4, 8)); else $('#pKey2').attr('value', "");
   if(newWepPassphraseKey.length > 8) $('#pKey3').attr('value', newWepPassphraseKey.substring(8, 12)); else $('#pKey3').attr('value', "");
   if(newWepPassphraseKey.length > 12) $('#pKey4').attr('value', newWepPassphraseKey.substring(12, 16)); else $('#pKey4').attr('value', "");
   if(newWepPassphraseKey.length > 16) $('#pKey5').attr('value', newWepPassphraseKey.substring(16, newWepPassphraseKey.length)); else $('#pKey5').attr('value', "");
   
   //sync wpa
   $('#pKey0').attr('value', newWepPassphraseKey);

   //sync old data
   oldpKey1 = $('#pKey1').attr('value');
   oldpKey2 = $('#pKey2').attr('value');
   oldpKey3 = $('#pKey3').attr('value');
   oldpKey4 = $('#pKey4').attr('value');
   oldpKey0 = $('#pKey0').attr('value');   
}

function loadAuthMode()
{
   with (document.forms[0]) {
      if (WscMode == "enabled") {
         moreSecurity[0] = new Option("<%ejGetML(MLG_WLAN_WPAPSK)%>","psk");
         moreSecurity[1] = new Option("<%ejGetML(MLG_WLAN_WPA2PSK)%>","psk2");
      } else {
         moreSecurity[0] = new Option("<%ejGetML(MLG_WLAN_WPAPSK)%>","psk");
         moreSecurity[1] = new Option("<%ejGetML(MLG_WLAN_WPA2PSK)%>","psk2");
if(onlyttnetfeature == '1'){
         moreSecurity[2] = new Option("<%ejGetML(MLG_WLAN_WPA2)%>","wpa2");
}else{
         moreSecurity[2] = new Option("<%ejGetML(MLG_WLAN_WPA)%>","wpa");
         moreSecurity[3] = new Option("<%ejGetML(MLG_WLAN_WPA2)%>","wpa2");
}
      }

      if (mode == 'open' && wep == 'disabled') {
         $('#select_1').trigger('selectMe');
         stopSilde('1');
      } else if (mode == 'open' && wep == 'enabled') {
         $('#select_2').trigger('selectMe');
         stopSilde('2');
      } else if (mode == 'psk') {
         $('#select_3').trigger('selectMe');
         moreSecurity.selectedIndex = 0;
         stopSilde('3');
      } else if (mode == 'psk2') {
        $('#select_3').trigger('selectMe');
         moreSecurity.selectedIndex = 1;
         stopSilde('3');
      } else if (mode == 'wpa') {
         $('#select_3').trigger('selectMe');
         moreSecurity.selectedIndex = 2;
         stopSilde('3');
      } else if (mode == 'wpa2') {
         $('#select_3').trigger('selectMe');
if(onlyttnetfeature == '1'){		 
         moreSecurity.selectedIndex = 2;
}else{
         moreSecurity.selectedIndex = 3;
}
         stopSilde('3');
      } else if (mode == 'psk psk2') {
         $('#select_3').trigger('selectMe');
         moreSecurity.selectedIndex = 1;
         stopSilde('3');
      } else if (mode == 'wpa wpa2') {
         $('#select_3').trigger('selectMe');
if(onlyttnetfeature == '1'){
         moreSecurity.selectedIndex = 2;
}else{
         moreSecurity.selectedIndex = 3;
}
         stopSilde('3');
      }

      $('#moreSecurity').trigger('change');
   }
}


function refreshUsePassphraseUI(){
   with (document.forms[0]) {
      if (periousValue == 1) {
         wlPassphraseUI.disabled = false;
         pKey0.disabled = false;
         pKey1.disabled = false;
         pKey2.disabled = false;
         pKey3.disabled = false;
         pKey4.disabled = false;
         pKey5.disabled = false;
      }else if (periousValue == 2) {
         if (wl_usedefaultwepkey.checked == true) {
            wlPassphraseUI.disabled = false;
            pKey0.disabled = false;
            pKey1.disabled = false;
            pKey2.disabled = false;
            pKey3.disabled = false;
            pKey4.disabled = false;
            pKey5.disabled = false;
         }else{                     
            wlPassphraseUI.disabled = true;
            pKey0.disabled = true;
            pKey1.disabled = true;
            pKey2.disabled = true;
            pKey3.disabled = true;
            pKey4.disabled = true;
            pKey5.disabled = true;
         }
      }else if (periousValue == 3) {
         if (wl_usedefaultwpakey.checked == true) {
            wlPassphraseUI.disabled = false;
            pKey0.disabled = false;
            pKey1.disabled = false;
            pKey2.disabled = false;
            pKey3.disabled = false;
            pKey4.disabled = false;
            pKey5.disabled = false;
         }else{                     
            wlPassphraseUI.disabled = true;
            pKey0.disabled = true;
            pKey1.disabled = true;
            pKey2.disabled = true;
            pKey3.disabled = true;
            pKey4.disabled = true;
            pKey5.disabled = true;
         }
      }
      $('#span_pkCheck').hide();
   }
}

//refreshUseDefaultWepKey()
//Replace between input text and label text
function refreshUseDefaultWepKey(onLoadPage) {
   with (document.forms[0]) {
 	if (forEircom == 0 ){
            $('#wep128Note').fadeIn(0);
            $('#wep64Note').fadeIn(0);	
 	}else{
            if (wlWepEncryption.selectedIndex == 0){	
               $('#wep64Note').fadeOut(0);
               $('#wep128Note').fadeIn(0);
            }else if (wlWepEncryption.selectedIndex == 1){
               $('#wep128Note').fadeOut(0);
               $('#wep64Note').fadeIn(0);			
            }
 	}		
      //for set wlKeys values on frm load
      if(onLoadPage == 1){
         if (wlWepEncryption.selectedIndex == 0) {
            wlKeys[0].value = keys128[0];
            wlKeys[1].value = keys128[1];
            wlKeys[2].value = keys128[2];
            wlKeys[3].value = keys128[3];

            tempWarp=strWarp(wlKeys[0].value,13);
            $('#text_wlKey1').html(tempWarp);
            tempWarp=strWarp(wlKeys[1].value,13);
            $('#text_wlKey2').html(tempWarp);
            tempWarp=strWarp(wlKeys[2].value,13);
            $('#text_wlKey3').html(tempWarp);
            tempWarp=strWarp(wlKeys[3].value,13);
            $('#text_wlKey4').html(tempWarp);
         } else {
            wlKeys[0].value = keys64[0];
            wlKeys[1].value = keys64[1];
            wlKeys[2].value = keys64[2];
            wlKeys[3].value = keys64[3];

            $('#text_wlKey1').text(keys64[0]);
            $('#text_wlKey1').text(keys64[1]);
            $('#text_wlKey1').text(keys64[2]);
            $('#text_wlKey1').text(keys64[3]);
         }
      }



      //default, passphrase or none?
      if (wl_usedefaultwepkey.checked == true) { // enable
         wlKeys[0].disabled = true;
         wlKeys[1].disabled = true;
         wlKeys[2].disabled = true;
         wlKeys[3].disabled = true;

         if((wlPassphraseUI.value == 1 || wlPassphraseUI.value == 2) && wlWepEncryption.selectedIndex == 1){
            wlKeyIndex[0].disabled = false;
            wlKeyIndex[1].disabled = false;
            wlKeyIndex[2].disabled = false;
            wlKeyIndex[3].disabled = false;
         }else{
            wlKeyIndex[0].disabled = true;
            wlKeyIndex[1].disabled = true;
            wlKeyIndex[2].disabled = true;
            wlKeyIndex[3].disabled = true;

            wlKeyIndex[0].checked = true;
         }
         
         wlKey1.disabled = true;
         wlKey2.disabled = true;
         wlKey3.disabled = true;
         wlKey4.disabled = true;         

         $('#input_wlKey1').hide();
         $('#input_wlKey2').hide();
         $('#input_wlKey3').hide();
         $('#input_wlKey4').hide();
         $('#box_unmaskwepkey').hide();
         $('#wep_text_unmask').hide();
		 
         $('#text_wlKey1').show();
         $('#text_wlKey2').show();
         $('#text_wlKey3').show();
         $('#text_wlKey4').show();

         if (onLoadPage == '1') {
            if (keyIdx == '1')
               wlKeyIndex[0].checked = true;
            else if (keyIdx == '2')
               wlKeyIndex[1].checked = true;
            else if (keyIdx == '3')
               wlKeyIndex[2].checked = true;
            else if (keyIdx == '4')
               wlKeyIndex[3].checked = true;
         }
         
      } else { // disable
         wlKeys[0].disabled = false;
         wlKeys[1].disabled = false;
         wlKeys[2].disabled = false;
         wlKeys[3].disabled = false;
         wlKeyIndex[0].disabled = false;
         wlKeyIndex[1].disabled = false;
         wlKeyIndex[2].disabled = false;
         wlKeyIndex[3].disabled = false;
         wlKey1.disabled = false;
         wlKey2.disabled = false;
         wlKey3.disabled = false;
         wlKey4.disabled = false;

         $('#input_wlKey1').show();
         $('#input_wlKey2').show();
         $('#input_wlKey3').show();
         $('#input_wlKey4').show();
		 //request wep key again
 	     updateCurwepkey();		 
//__MSTC__, Cinmex, For hide unmask check box
         //$('#box_unmaskwepkey').show();
         //$('#wep_text_unmask').show();		 
         $('#box_unmaskwepkey').hide();
         $('#wep_text_unmask').hide();
//Cinmex, end
         $('#text_wlKey1').hide();
         $('#text_wlKey2').hide();
         $('#text_wlKey3').hide();
         $('#text_wlKey4').hide();

         //if (onLoadPage == '1') {
            if (keyIdx == '1')
               wlKeyIndex[0].checked = true;
            else if (keyIdx == '2')
               wlKeyIndex[1].checked = true;
            else if (keyIdx == '3')
               wlKeyIndex[2].checked = true;
            else if (keyIdx == '4')
               wlKeyIndex[3].checked = true;
         //}

      }

   }
}

//refreshUseDefaultWpaKey()
//Replace between input text and label text
function refreshUseDefaultWpaKey(onLoadPage) {
   with (document.forms[0]) {
      if (wl_usedefaultwpakey.checked == true) { // enable
         wlWpaPsk.disabled = true;
         
         $('#text_wlWpaPsk').show();         
         $('#input_wlWpaPsk').hide();
         $('#wpa_text_unmask').hide();
         $('#box_unmaskwpakey').hide();

         
      }else{
         wlWpaPsk.disabled = false;
		 updateCurwpakey();	 
         $('#text_wlWpaPsk').hide();
         $('#input_wlWpaPsk').show();
//__MSTC__, Cinmex, For hide the unmask check box
         //$('#wpa_text_unmask').show();
         //$('#box_unmaskwpakey').show();
         $('#wpa_text_unmask').hide();
         $('#box_unmaskwpakey').hide();
//Cinmex, End
      }

   }
}

function loadWpaEncryption(OnPageLoad) {
   with ( document.forms[0] ) {
      if (OnPageLoad == 1) {
         // Define new algorithms
         if (wlCorerev >= 3) {
            if (phy=='n' && nmode != "off")
               algos = new Array("<%ejGetML(MLG_WLAN_AES)%>", "<%ejGetML(MLG_WLAN_TKIPAES)%>");
            else
               algos = new Array("TKIP", "AES", "TKIP+AES");
         } else {
            algos = new Array("TKIP");
         }

         // Reconstruct algorithm array from new algorithms
         wlWpa.length = algos.length;

         for (var i in algos) {
            wlWpa[i] = new Option(algos[i], algos[i].toLowerCase());
            wlWpa[i].value = algos[i].toLowerCase();

            if (algos[i].toLowerCase() == wpa)
               wlWpa[i].selected = true;
         }
      } else {
/*
         //advice default cipher selection,remove if not desired
          if (authMode == "wpa" || authMode == "psk")
             wlWpa.selectedIndex = 0;
          if (authMode == "wpa2" || authMode == "psk2")
             wlWpa.selectedIndex = 1;
          if (authMode == "wpa wpa2" || authMode == "psk psk2")
             wlWpa.selectedIndex = 2;

          wpa=wlWpa[wlWpa.selectedIndex].value;
*/
      }
   }
}

function isValidWPAPskKey(val) {
   var ret = false;
   var len = val.length;
   var maxSize = 64;
   var minSize = 8;

   if (len >= minSize && len < maxSize){
      var regex = /^[A-Za-z0-9._-]+$/;
      if (val.match(regex) != null){
         ret = true;
      }
   } else if (len == maxSize) {
      for (i = 0; i < maxSize; i++ ){
         if (isHexaDigit(val.charAt(i)) == false){
            break;
         }
      }
      
      if (i == maxSize){
         ret = true;
      }
      
   } else{
      ret = false;
   }

   return ret;
}

function changeSecurityValue() {
   with (document.forms[0]) {
      if (periousValue == 1) {
         wlAuthMode.value = "open";
         wlWep.value = "disabled";
      } else if (periousValue == 2) {
         wlAuthMode.value = "open";
         wlWep.value = "enabled";
		 if (wl_usedefaultwepkey.checked == false ) {
		 	updateCurwepkey();
		 }
		 
      } else if (periousValue == 3) {
         if (moreSecurity.value == "psk")
            wlAuthMode.value = "psk";
         else if (moreSecurity.value == "psk2" && WPAPSKCompatible[0].checked == false)
            wlAuthMode.value = "psk2";
         else if (moreSecurity.value == "psk2" && WPAPSKCompatible[0].checked == true)
            wlAuthMode.value = "psk psk2";
         else if (moreSecurity.value == "wpa")
            wlAuthMode.value = "wpa";
         else if (moreSecurity.value == "wpa2" && WPACompatible[0].checked == false)
            wlAuthMode.value = "wpa2";
         else if (moreSecurity.value == "wpa2" && WPACompatible[0].checked == true)
            wlAuthMode.value = "wpa wpa2";

         wlWep.value = "disabled";

		 switch(moreSecurity.value)
		 {
		   case "psk":
		   case "psk2":
			 if (wl_usedefaultwpakey.checked == false ) {
			 	 updateCurwpakey();
      }
		   	break;

		   case "wpa":
		   case "wpa2":
				 updateCurRadiuskey();
		   	break;		 
   }
}

   }
}

function frmLoad() {
/*
	if(supportEmailNotification==1)
	{     
                showhide("EmailTopic", "1");
  		showhide("EmailEnable", "1");
		 if(wlSendEmailEnable==1)
 		{     
 			showhide("EmailSever", "1");
 			showhide("EmailTitle", "1");
 			showhide("EmailAddress", "1");
		}
		  if(wlSendEmailEnable==0)
		 {
 			showhide("EmailSever", "0");
 			showhide("EmailTitle", "0");
 			showhide("EmailAddress", "0");
		 }	
	}
	else
	{
	       showhide("EmailTitle", "0");
		showhide("EmailEnable", "0");
		showhide("EmailSever", "0");
		showhide("EmailTitle", "0");
		showhide("EmailAddress", "0");
	}
*/
	if(ttnetnolimit == '1'){
		$("#Assoc").show();
		$("#bandwidth").show();
		$("#apisolate").hide();
		$("#mbssisolate").hide();
	}
	else{
		$("#Assoc").hide();
		$("#bandwidth").hide();
		$("#apisolate").show();
		$("#mbssisolate").show();
	}
	
   //unbind all event
   $('#btn_more').unbind();
   $('#select_1').unbind();
   $('#select_2').unbind();
   $('#select_3').unbind();
   $('#btn_wepmore').unbind();
   $('#btn_WEPMoreNote').unbind();
   $('#btn_wpapskmore').unbind();
   $('#btn_wpa2pskmore').unbind();
   $('#btn_wpamore').unbind();
   $('#btn_wpa2more').unbind();
   $("#moreSecurity").unbind();
   $('#pKey1').unbind();
   $('#pKey2').unbind();
   $('#pKey3').unbind();
   $('#pKey4').unbind();
   $('#btn_more').html('<%ejGetML(MLG_Common_more)%>...');
   $('.moreBtn').html('<%ejGetML(MLG_Common_more)%>...');
   
   $("#wepmode").hide();
   $("#secmode").hide();
   $("#wepmore").hide();
   $("#WEPMoreNote").hide();
   $('#div_nMode_1').hide();
   $('#div_nMode_2').hide();
   $('#div_passphrase').hide();
   $('#div_passphrase2').hide();


	if (forEircom != '1'){
		document.getElementById("wpswifibtnhidden").style.display='none';
	}

   optionLength = 4;
   for (var x = 1; x <= optionLength - 1; x++) {
      $('#select_' + x).bind('selectMe', function(e){
         {;
            // $(e.target).find('._off').fadeOut('fast');
            // $(e.target).find('._on').fadeIn('fast');
            $(e.target).find('._on').slideDown('fast');
         }
      });
   }
   $('#btn_more').click(function(){
      if(TTNETMultiUser == '1')
      {
		if(curloginLevel == "admin" ||curloginLevel == "root")
		  {
			if(Lock == 0)
			{
				if(phy == "n" || phy == "v"){
				 $('#div_nMode_1').toggle(0);
				 $('#div_nMode_2').toggle(0);
				}
			  
				$('#div_passphrase').toggle(0);
				changePassphraseType(2);

				if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
					$(this).html('<%ejGetML(MLG_Common_more)%>...');
				else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
					$(this).html('<%ejGetML(MLG_Common_less)%>');
			}
		  }
		  else
		  {
			if(phy == "n" || phy == "v"){
			 $('#div_nMode_1').toggle(0);
			 $('#div_nMode_2').toggle(0);
			}
		  
			$('#div_passphrase').toggle(0);
			changePassphraseType(2);

			if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
				$(this).html('<%ejGetML(MLG_Common_more)%>...');
			else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
				$(this).html('<%ejGetML(MLG_Common_less)%>');
		  }
      }
      else
      {
		if(phy == "n" || phy == "v"){
         $('#div_nMode_1').toggle(0);
         $('#div_nMode_2').toggle(0);
		}
      
		$('#div_passphrase').toggle(0);
		changePassphraseType(2);

		if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
			$(this).html('<%ejGetML(MLG_Common_more)%>...');
		else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
			$(this).html('<%ejGetML(MLG_Common_less)%>');
      }
      
   });
   $('#select_1').bind('selectMe', function(e){
      $('#wepmode').fadeOut(0);
      $('#secmode').fadeOut(0);
   });
   $('#select_2').bind('selectMe', function(e){
      $('#wepmode').fadeIn(0);
      $('#secmode').fadeOut(0);
   });
   $('#select_3').bind('selectMe', function(e){
      $('#wepmode').fadeOut(0);
      $('#secmode').fadeIn(0);
   });

   //show/hide WEP more setting
   $('#btn_wepmore').click(function(){
      if(TTNETMultiUser == '1')
	  {
		if(curloginLevel == "admin" || curloginLevel == "root")
		  {
			if(Lock == 0)
			{
				$('#wepmore').toggle(0);
				$('#wepdesc').toggle(0);

				if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
					$(this).html('<%ejGetML(MLG_Common_more)%>...');
				else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
					$(this).html('<%ejGetML(MLG_Common_less)%>');
			}
		  }
		  else
		  {
			$('#wepmore').toggle(0);
			$('#wepdesc').toggle(0);

			if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
				$(this).html('<%ejGetML(MLG_Common_more)%>...');
			else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
				$(this).html('<%ejGetML(MLG_Common_less)%>');
		  }
	  }
      else
      {
		$('#wepmore').toggle(0);
		$('#wepdesc').toggle(0);

		if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
			$(this).html('<%ejGetML(MLG_Common_more)%>...');
		else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
			$(this).html('<%ejGetML(MLG_Common_less)%>');
      }
   });
      
   $('#btn_WEPMoreNote').click(function(){
      $('#WEPMoreNote').toggle(0);
   });

    if(forEircom == 1){
         $('#btn_wepmore').fadeOut(0);
         $('#btn_WEPMoreNote').fadeIn(0);
    }else{
         $('#btn_wepmore').fadeIn(0);
         $('#btn_WEPMoreNote').fadeOut(0);
    }

   //show/hide WPA-PSK more setting
   $('#btn_wpapskmore').click(function(){
      if(TTNETMultiUser == '1')
	  {
		if(curloginLevel == "admin" || curloginLevel == "root")
		  {
			if(Lock == 0)
			{
				$('#encryp').toggle(0);
				$('#timer').toggle(0);

				if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
					$(this).html('<%ejGetML(MLG_Common_more)%>...');
				else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
					$(this).html('<%ejGetML(MLG_Common_less)%>');
			}
		  }
		else
		  {
			$('#encryp').toggle(0);
			$('#timer').toggle(0);

			if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
				$(this).html('<%ejGetML(MLG_Common_more)%>...');
			else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
				$(this).html('<%ejGetML(MLG_Common_less)%>');
		  }
	  }
      else
      {
		$('#encryp').toggle(0);
		$('#timer').toggle(0);

		if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
			$(this).html('<%ejGetML(MLG_Common_more)%>...');
		else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
			$(this).html('<%ejGetML(MLG_Common_less)%>');
      }
   });

   //show/hide WPA-PSK more setting
   $('#btn_wpa2pskmore').click(function(){
      if(TTNETMultiUser == '1')
	  {
		if(curloginLevel == "admin" || curloginLevel == "root")
		  {
			if(Lock == 0)
			{
				$('#pskcom').toggle(0);
				$('#encryp').toggle(0);
				$('#timer').toggle(0);

				if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
					$(this).html('<%ejGetML(MLG_Common_more)%>...');
				else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
					$(this).html('<%ejGetML(MLG_Common_less)%>');
			}
		  }
		  else
		  {
			$('#pskcom').toggle(0);
			$('#encryp').toggle(0);
			$('#timer').toggle(0);

			if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
				$(this).html('<%ejGetML(MLG_Common_more)%>...');
			else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
				$(this).html('<%ejGetML(MLG_Common_less)%>');
		  }
	  }
      else
      {
		$('#pskcom').toggle(0);
		$('#encryp').toggle(0);
		$('#timer').toggle(0);

		if ($(this).html() == '<%ejGetML(MLG_Common_less)%>')
			$(this).html('<%ejGetML(MLG_Common_more)%>...');
		else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...')
			$(this).html('<%ejGetML(MLG_Common_less)%>');
      }
   });

   //show/hide WPA more setting
   $('#btn_wpamore').click(function(){
      $('#encryp').toggle(0);
      $('#timer').toggle(0);

      if ($(this).html() == '<%ejGetML(MLG_Common_less)%>') 
         $(this).html('<%ejGetML(MLG_Common_more)%>...');
      else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...') 
         $(this).html('<%ejGetML(MLG_Common_less)%>');
   });

   //show/hide WPA2 more setting
   $('#btn_wpa2more').click(function(){
      $('#encryp').toggle(0);
      $('#timer').toggle(0);
      $('#wpacom').toggle(0);
      $('#wpa2').toggle(0);
      $('#wpa2_reauth').toggle(0);

      if ($(this).html() == '<%ejGetML(MLG_Common_less)%>') 
         $(this).html('<%ejGetML(MLG_Common_more)%>...');
      else if ($(this).html() == '<%ejGetML(MLG_Common_more)%>...') 
         $(this).html('<%ejGetML(MLG_Common_less)%>');
   });

   $("#moreSecurity").change(function(){
      $('.moreBtn').html('<%ejGetML(MLG_Common_more)%>...');

      var secType = $(this).val();
      if (secType == 'psk'){
         $("#pwd").fadeIn(0);
         $("#pwd_auto").fadeIn(0);
         $("#authserver").fadeOut(0);
         $("#btn_wpapskmore").fadeIn(0);
         $("#btn_wpa2pskmore").fadeOut(0);
         $('#pskcom').hide(0);
         $('#encryp').hide(0);
         $('#timer').hide(0);
         $('#wpacom').hide(0);
         $('#wpa2').hide(0);
      }	else if (secType == 'psk2'){
      	 $("#pwd").fadeIn(0);
         $("#pwd_auto").fadeIn(0);
         $("#authserver").fadeOut(0);
         $("#btn_wpapskmore").fadeOut(0);
         $("#btn_wpa2pskmore").fadeIn(0);
         $('#pskcom').hide(0);
         $('#encryp').hide(0);
         $('#timer').hide(0);
         $('#wpacom').hide(0);
         $('#wpa2').hide(0);
      } else if (secType == 'wpa'){
         $("#pwd").fadeOut(0);
         $("#pwd_auto").fadeOut(0);
         $("#authserver").fadeIn(0);
         $("#btn_wpamore").fadeIn(0);
         $("#btn_wpa2more").fadeOut(0);
         $('#pskcom').hide(0);
         $('#encryp').hide(0);
         $('#timer').hide(0);
         $('#wpacom').hide(0);
         $('#wpa2').hide(0);
      } else if (secType == 'wpa2'){
         $("#pwd").fadeOut(0);
         $("#pwd_auto").fadeOut(0);
         $("#authserver").fadeIn(0);
         $("#btn_wpamore").fadeOut(0);
         $("#btn_wpa2more").fadeIn(0);
         $('#pskcom').hide(0);
         $('#encryp').hide(0);
         $('#timer').hide(0);
         $('#wpacom').hide(0);
         $('#wpa2').hide(0);
      }
   });

   if (mode == 'open' && wep == 'disabled') {
      periousValue = 1;
   } else if (mode == 'open' && wep == 'enabled') {
      periousValue = 2;
   } else if (mode == 'psk') {
      periousValue = 3;
   } else if (mode == 'psk2') {
      periousValue = 3;
   } else if (mode == 'wpa') {
      periousValue = 3;
   } else if (mode == 'wpa2') {
      periousValue = 3;
   } else if (mode == 'psk psk2') {
      periousValue = 3;
   } else if (mode == 'wpa wpa2') {
      periousValue = 3;
   }

   var silder;
   silder = $("#silder").slider({
      value: periousValue,
      animate: true,
      orientation: 'horizontal',
      min: 1,
      max: 3,
      //handle: $('.draw_btn'),
      step: 1,
      //modify 20100114 start
         change: function(event, ui){
            if (periousValue != ui.value) {
               stopSilde();
               $('#select_' + ui.value).trigger('selectMe');
               updateSliderHandlePQAAttr(ui.value);
               periousValue = ui.value;
               refreshUsePassphraseUI();
      //modify 20100114 end
            }
            changeSecurityValue();
         }
   });

   //install zyMacUI
   macStrLength = 4;
   $('#pKey1').bind('focus', function(){
      nextfield = 'pKey2'; 
      prevfield = 'pKey1';
   }).bind('keydown', function(event){
      return doKeyDownEvent(event);
   }).bind('keyup', function(event){
      return doMacStrKeyUp(event);
   }).bind('keypress', function(event){
      return disableEnterKey(event);
   });

   $('#pKey2').bind('focus', function(){
      nextfield = 'pKey3'; 
      prevfield = 'pKey1';
   }).bind('keydown', function(event){
      return doKeyDownEvent(event);
   }).bind('keyup', function(event){
      return doMacStrKeyUp(event);
   }).bind('keypress', function(event){
      return disableEnterKey(event);
   });

   $('#pKey3').bind('focus', function(){
      nextfield = 'pKey4'; 
      prevfield = 'pKey2';
   }).bind('keydown', function(event){
      return doKeyDownEvent(event);
   }).bind('keyup', function(event){
      return doMacStrKeyUp(event);
   }).bind('keypress', function(event){
      return disableEnterKey(event);
   });

   $('#pKey4').bind('focus', function(){
      nextfield = 'pKey4'; 
      prevfield = 'pKey3';
   }).bind('keydown', function(event){
      return doKeyDownEvent(event);
   }).bind('keyup', function(event){
      return doMacStrKeyUp(event);
   }).bind('keypress', function(event){
      return disableEnterKey(event);
   });
	
   function updateSliderHandlePQAAttr(value){
      switch (value) {
         case 1:
            $('#silder .ui-slider-handle').attr('pqaattr', 'No Security');
            break;
         case 2:
            $('#silder .ui-slider-handle').attr('pqaattr', 'Basic');
            break;
         case 3:
            $('#silder .ui-slider-handle').attr('pqaattr', 'More Secure');
            break;  
      }
   }
    
   updateSliderHandlePQAAttr(periousValue);

   $('li.sliderBlock').each(function(i, d){
      $(this).click(function(){
         $("#silder").slider('value', i + 1); 
      })
   });

   function getBandIndex(b) {
      var ret;
	   
      if ( b == '1' )
         ret = 1;
      else
         ret = 0;
      return ret;
   }

   function getDeviceIndex(b) {
      var ret;
	   
      if ( b == '1' )
         ret = 1;
      else
         ret = 0;
      return ret;
   }
   
   with (document.forms[0]) {
      if (enbl == '1') {
         wlEnbl[0].checked = true;
         wlEnbl[1].checked = false;
      } else {
         wlEnbl[0].checked = false;
         wlEnbl[1].checked = true;
      }
      if((onlyttnetfeature = 1) && (radenbl == 0))	/* _MSTC_, Linda, WLAN Button, GUI, RadioEnabled and Status Relation.  */
      {
         wlEnbl[0].disabled=true;
         wlEnbl[1].disabled=true;
      }

      //if (bands == '3')
         $("#div_band").show();
      //else
         //$("#div_band").hide();

	  var sel_band = band;
	  var sel_Device = Device;
	  if(supportwlan == 2)
	  	wlBand.selectedIndex = getDeviceIndex(sel_Device);
	  else
	  	wlBand.selectedIndex = getBandIndex(sel_band);


      loadChannelList(true);
      updateCurChannel();
	  if (phy == "v" && nbwcap == 3){
	  	wlNBwCap.selectedIndex = 2;// 5G/80M	  	
	  }else
	  {
		if(nbwcap == 1 && obsscoex == 1)    //yingyu
      			wlNBwCap.selectedIndex = 2;
		else
	    		wlNBwCap.selectedIndex = nbwcap;
	  }

      if (nctrlsb == '0' || nctrlsb == '-1')
         wlNCtrlsb.selectedIndex = 0;
      else
         wlNCtrlsb.selectedIndex = 1;
      sidebandChange(true);

      if(bands == 3 && supportwlan != 2){
	     wlBand.selectedIndex=0;
	     wlBand.disabled=true;
       }
      //Passphrase Key
      changePassphraseType(1);

      wlSsid.value = ssid;

      if (hide == '1') {
         wl_hide.checked = true;
      } else {
         wl_hide.checked = false;
      }
//cinmex Start
      box_unmaskwepkey.checked = true;
      box_unmaskwpakey.checked = true;
//cinmex End
      if(ttnetnolimit=='0')
      {
      if (apisolate == '1') {
         wl_apisolate.checked = true;
      } else {
         wl_apisolate.checked = false;
      }

      if (mbssisolate == '1') {
         wl_mbssisolate.checked = true;
      } else {
         wl_mbssisolate.checked = false;
      }
      }
      if (enableWmf == '1') {
         wl_enablewmf.checked = true;
      } else {
         wl_enablewmf.checked = false;
      }


      if (wpswifibutton == '1') {
         wl_wpswifibutton.checked = true;
      } else {
         wl_wpswifibutton.checked = false;
      }

		/* Wireless connect  send email by JuWen */
/*
     if(supportEmailNotification==1)
     {
		if(wlSendEmailEnable == '1')   
		{
			WireLessEmailEnableSend.checked=true;
		
		}else
		{

			WireLessEmailEnableSend.checked=false;
		}

		WireLessSendEmailTo.value=wl_sendmailto;     
		WireLessSendEmailTitle.value=wl_sendmailti;  

		$("#WireLess_EmailSelect").attr("value", '<%ejGetWl(wlSelectEmailSend)%>'); 
      }
*/
		/* END -Wireless connect  send email by JuWen */ 	  


      if (wmf != '0') {
           wlEnableWmf.disabled = false;
      } else {
           wlEnableWmf.disabled = true;
      }
      
if(ttnetnolimit == '1'){
      if (maxBandwidth != '') {
         wlMaxBandwidth.value = maxBandwidth; 
      }
      if (maxDownBW != '') {
         wlMaxDownBandwidth.value = maxDownBW; 
      }
}
      phyChange();
      changeWlan();

      if (mode == "psk psk2") { // mix psk
         // setSelect(wlAuthMode, "psk2");
         WPAPSKCompatible[0].checked = true;
         WPAPSKCompatible[1].checked = false;
      } else {
         WPAPSKCompatible[0].checked = false;
         WPAPSKCompatible[1].checked = true;
      }
      if (mode == "wpa wpa2") { // mix psk
         // setSelect(wlAuthMode, "wpa2");
         WPACompatible[0].checked = true;
         WPACompatible[1].checked = false;
      } else {
         WPACompatible[0].checked = false;
         WPACompatible[1].checked = true;
      }
      loadAuthMode();

      if (useDefaultWepKey == '1'){         
         wl_usedefaultwepkey.checked = true;
      }else{
         wl_usedefaultwepkey.checked = false;
      }

      if (useDefaultWpaKey == '1'){
         wl_usedefaultwpakey.checked = true;
      }else{
         wl_usedefaultwpakey.checked = false;
      }

      if(newWepPassphraseKey != ""){
         wl_usedefaultwepkey.checked = true;
         wl_usedefaultwpakey.checked = true;
      }else{

      }
      if (bit == '0'){
	   // 128-bit
         wlWepEncryption.selectedIndex = 0;
         if(forEircom == 1){
           $('#wep64Note').fadeOut(0);           
         }else{
           $('#wep64Note').fadeIn(0);
         }
           $('#wep128Note').fadeIn(0);
      }else{
	   // 64-bit
         wlWepEncryption.selectedIndex = 1;
         if(forEircom == 1){
           $('#wep128Note').fadeOut(0);         
         }else{
           $('#wep128Note').fadeIn(0);
         }
           $('#wep64Note').fadeIn(0);
      }
      wlWpaPsk.value = wpaPskKey;   //no gen key
      refreshUseDefaultWepKey(1);   //update WEP UI
      refreshUseDefaultWpaKey(1);   //update WPA UI   
      refreshUsePassphraseUI();     //update KeyPassphrase UI

      //update initial password, not calculate
      var tempWarp;
      if (wlWepEncryption.selectedIndex == 0) {
         wlKeys[0].value = keys128[0];
         wlKeys[1].value = keys128[1];
         wlKeys[2].value = keys128[2];
         wlKeys[3].value = keys128[3];

         tempWarp=strWarp(wlKeys[0].value,13);
         $('#text_wlKey1').html(tempWarp);
         //tempWarp=strWarp(wlKeys[1].value,13);
         $('#text_wlKey2').html(wlKeys[1].value,13);
         //tempWarp=strWarp(wlKeys[2].value,13);
         $('#text_wlKey3').html(wlKeys[2].value,13);
         //tempWarp=strWarp(wlKeys[3].value,13);
         $('#text_wlKey4').html(wlKeys[3].value,13);
      }else{
         wlKeys[0].value = keys64[0];
         wlKeys[1].value = keys64[1];
         wlKeys[2].value = keys64[2];
         wlKeys[3].value = keys64[3];

         $('#text_wlKey1').text(keys64[0]);
         $('#text_wlKey2').text(keys64[1]);
         $('#text_wlKey3').text(keys64[2]);
         $('#text_wlKey4').text(keys64[3]);
      }  
      wlWpaPsk.value = wpaPskKey;
      if(useDefaultWpaKey == '1'){
         if (forNorwaywl == 1){
            tempWarp = strWarp(wpaPskKey, 13);
         }else{
            tempWarp = strWarp(wpaPskKey, 13);
         }
      }else{
         tempWarp = strWarp(wpaPskKey, 20);
      }
      $('#text_wlWpaPsk').html(tempWarp);
      
 	    //we must check the browser type and version
		// if is IE and version under 7, we need to ignore all of plain text feature, otherwise it will cause error. Peter.Lee	
		if($.browser.msie && (parseInt($.browser.version, 10) < 8))
		{
	/*		$("#box_unmaskradiuskey").hide();
			$("#radius_text_unmask").hide();
			$("#box_unmaskwpakey").hide();
			$("#wpa_text_unmask").hide();	
			$("#box_unmaskwepkey").hide();
			$("#wep_text_unmask").hide();		*/
				
/*using visibility to instad of JQuery .hide() method 
It can hide the element forever even there have some .show() code in this file
: Peter.Lee.MitraStar 2012-09-20*/
			box_unmaskradiuskey.style.visibility="hidden";
			box_unmaskwpakey.style.visibility="hidden";
			box_unmaskwepkey.style.visibility="hidden";
			radius_text_unmask.style.visibility="hidden";
			wpa_text_unmask.style.visibility="hidden";
			wep_text_unmask.style.visibility="hidden";
			box_unmaskradiuskey.disable = true;			
			box_unmaskwpakey.disable = true;
			box_unmaskwepkey.disable = true;
			radius_text_unmask.disable = true;
			wpa_text_unmask.disable = true;
			wep_text_unmask.disable = true;
		}  
      
      loadWpaEncryption(1);
      wlWpaGtkRekey.value = wpaGTKRekey;
      
      wlRadiusServerIP.value = radiusServerIP;
      wlRadiusPort.value = radiusPort;
      wlRadiusKey.value = radiusKey;

      if (varPreauth == '1') {
         wlPreauth[0].checked = true;
         wlPreauth[1].checked = false;
      } else {
         wlPreauth[0].checked = false;
         wlPreauth[1].checked = true;
      }
      wlNetReauth.value = varNetReauth;
if(ttnetnolimit == '1'){
      wlMaxAssoc.value = maxAssoc;
}
   }
}

function enableAllColumns() {
   with ( document.forms[0] ) {
      if (wlNBwCap.options[wlNBwCap.selectedIndex].value == '1') {
         wlNCtrlsb.disabled = false;
      } else {
         wlNCtrlsb.disabled = true;
      }
      
      wlBand.disabled = false;
      wlNBwCap.disabled = false;
      wl_hide.disabled = false;
      wl_apisolate.disabled = false;
      wl_mbssisolate.disabled = false;
      wl_enablewmf.disabled = false;
      moreSecurity.disabled = false;
      WPAPSKCompatible[0].disabled = false;
      WPAPSKCompatible[1].disabled = false;
      WPACompatible[0].disabled = false;
      WPACompatible[1].disabled = false;
      wlWpaPsk.disabled = false;
      wlWpaGtkRekey.disabled = false;
      wlNetReauth.disabled = false;
      wlWpa.disabled = false;
      wlRadiusServerIP.disabled = false;
      wlRadiusPort.disabled = false;
      wlRadiusKey.disabled = false;
      wlPreauth[0].disabled = false;
      wlPreauth[1].disabled = false;
      wlWepEncryption.disabled = false;
      wl_usedefaultwepkey.disabled = false;
      wl_usedefaultwpakey.disabled = false;
      wlKeyIndex[0].disabled = false;
      wlKeyIndex[1].disabled = false;
      wlKeyIndex[2].disabled = false;
      wlKeyIndex[3].disabled = false;
      wlKeys[0].disabled = false;
      wlKeys[1].disabled = false;
      wlKeys[2].disabled = false;
      wlKeys[3].disabled = false;
      wlHide.disabled = false;
      wlAPIsolation.disabled = false;
      wlBssidIsolation.disabled = false;
      wlEnableWmf.disabled = false;
      wlSsidIdx.disabled = false;
      wlUseDefaultSsid.disabled = false;
      wlAuthMode.disabled = false;
      wlWep.disabled = false;
      wlAuth.disabled = false;
      wlUseDefaultWepKey.disabled = false;
      wlUseDefaultWpaKey.disabled = false;
      wlKeyBit.disabled = false;
      wlKey1.disabled = false;
      wlKey2.disabled = false;
      wlKey3.disabled = false;
      wlKey4.disabled = false;
      wsc_config_state.disabled = false;
      wl_wsc_mode.disabled = false;
      
      refreshUsePassphraseUI();
   }
}


/*
function emailEnableSendClick(){
   with ( document.forms[0] ) {
	if( WireLessEmailEnableSend.checked)
	{           
		showhide("EmailSever", "1");
		showhide("EmailTitle", "1");
		showhide("EmailAddress", "1");
	}
	else
	{
		showhide("EmailSever", "0");
		showhide("EmailTitle", "0");
		showhide("EmailAddress", "0");
	}
   }
}
*/

function checkMaxBandwidth()
{
	with (document.forms[0]) {
	  //If can not get DSL upRate, use Ethernet 100Mbps
		if (upRate == '' || upRate == '0')
			upRate = 100000;
	 //If can not get DSL downRate, use Ethernet 100Mbps
		if (downRate == '' || downRate == '0')
			downRate = 100000;
if(ttnetnolimit == '1'){
		if(wlMaxBandwidth.value!="" && 
		 (wlMaxBandwidth.value==0 || isNaN(wlMaxBandwidth.value) || parseInt(wlMaxBandwidth.value)>parseInt(upRate))){
			return false;
		}
		else if(wlMaxDownBandwidth.value!="" && 
		 (wlMaxDownBandwidth.value==0 || isNaN(wlMaxDownBandwidth.value) || parseInt(wlMaxDownBandwidth.value)>parseInt(downRate))){
			return false;
		}
}
		return true;		
	}
}

function btnApply() {
   with ( document.forms[0] ) {	
      var msg = "";
      wlSsidIdx.value = ssidIdx;
      
      if (phy == "n" || phy == "v") {
         if ((wlBand.value == "1" && wlNBwCap.options[wlNBwCap.selectedIndex].value == "0") ||
            (wlBand.value == "2" && ((wlNBwCap.options[wlNBwCap.selectedIndex].value == "0") ||
            (wlNBwCap.options[wlNBwCap.selectedIndex].value == "2")))){
               //wlNCtrlsb should be 0, now
               wlNCtrlsb.disabled = false;
            }
   
         if (bands != '3')
            wlBand.disabled = true;
      } else {
         wlNBwCap.disabled = true;
         wlNCtrlsb.disabled = true;
         wlBand.disabled = true;
      }


      //auto gen key
      if((periousValue == 1) ||
         (periousValue == 2 && wl_usedefaultwepkey.checked == true) ||
         (periousValue == 3 && wl_usedefaultwpakey.checked == true)){

         if(wlPassphraseUI.value == 0){
            newWepPassphraseKey = "";

            if(periousValue == 2){
               wlUseDefaultWepKey.value = "1";
            }else if(periousValue == 3){
               wlUseDefaultWpaKey.value = "1";
            }
         }else if(wlPassphraseUI.value == 1){
            newWepPassphraseKey = pKey1.value + pKey2.value + pKey3.value + pKey4.value;

            if(periousValue == 2){
               wlUseDefaultWepKey.value = "0";
            }else if(periousValue == 3){
               wlUseDefaultWpaKey.value = "0";
            }
         }else if(wlPassphraseUI.value == 2){
            newWepPassphraseKey = pKey0.value;

            if(periousValue == 2){
               wlUseDefaultWepKey.value = "0";
            }else if(periousValue == 3){
               wlUseDefaultWpaKey.value = "0";
            }
         }

/*
         if(wlPassphraseUI.value != 0){
            if((newWepPassphraseKey.length < 16 ) && 
               !(newWepPassphraseKey.length == 0 && periousValue == 1)){
               msg = 'Invalid passphrase key. It should be at least 16 characters.';
               AlertOpen(msg, 2);
               enableAllColumns();
               return false;
            }else if(isValidKeyPassphrase(newWepPassphraseKey) == false &&
               newWepPassphraseKey.length != 0){
               msg = 'Invalid passphrase key. It should be a combination of both alpha character and digits 0-9.';
               AlertOpen(msg, 2);
               enableAllColumns();
               return false;
            }
         }
*/
      }else{
         //user enter key
         newWepPassphraseKey = "";

         if(periousValue == 2){
            wlUseDefaultWepKey.value = "0";
         }else if(periousValue == 3){
            wlUseDefaultWpaKey.value = "0";
         }
      }
      pKey1.disabled = true;
      pKey2.disabled = true;
      pKey3.disabled = true;
      pKey4.disabled = true;
      pKey5.disabled = true;
      pKey0.disabled = true;
      wlWepPassphraseKey.value = newWepPassphraseKey;
      wlWpaPassphraseKey.value = newWepPassphraseKey; //wpa and wep use the same key
      wl_usedefaultwepkey.disabled = true;
      wl_usedefaultwpakey.disabled = true;


      // basic settings
      if ( wlSsid.value == '' ) {
         msg = '<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str1)%>';
         hciAlert(msg, {height: 180, type: 2, title: ''});
         enableAllColumns();
         return false;
      }
      if(softgre){
        if ( acceptFonSSID(wlSsid.value)!= true ){
           msg = "<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str26)%>";
           hciAlert(msg, {height: 180, type: 2, title: ''});
           enableAllColumns();
           return false;
        }
      }
      var str = new String();
      str = wlSsid.value;
      if ( str.length > 32 ) {
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str2)%>", wlSsid.value );
         hciAlert(msg, {height: 180, type: 2, title: ''});
         enableAllColumns();
         return false;
      }

      error = checkUrlEncode(wlSsid.value);
      if(error == -1){
         //wlSsid.value = encodeUrl(wlSsid.value);
      }else{
         msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str3)%>", (error+1) );
         hciAlert(msg, {height: 180, type: 2, title: ''});
         return false;
      }

      if (wl_wpswifibutton.checked == true)
      {
	  	wlEnableButtom.value = "1";
	  }else{
	   	wlEnableButtom.value = "0";
	}

if(ttnetnolimit == '1'){
		if (!( wlMaxAssoc.value < 33 && wlMaxAssoc.value >0))	
		{
			hciAlert('<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str24)%>', {height: 180,type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});
			return false;
		}
}

/* user set the configuration of whether send email or not. by JuWen*/
/*
if(supportEmailNotification==1)
{
    if(WireLessEmailEnableSend.checked)     
	   {
		wlEmailEnable.value = 1;
		if(WireLess_EmailSelect.value == "")
		{        
			hciAlert('<%ejGetML(MLG_Maintenance_LogsSetting_AlertMsg_Str7)%>', {height: 180,type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});
			return;
		}
		if(isValidIpAddress(WireLess_EmailSelect.value) == false && isValidHostName(WireLess_EmailSelect.value) == false ) 
		{
			hciAlert('<%ejGetML(MLG_Maintenance_LogsSetting_AlertMsg_Str7)%>', {height: 180,type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});
			return;
		}			
		wlSelectEmailSend.value = WireLess_EmailSelect.value;
		if( isValidEmail(WireLessSendEmailTo.value) == false )
		{
			var tmpStr = "<%ejGetML(MLG_WAN_3gbackup_AlertMsg_Str15)%>";
			hciAlert(MLG_Makestring(tmpStr, WireLessSendEmailTo.value), {height: 180,type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});
			return;
		}
		wlSendEmailTo.value = WireLessSendEmailTo.value;
		if ( WireLessSendEmailTitle.value == "")
		{
			hciAlert('<%ejGetML(MLG_WAN_3gbackup_AlertMsg_Str16)%>', {height: 180,type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});
			return;
		}
		wlSendEmailTitle.value = WireLessSendEmailTitle.value;
	  }
         else
         {
		wlEmailEnable.value = 0;
         }	
} 
*/
/* END - user set the configuration of whether send email or not. by JuWen*/

      if (wl_hide.checked == true)
      {
         if(WscVer2 == 'enabled' && WscMode == 'enabled' )
		 {
            //hciAlert("Hide SSID does not support on WPS 2.0. You should disable wps in <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 3);\">WPS</a> page.  Or disable WPS 2.0 in <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 6);\">Others</a> page", {height: 180, type: 2, title: 'Error'});
            msg="<%ejGetML(MLG_WLAN_parent_control_err2)%>";
			hciAlert(MLG_Makestring(msg, '<a href="#" onClick="$(\'.ui-dialog-titlebar-close\').trigger(\'click\'); window.parent.document.activePage(\'network-wireless\', 3);\">WPS</a> page.  Or disable WPS 2.0 in <a href="#" onClick= "$(\'.ui-dialog-titlebar-close\').trigger(\'click\'); window.parent.document.activePage(\'network-wireless\', 6);\">Others</a>'), {height: 180,type: 2, title: 'Error'});
			enableAllColumns();
		//	wl_hide.checked = false;
            return false;
         }

         wlHide.value = "1";
      }
      else
         wlHide.value = "0";

      wl_hide.disabled = true;
      if (wl_apisolate.checked == true)
         wlAPIsolation.value = "1";
      else
         wlAPIsolation.value = "0";
  
      wl_apisolate.disabled = true;
      if (wl_mbssisolate.checked == true)
         wlBssidIsolation.value = "1";
      else
      wlBssidIsolation.value = "0";
     
      wl_mbssisolate.disabled = true;
      if (wl_enablewmf.checked == true)
         wlEnableWmf.value = "1";
      else
         wlEnableWmf.value = "0";

      wl_enablewmf.disabled = true;
      if (wlSsid.value != ssid)
         wlUseDefaultSsid.value = "0";
      else
         wlUseDefaultSsid.disabled = true;

/*
      // WDS
      if (((wlmode != 'ap') || (wllazy != '0')) &&
         ((authMode != "wep") && (authMode != "open") && (authMode != "psk") && (authMode != "psk2")))
      {
         loc += '&wlMode=ap';
         loc += '&wlLazyWds=0';
         alert("The WDS status will be changed to AP mode when security mode is not \"open\" or \"wep\"!"); 
      }
*/

      // no shared mode, wlAuth is 1 when shared mode is selected
      wlAuth.value = "0";
      moreSecurity.disabled = true;
      WPAPSKCompatible[0].disabled = true;
      WPAPSKCompatible[1].disabled = true;
      WPACompatible[0].disabled = true;
      WPACompatible[1].disabled = true;


/*For WPS 2.0 : Peter.Lee.MitraStar 2012-07-25*/
      if (wlAuthMode.value == "psk" && WscVer2=="enabled" ) {
//			hciAlert("WPS-PSK not supoort on WPS2.0. You should change security setting. Or disable WPS 2.0 in <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 6);\">Others</a> page", {height: 180, type: 2, title: 'Error'});
		hciAlert("<%ejGetML(MLG_WLAN_WPS_AlertMsg_Str5)%>", {height: 180, type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});
		enableAllColumns();
		return false;
      }


      /*Just for warning message, don't return : Peter.Lee.MitraStar 2012-07-25*/
if(tthomegwfeature == 1){
      if (wlAuthMode.value == "open" && wlWep.value == "disabled") {
			hciAlert("Disabling security allows any wireless device to access your wireless network creating an unsecured environment.", {height: 250, type: 0, title: 'Warning'});      	    
      }
}

      if (wlAuthMode.value.indexOf("psk")!= -1) {
         value = wlWpaPsk.value;
         if ( isValidWPAPskKey(value) == false && isRepeatedStr(value, "*", 65) == false) {
            msg = "<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str23)%>";
            hciAlert(msg, {height: 180, type: 2, title: ''});
            enableAllColumns();
            return false;
         }

         error = checkUrlEncode(wlWpaPsk.value);
         if(error == -1){
            wlWpaPsk.value = encodeUrl(wlWpaPsk.value);

            if(wlWpaPsk.value.length > 64){
               wlWpaPsk.disabled = true;
            }
            
         }else{
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str5)%>", (error+1) );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            return false;
         }

         if(ttfeature == 1){
            if( wlWpaPsk.value != wpaPskKey){
            	hciAlert("<%ejGetML(MLG_WLAN_PASSWORD_Str1)%>", {height: 250, type: 0, title: '<%ejGetML(MLG_Common_Alert)%>'});
            }
         }
         
      } else {
         wlWpaPsk.disabled = true;
         wlUseDefaultWpaKey.disabled = true;
		 box_unmaskwpakey.disabled = true;
      }

      if ((wlAuthMode.value.indexOf("wpa")!= -1 || wlAuthMode.value.indexOf("psk")!= -1)) {
         //check GTK interval
         value = parseInt(wlWpaGtkRekey.value);
         if ( isNaN(value) == true || value < 0 || value > 0x7fffffff ) {
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str6)%>", wlWpaGtkRekey.value );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            enableAllColumns();
            return false;
         }

         //check Reauth interval
         if (wlAuthMode.value.indexOf("wpa")!= -1) {
            value = parseInt(wlNetReauth.value);
            if ( isNaN(value) == true || value < 0 || value > 0x7fffffff ) {
               msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str7)%>", wlNetReauth.value );
               hciAlert(msg, {height: 180, type: 2, title: ''});
               enableAllColumns();
               return false;
            }
         } else {
            wlNetReauth.disabled = true;
         }
      } else {
         wlWpaGtkRekey.disabled = true;
         wlNetReauth.disabled = true;
         wlWpa.disabled = true;
      }

      if (wlAuthMode.value.indexOf("wpa") != -1) {
         if ( isValidIpAddress(wlRadiusServerIP.value) == false ) {
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str8)%>", wlRadiusServerIP.value );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            enableAllColumns();
            return false;
         }

         value = parseInt(wlRadiusPort.value);
         if (isNaN(value) == true || value <= 0 || value > 65535) {
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str9)%>", wlRadiusPort.value );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            enableAllColumns();
            return false;
         }

         if (wlRadiusKey.value == '') {
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str10)%>", wlRadiusKey.value );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            enableAllColumns();
            return false;
         }

         if(wlRadiusKey.value.length > 80 && isRepeatedStr(wlRadiusKey.value, "*", 81)){
            wlRadiusKey.disabled = true;
         }
      } else {
         wlRadiusServerIP.disabled = true;
         wlRadiusPort.disabled = true;
         wlRadiusKey.disabled = true;
         wlPreauth[0].disabled = true;
         wlPreauth[1].disabled = true;
      }

      if (wlAuthMode.value == "open" && wlWep.value == "enabled") {
         if(WscMode == 'enabled'){
            hciAlert("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str11)%> <a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 3);\"><%ejGetML(MLG_WLAN_WPS_Str4)%></a> <%ejGetML(MLG_WLAN_WPS_AlertMsg_page)%>.", {height: 180, type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});
            enableAllColumns();
            return false;
         }

         if(nmode == 'auto' && nreqd == '1'){
            hciAlert("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str12)%><a href=\"#\" onClick= \"$('.ui-dialog-titlebar-close').trigger('click'); window.parent.document.activePage('network-wireless', 6);\"><%ejGetML(MLG_WLAN_WPS_AlertMsg_Others)%></a> <%ejGetML(MLG_WLAN_WPS_AlertMsg_page)%>.", {height: 180, type: 2, title: '<%ejGetML(MLG_Common_Error)%>'});			
            enableAllColumns();
            return false;
         }
         
         var i, val;
         var cbit = getSelect(wlWepEncryption);
         var num;

         wlKeyBit.value = wlWepEncryption.options[wlWepEncryption.selectedIndex].value;
         wlWepEncryption.disabled = true;
         if (wlKeyIndex[0].checked == true) {
            num = 0;
         } else if (wlKeyIndex[1].checked == true) {
            num = 1;
         } else if (wlKeyIndex[2].checked == true) {
            num = 2;
         } else if (wlKeyIndex[3].checked == true) {
            num = 3;
         }
         else {
            msg = "<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str13)%>";
            hciAlert(msg, {height: 180, type: 2, title: ''});
            enableAllColumns();
            return false;
         }

         val = wlKeys[num].value;
         if ( val == '') {
            msg = '<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str14)%>';
            hciAlert(msg, {height: 180, type: 2, title: ''});
            enableAllColumns();
            return false;
         }
         if ( val != '' ) {
            if ( cbit == '0' ) {
               if ( isValidKey(val, 13) == false && isRepeatedStr(val, "*", 27) == false) {
                  msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str15)%>", val );
                  hciAlert(msg, {height: 180, type: 2, title: ''});
                  enableAllColumns();
                  return false;
               }
            } else {
               if ( isValidKey(val, 5) == false && isRepeatedStr(val, "*", 27) == false) {
                  msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str16)%>", val );
                  hciAlert(msg, {height: 180, type: 2, title: ''});
                  enableAllColumns();
                  return false;
               }
            }
         }
         wlKeys[0].disabled = true;
         wlKeys[1].disabled = true;
         wlKeys[2].disabled = true;
         wlKeys[3].disabled = true;
         
         error = checkUrlEncode(wlKeys[0].value);
         if(error == -1){
            wlKey1.value = encodeUrl(wlKeys[0].value);

            if(wlKey1.value.length > 26){
               wlKey1.disabled = true;
            }
            
         }else{
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str18_1)%>", (error+1) );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            return false;
         }

         error = checkUrlEncode(wlKeys[1].value);
         if(error == -1){
            wlKey2.value = encodeUrl(wlKeys[1].value);

            if(wlKey2.value.length > 26){
               wlKey2.disabled = true;
            }
            
         }else{
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str18)%>", (error+1) );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            return false;
         }
         
         error = checkUrlEncode(wlKeys[2].value);
         if(error == -1){
            wlKey3.value = encodeUrl(wlKeys[2].value);
            
            if(wlKey3.value.length > 26){
               wlKey3.disabled = true;
            }            
            
         }else{
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str19)%>", (error+1) );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            return false;
         }
         
         error = checkUrlEncode(wlKeys[3].value);
         if(error == -1){
            wlKey4.value = encodeUrl(wlKeys[3].value);

            if(wlKey4.value.length > 26){
               wlKey4.disabled = true;
            }
            
         }else{
            msg = MLG_Makestring("<%ejGetML(MLG_WLAN_BasicWirelessSetup_AlertMsg_Str20)%>", (error+1) );
            hciAlert(msg, {height: 180, type: 2, title: ''});
            return false;
         }

         if(ttfeature == 1){
		  if (cbit == 0){  //128bit
			if(wlKeys[num].value != keys128[num]){
				hciAlert("<%ejGetML(MLG_WLAN_PASSWORD_Str1)%>", {height: 250, type: 0, title: '<%ejGetML(MLG_Common_Alert)%>'});
			}
		  }
		  else{	//64bit
			if(wlKeys[num].value != keys64[num]){
				hciAlert("<%ejGetML(MLG_WLAN_PASSWORD_Str1)%>", {height: 250, type: 0, title: '<%ejGetML(MLG_Common_Alert)%>'});
			}
		  }
         }
         
      } else {
         wl_usedefaultwepkey.disabled = true;
         wl_usedefaultwpakey.disabled = true;
         wlKeyBit.disabled = true;
         wlWepEncryption.disabled = true;
		 box_unmaskwepkey.disable = true;
         wlKeyIndex[0].disabled = true;
         wlKeyIndex[1].disabled = true;
         wlKeyIndex[2].disabled = true;
         wlKeyIndex[3].disabled = true;
         wlUseDefaultWepKey.disabled = true;
         wlKeys[0].disabled = true;
         wlKeys[1].disabled = true;
         wlKeys[2].disabled = true;
         wlKeys[3].disabled = true;
         wlKey1.disabled = true;
         wlKey2.disabled = true;
         wlKey3.disabled = true;
         wlKey4.disabled = true;
      }

      if ((WscMode=='enabled') && (WscAPMode=='0')) {
         wsc_config_state.value = "1";
      } else {
         wsc_config_state.disabled = true;
      }

      if ((wlEnbl.checked == false) || (wlAuthMode.value == "wpa2") || (wlAuthMode.value == "wpa wpa2") || (wlAuthMode.value == "wpa")) {
         wl_wsc_mode.value = "disabled";
      } else {
         wl_wsc_mode.disabled = true;
      }

      if(checkMaxBandwidth()==false){
          msg = "<%ejGetML(MLG_WLAN_bandwidth_err1)%>";
          hciAlert(msg, {height: 180, type: 2, title: ''});
          return false;
      }
	  if(supportwlan == 2){
		if(wlBand.value == "1")//5G (wifi 2)
			wlDevice.value = "1";
		else if(wlBand.value == "2") //2.4G (wifi 1)
			wlDevice.value = "0";
	  }
      sessionKey.value = sessionkey;
   }

   return true;
}
function loadDevice()
{
   with (document.forms[0]) {
	  var sel_band = band;
	  var sel_Device = Device;
	  if(supportwlan == 2)
	  	wlBand.selectedIndex = sel_Device;
	  else
	  	wlBand.selectedIndex = getBandIndex(sel_band);
   	} 
}
function doSubmit() {
   if (btnApply()) {
      document.forms[0].submit();
      $.openLoadingMask(1);
   }else{
	loadDevice();
   }
}

// done hiding -->
</script>
<form action="/pages/tabFW/wireless-general.wl" method="post" onSubmit="return false;">
  <input size="15" type="hidden" name="sessionKey" />
  <input size="15" type="hidden" name="wlSyncNvram" value="1" />
  <input size="15" type="hidden" name="wlDevice" />
  <input size="15" type="hidden" name="wlHide" />
  <input size="15" type="hidden" name="wlAPIsolation" />
  <input size="15" type="hidden" name="wlBssidIsolation" />
  <input size="15" type="hidden" name="wlEnableWmf" />
  <input size="15" type="hidden" name="wlEnableButtom" />
  
  <input size="15" type="hidden" name="wlSsidIdx" />
  <input size="15" type="hidden" name="wlUseDefaultSsid" />
  <input size="15" type="hidden" name="wlAuthMode" />
  <input size="15" type="hidden" name="wlWep" />
  <input size="15" type="hidden" name="wlAuth" />
  <input size="15" type="hidden" name="wlUseDefaultWepKey" />
  <input size="15" type="hidden" name="wlUseDefaultWpaKey" />
  <input size="15" type="hidden" name="wlKeyBit" />
  <input size="15" type="hidden" name="wlKey1" />
  <input size="15" type="hidden" name="wlKey2" />
  <input size="15" type="hidden" name="wlKey3" />
  <input size="15" type="hidden" name="wlKey4" />
  <input size="15" type="hidden" name="wsc_config_state" />
  <input size="15" type="hidden" name="wl_wsc_mode" />
  <input size="15" type="hidden" name="wlWepPassphraseKey" />
  <input size="15" type="hidden" name="wlWpaPassphraseKey" />
  <input size="15" type="hidden" name="wlObssCoex" /> 

<!--  <input name="wlEmailEnable" type="HIDDEN" id="wlEmailEnable" value="0"; />	 -->
<!--  <input name="wlSelectEmailSend" type="HIDDEN" id="wlSelectEmailSend" value=""; />	 -->
<!--  <input name="wlSendEmailTo" type="HIDDEN" id="wlSendEmailTo" value=""; />	 -->	
<!--  <input name="wlSendEmailTitle" type="HIDDEN" id="wlSendEmailTitle" value=""; />	 -->
  <div class="content_frame" id="s1">
    <!--Unit Explain start-->
    <div class="explain">
      <div>
        <b class="r1"></b>
        <b class="r2"></b>
        <b class="r3"></b>
        <b class="r4"></b>
        <b class="r4"></b>
      </div>
      <div class="explain_text">
        <%ejGetML(MLG_Network_General_Str1)%>
      </div>
      <div>
        <b class="r4"></b>
        <b class="r4"></b>
        <b class="r3"></b>
        <b class="r2"></b>
        <b class="r1"></b>
      </div>
    </div>
    <!--Unit Explain End-->
    <!--Set area start-->
    <div class="data_frame">
      <ul>
        <li class="set1">
          <div class="title">
            <%ejGetML(MLG_Network_General_Str2)%>
          </div>
          <div class="w_text">
              <ul>
                <li class="left_table">
                <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str3)%></li>
              <li class="right_table">
                <input name="wlEnbl" id="wlEnbl_Enable" type="radio" value="1" /> <%ejGetML(MLG_Common_Enable)%>
                <input name="wlEnbl" id="wlEnbl_Disable" type="radio" value="0" /> <%ejGetML(MLG_Common_Disabled)%> (<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str4)%>)
              </li>
            </ul>
          </div>
          
          <div class="w_text">
              <ul>
                <li class="left_table">
                  <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str5)%> :</li>
                <li class="right_table">
                  <select name="wlBand" size="1" onChange="doSubmit();" >
<script language="javascript">
<!-- hide
if ( bands == '3' || supportwlan == 2) { // dual band or support 2 wifi cards
   document.forms[0].wlBand[0] = new Option("2.4GHz","2");
   document.forms[0].wlBand[1] = new Option("5GHz","1");
}
else if (bands == '1') {
   document.forms[0].wlBand[1] = new Option("5GHz","1");
   document.forms[0].wlBand.disabled = true;
}
else {
   document.forms[0].wlBand[0] = new Option("2.4GHz","2");
   document.forms[0].wlBand.disabled = true;
}
// done hiding -->
</script>
                  </select></li>
              </ul>
            </div>
<!--
          <div class="w_text">
            <ul>
              <li class="left_table" >
                Wireless</li>
              <li class="right_table">
                <input name="wlEnbl" type="radio" value="1" /> <%ejGetML(MLG_Common_Enable)%>
                <input name="wlEnbl" type="radio" value="0" /> <%ejGetML(MLG_Common_Disabled)%> (<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str4)%>)
              </li>
            </ul>
          </div>
-->
          <li class="set1">
            <div class="w_text">
              <ul>
                <li class="left_table">
                  <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str8)%> :</li>
                <li class="right_table">
                  <select name="wlChannel" id="wlChannel" size='1'>
                  </select>
                  <span id="cur_channel"></span>&nbsp;&nbsp;
                  <span class="linking" id="btn_more">
                    <%ejGetML(MLG_Common_more)%>...
                  </span></li>
              </ul>
            </div></li>
			<ul></ul>
          <li id="div_nMode_1" class="set1">
            <div class="w_text">
              <ul>
                <li class="left_table">
                  <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str9)%> :</li>
                <li class="right_table">
                  <select name="wlNBwCap" size="1" onChange="sidebandChange(false);" >
<script language="javascript">
<!-- hide
if (bands == '3') {
	if (supportwlan == 2 && band == '2'){
		//if support 2 wifi, internal will fix in 2.4G.
		document.forms[0].wlNBwCap[0] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str10)%>", "0");
        document.forms[0].wlNBwCap[1] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str11)%>", "1");
	}else{
		document.forms[0].wlNBwCap[0] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str12)%>", "0");
		document.forms[0].wlNBwCap[1] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str13)%>", "1");
		document.forms[0].wlNBwCap[2] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str14)%>", "2");
	}	

} else if (bands == '1'){
 //5G
document.forms[0].wlNBwCap[0] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str10)%>", "0");
document.forms[0].wlNBwCap[1] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str11)%>", "1");
if(phy == 'v'){
document.forms[0].wlNBwCap[2] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_80Mbps)%>", "3");
}
}else
{
document.forms[0].wlNBwCap[0] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str10)%>", "0");
document.forms[0].wlNBwCap[1] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str11)%>", "1");
document.forms[0].wlNBwCap[2] = new Option("<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str69)%>", "1");   //_MSTC_,yingyu.
}
// done hiding -->
</script>
                  </select></li>
              </ul>
            </div></li>
          <li id="div_nMode_2" class="set1">
            <div class="w_text">
              <ul>
                <li class="left_table">
                  <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str15)%> :</li>
                <li class="right_table">
                  <select name='wlNCtrlsb' size="1" onChange="loadChannelList(false)" >
                    <option value="-1">
                    <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str16)%>
                    </option>
                    <option value="1">
                    <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str17)%>
                    </option>
                  </select></li>
              </ul>
            </div></li>
          <li id="div_passphrase" class="set1">
            <div class="w_text">
              <ul>
                <li class="left_table">
                  <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str35)%> :</li>
                <li class="right_table">
                  <select name='wlPassphraseUI' id='wlPassphraseUI' size="1" onChange="refreshUseDefaultWepKey(0);changePassphraseType(0);detectPassphraseKey(event, 0);" >
                    <option value="0">
                    <%ejGetML(MLG_Common_None)%>
                    </option>
                    <option value="1">
                    <%ejGetML(MLG_Common_Fixed)%>
                    </option>
                    <option value="2">
                    <%ejGetML(MLG_Common_Variable)%>
                    </option>
                  </select></li>
              </ul>
            </div></li>
          <li id="div_passphrase2" class="set1">
            <div class="w_text">
              <ul>
                <li class="left_table">
                  <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str36)%> :</li>
                <li class="right_table">
                  <span id="span_pkFixed">
                    <input type="text" id='pKey1' name='pKey1' maxlength="4" size="4" onKeyUp="detectPassphraseKey(event, 1500)"/>                    -
                    <input type="text" id='pKey2' name='pKey2' maxlength="4" size="4" onKeyUp="detectPassphraseKey(event, 1500)"/>                    -
                    <input type="text" id='pKey3' name='pKey3' maxlength="4" size="4" onKeyUp="detectPassphraseKey(event, 1500)"/>                    -
                    <input type="text" id='pKey4' name='pKey4' maxlength="4" size="4" onKeyUp="detectPassphraseKey(event, 1500)"/>
                    <input type="hidden" id='pKey5' name='pKey5' maxlength="4" size="4" />
                  </span>
                  <span id="span_pkVariable">
                    <input type="text" id='pKey0' name='pKey0' maxlength="63" size="20" onKeyUp="detectPassphraseKey(event, 1500)"/>
                  </span>
                  <span id="span_pkCheck">
                  </span></li>
              </ul>
            </div></li>
          <div class="space">
          </div>
          <div class="title">
            <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str22)%>
          </div>
          <div class="w_text">
            <ul>
              <li class="left_table">
                <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str23)%>
                <span class="right_table">
                  (<%ejGetML(MLG_WLAN_AdditionalWLANs_Str4)%>)
                </span>
                :</li>
              <li class="right_table">
                <input type="text" name='wlSsid' id='wlSsid' maxlength="32" size="20" /></li>
            </ul>

            <ul id="Assoc">
              <li class="left_table">
                <%ejGetML(MLG_WLAN_General_Str1)%>:</li>
              <li class="right_table">
                <input type="text" name='wlMaxAssoc' id='wlMaxAssoc' maxlength="3" size="10" />
              </li>
            </ul>

            <ul>
              <li class="left_table">
                &nbsp;</li>
              <li class="right_table">
                <input type="checkbox" name="wl_hide" ID="wl_hide" />
                <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str24)%></li>
            </ul>
            <div id="s2">
            <ul id="apisolate">
              <li class="left_table">
                &nbsp;</li>
              <li class="right_table">
                <input type="checkbox" name="wl_apisolate" id="wl_apisolate" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str25)%>
              </li>
            </ul>
            <ul id="mbssisolate">
               <li class="left_table">&nbsp;</li>
               <li class="right_table">
                  <input type="checkbox" name="wl_mbssisolate" id="wl_mbssisolate" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str27)%>
               </li>
            </ul> 
            <ul>
              <li class="left_table">
                &nbsp;</li>
              <li class="right_table">
                <input type="checkbox" name="wl_enablewmf" id="wl_enablewmf" />
                 <%ejGetML(MLG_WLAN_BasicWirelessSetup_EnhanceMulticastForwarding)%></li>
            </ul>
			</div>
<li class="set1" id="bandwidth">
             <div class="w_text">
              <ul>
                <li class="left_table"><%ejGetML(MLG_WLAN_General_Max_Up_BW)%>: </li>
                <li class="right_table">
                  <input type="text" name="wlMaxBandwidth" size="10" maxlength="32"/> <%ejGetML(MLG_ConnStatus_Status_Str23)%>
                </li>
              </ul>
            </div>
            <div class="w_text">
              <ul>
                <li class="left_table"><%ejGetML(MLG_WLAN_General_Max_Down_BW)%>: </li>
                <li class="right_table">
                  <input type="text" name="wlMaxDownBandwidth" size="10" maxlength="32"/> <%ejGetML(MLG_ConnStatus_Status_Str23)%>
                </li>
              </ul>
            </div>
</li>
            <br>
            <!--Note define start-->
<!--
              <div class="w_text">
                  <span class="i_note"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Note)%>:</span>
               </div> <br>
               <div class="note_text">1.Max. Upstream Bandwidth:This field allow user configure the maximum bandwidth of this SSID to WAN.<br>
               2.Max. Downstream Bandwidth:This field allow user configure the maximum bandwidth of WAN to this SSID.<br>
               3.If Max. Upstream/Downstream Bandwidth is empty, the CPE sets the value automatically.
               </div>
-->
              
            <div id="WLBSSID" class="w_text">
            <ul>
              <li class="left_table">
                <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str33)%>:</li>
              <li class="right_table">
                <%ejGetWl(wlBssid)%></li>
            </ul>
            </div>
          </div></li>

   <li class="set1">
      <div class="w_text">
        <ul>
           <li class="left_table"></li>
        </ul>
      </div>
    </li>
        <li class="space"></li>
        <li class="set1" id="security_title">
          <div class="title">
            <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str61)%>
          </div>
          <div class="w_slider" style="margin-left:-50px; margin-top:20px;">
            <div class="i_wifi_img">
            </div>
            <div class="w_level_color">
              <ul>
                <li>
                <img src="../../images/i_s_bar_left.gif" /></li>
        <li class="sliderBlock s01" id='slider_none'>
          <span class="triangle"  style="margin-left:60px;">
          </span></li>
        <li class="sliderBlock s02" id='slider_basic'>
          <span class="triangle">
          </span></li>
        <li class="sliderBlock s03" id='slider_MoreSecure'>
          <span class="triangle">
          </span></li>
        <li>
        <img src="../../images/i_s_bar_right.gif" /></li>
      </ul>
    </div>
    <div class="w_draw">
      <div style="position:absolute; z-index:100; width:262px; margin:0 auto; margin-top:10px; left: 60px; top: -10px;">
        <div id='silder'>
          <a href="#"></a>
        </div>
      </div>
      <ul>
        <li class="w_draw_center">
          &nbsp;</li>
      </ul>
    </div>
    <span id ='select_1'>
      <div id="w_no" class='_off'>
        <ul>
          <li><%ejGetML(MLG_Common_NoSecurity1)%></li>
        </ul>
      </div>
      <div id="w_no_on" class='_on' style="display:none;">
        <ul>
          <li><%ejGetML(MLG_Common_NoSecurity1)%></li>
        </ul>
      </div>
    </span>
    <span id ='select_2'>
      <div id="w_basic" class='_off'>
        <ul>
          <li><%ejGetML(MLG_QOS_QOSClassSetup_Str23)%></li>
        </ul>
      </div>
      <div id="w_basic_on" style="display:none;" class='_on'>
        <ul>
          <li><%ejGetML(MLG_QOS_QOSClassSetup_Str23)%> 
          <span class="selectarrow">
          </span></li>
        </ul>
      </div>
    </span>
    <span id ='select_3'>
      <div id="w_more" style="display:none;" class='_off'>
        <ul>
          <li><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str64)%> <%ejGetML(MLG_Security_Recommended)%></li>
        </ul>
      </div>
      <div id="w_more_on" class='_on'>
        <ul>
          <li><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str64)%> <%ejGetML(MLG_Security_Recommended)%>
          <span class="selectarrow" style="margin-left:5px;">
          </span></li>
        </ul>
      </div>
    </span>
  </div></li>
  <!--Basic start-->
  <div id="wepmode" class="selectframe clearfix">
    <li class="set1">
      <div class="w_text" style="*margin-left:-15px" >
        <ul>
          <li class="left_table">
            <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str34)%>:</li>
          <li class="right_table">
            <%ejGetML(MLG_Common_WEP)%></li>
        </ul>
      </div>
      <div class="w_text" >
         <input type="checkbox" name="wl_usedefaultwepkey" id="wl_usedefaultwepkey" onClick="refreshUsePassphraseUI();refreshUseDefaultWepKey(0);detectPassphraseKey(event, 0);" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str57)%> 
      </div>
         <div class="w_text" id="wep64Note" style="display:none;"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str45)%>: <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str66)%></div> 
         <div class="w_text" id="wep128Note" style="display:none;"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str44)%>: <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str67)%></div>
         <div class="w_text3" id="wepdesc" style="display:none;"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str38)%></div>
      <div class="w_text3" >
        <ul>
          <li class="left_table">
             <input name="wlKeyIndex" type="radio" value="1" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str39)%>:
          </li>
          <li class="right_table">
            <table width="100%">
              <td valign="top">
                 <span id="text_wlKey1">0</span>
                 <input type="text" name="wlKeys" id="input_wlKey1" size='20' maxlength='26' /> 
                      <div class="w_text">
                      <input id="box_unmaskwepkey" type="checkbox" name="box_unmaskwepkey" onclick="updateCurwepkey()" />
                      <span id="wep_text_unmask"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str71)%></span>
                      </div> 
              </td>
              <td valign="top" width="32%" >
                 <span class="linking moreBtn" id="btn_wepmore" style="display:none;"><%ejGetML(MLG_Common_more)%>...</span>
              </td>
            </table>
          </li>
        </ul>
      </div>
      <!-- WEP more setting beginning -->
      <div id="wepmore"  class="clearfix">
        <div class="w_text3">
          <ul>
            <li class="left_table">
              <input name="wlKeyIndex" type="radio" value="2" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str40)%>:
            </li>
            <li class="right_table">
              <table width="100%">
                 <td valign="top">
                    <span id="text_wlKey2">0</span>
                    <input type="text" name="wlKeys" id="input_wlKey2" size='20' maxlength='26' />
                 </td>
                 <td valign="top" width="32%">
                 </td>
              </table>
            </li>
          </ul>
        </div>
        <div class="w_text3"  >
          <ul>
            <li class="left_table">
              <input name="wlKeyIndex" type="radio" value="3" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str41)%>:
            </li>
            <li class="right_table">
              <table width="100%">
                 <td valign="top">
                    <span id="text_wlKey3">0</span>
                    <input type="text" name="wlKeys"  id="input_wlKey3" size='20' maxlength='26' />
                 </td>
                 <td valign="top" width="32%">
                 </td>
              </table>
            </li>
          </ul>
        </div>
        <div class="w_text3"  >
          <ul>
            <li class="left_table">
              <input name="wlKeyIndex" type="radio" value="4" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str42)%>:
            </li>
            <li class="right_table">
              <table width="100%">
                 <td valign="top">
                    <span id="text_wlKey4">0</span>
                    <input type="text" name="wlKeys" id="input_wlKey4" size='20' maxlength='26' />
                 </td>
                 <td valign="top" width="32%">
                 </td>
              </table>
            </li>
          </ul>
        </div>
      </div>
<!-- WEPmore setting ending -->
        <div class="w_text3 ">
          <ul>
            <li class="left_table"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str43)%>:</li>
            <li class="right_table">
              <select name="wlWepEncryption" id="wlWepEncryption" onChange="refreshUsePassphraseUI();refreshUseDefaultWepKey(0);detectPassphraseKey(event, 0);">
                                 <option value="0"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str44)%></option>
                                 <option value="1"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str45)%></option>
              </select>
            </li>
          </ul>
            <div class="br"></div>
          </div>
   </li>
<div class="w_text3 ">
 <ul>
 <span class="linking" id="btn_WEPMoreNote" style="display:none;"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Note)%>:</span>
   <div id="WEPMoreNote"  class="clearfix">
	    <div class="note_text"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Eircom_Str1)%><br>
               <%ejGetML(MLG_WLAN_BasicWirelessSetup_Eircom_Str2)%><br>
               <%ejGetML(MLG_WLAN_BasicWirelessSetup_Eircom_Str3)%><br>
	    </div>	
   </div>
   </ul>
</div>              
  </div>
  <!--Basic end-->
  <!--More Security start-->
  <div id="secmode" class="selectframe clearfix">
    <ul>
      <li class="set1" >
        <div class="w_text" style="*margin-left:-15px">
          <ul>
            <li class="left_table" >
              <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str34)%>:</li>
            <li class="right_table">
               <select name="moreSecurity" id="moreSecurity" onChange="changeSecurityValue();">
               </select>
            </li>
          </ul>
        </div>
        <div id="pwd_auto" class="w_text" style="line-height:16px;">
          <ul>
              <input type="checkbox" name="wl_usedefaultwpakey" id="wl_usedefaultwpakey" onClick="refreshUsePassphraseUI();refreshUseDefaultWpaKey(0);changePassphraseKey();" /> <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str57)%> 
          </ul>
        </div>
        <!-- WPA-PSK/WPA2-PSK setting beginning -->
        <div class="space">
        </div>
        <div id="pwd">
          <div class="w_text" style="line-height:16px;">
            <div class="w_text" style="line-height:16px;"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str46)%></div>
          </div>
          <div class="w_text">
            <ul>
              <li class="left_table">
                <%ejGetML(MLG_Common_Password)%>:</li>
              <li class="right_table">
                <table width="100%">
                   <td>
                    <span id="text_wlWpaPsk">0</span>
                    <input type="text" name="wlWpaPsk" id="input_wlWpaPsk" size='20' maxlength='64' />
	                    <br>
	                    <input id="box_unmaskwpakey" type="checkbox" name="box_unmaskwpakey" onclick="updateCurwpakey()" />
						<span id="wpa_text_unmask"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str71)%></span>              	                    
                   </td>
                   <td width="32%" valign="top">
                    <span class="linking moreBtn" id="btn_wpapskmore"><%ejGetML(MLG_Common_more)%>...</span>
                    <span class="linking moreBtn" id="btn_wpa2pskmore" style="display:none;"><%ejGetML(MLG_Common_more)%>...</span>
                    <td>
                </table>                              
              </li>
            </ul>
          </div>
        </div>
        <!-- WPA-PSK/WPA2-PSK setting ending -->
        <!-- WPA/WPA2 setting beginning -->
        <div id="authserver" style="display:none;">
          <div class="w_text">
            <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str47)%>
          </div>
          <div class="w_text">
            <ul>
              <li class="left_table">
                &nbsp;&nbsp;<%ejGetML(MLG_Common_IPAddress)%>:</li>
              <li class="right_table">
                <input type="text" name="wlRadiusServerIP" size='20' maxlength='15' />
              </li>
            </ul>
          </div>
          <div class="w_text">
            <ul>
              <li class="left_table">
                &nbsp;&nbsp;<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str49)%>:</li>
              <li class="right_table">
                <input type="text" name="wlRadiusPort" size='20' maxlength='5' />
              </li>
            </ul>
          </div>
          <div class="w_text">
            <ul>
              <li class="left_table">
                &nbsp;&nbsp;<%ejGetML(MLG_WLAN_BasicWirelessSetup_Str50)%>:</li>
              <li class="right_table">

                <table width="100%">
                    <td>
                <input type="text" name="wlRadiusKey" id="wlRadiusKey" size='20' maxlength='80' />
		                <br>
		               <input id="box_unmaskradiuskey" type="checkbox" name="box_unmaskradiuskey" onclick="updateCurRadiuskey()" />
					    <span id="radius_text_unmask"><%ejGetML(MLG_WLAN_BasicWirelessSetup_Str71)%></span>              	                    
                    </td>
                    <td width="32%" valign="bottom">
		               <span class="linking moreBtn" id="btn_wpamore"><%ejGetML(MLG_Common_more)%>...</span>
		               <span class="linking moreBtn" id="btn_wpa2more"><%ejGetML(MLG_Common_more)%>...</span>
                    <td>
                </table>  
              </li>
            </ul>
          </div>
        </div>
        <!-- WPA/WPA2 setting ending -->
        <!-- only for WPA2-PSK more setting beginning -->
        <div class="w_text3" id="pskcom" style="display:none; ">
          <ul>
            <li class="left_table">
              <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str51)%>:</li>
            <li class="right_table">
              <input name="WPAPSKCompatible" type="radio" value="1" onClick="changeSecurityValue();" /> <%ejGetML(MLG_Common_Enable)%> 
                           <input type="radio" name="WPAPSKCompatible" value="0" onClick="changeSecurityValue();" /> <%ejGetML(MLG_Common_Disabled)%>
            </li>
          </ul>
        </div>
        <!-- only for WPA2-PSK more setting ending -->
        <!-- only for WPA2 more setting beginning -->
        <div class="w_text3" id="wpacom" style="display:none;">
          <ul>
            <li class="left_table">
              <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str52)%>:</li>
            <li class="right_table">
               <input name="WPACompatible" type="radio" value="0" onClick="changeSecurityValue();" /> <%ejGetML(MLG_Common_Enable)%>
               <input type="radio" name="WPACompatible" value="1" onClick="changeSecurityValue();" /> <%ejGetML(MLG_Common_DHCPDisable)%>
            </li>
          </ul>
        </div>
        <!-- only for WPA2 more setting ending -->
        <!-- WPA-PSK/WPA2-PSK/WPA more setting beginning -->
        <div class="w_text3" id="encryp" style="display:none;">
          <ul>
            <li class="left_table">
              <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str53)%>:</li>
            <li class="right_table">
               <select name="wlWpa" onChange="loadWpaEncryption(0);">
               </select>
            </li>
          </ul>
        </div>
        <!-- WPA-PSK/WPA2-PSK/WPA more setting ending -->
        <!-- only for WPA2 more setting beginning -->
        <div id="wpa2" style="display:none;">
          <div class="w_text3" >
            <ul>
              <li class="left_table">
                <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str54)%>:</li>
              <li class="right_table">
                <input name="wlPreauth" type="radio" value="1" /> <%ejGetML(MLG_Common_Enable)%>
                <input type="radio" name="wlPreauth" value="0" /> <%ejGetML(MLG_Common_DHCPDisable)%>
              </li>
            </ul>
          </div>
          <div class="w_text3" >
            <ul>
              <li class="left_table">
                <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str55)%>:</li>
              <li class="right_table">
                 <input type="text" name="wlNetReauth" size='20' maxlength='10' /> <%ejGetML(MLG_Common_Sec)%>
              </li>
            </ul>
          </div>
        </div>
        <!-- only for WPA2 more setting ending -->
        <!-- WPA-PSK/WPA2-PSK/WPA more setting beginning -->
        <div id="timer" style="display:none;">
          <div class="w_text3" >
            <ul>
              <li class="left_table">
                <%ejGetML(MLG_WLAN_BasicWirelessSetup_Str56)%>:</li>
              <li class="right_table">
                <input type="text" name="wlWpaGtkRekey" size='20' maxlength='10' />
                <%ejGetML(MLG_Common_Sec)%></li>
            </ul>
          </div>
          <div class="w_text3" >
            <ul>
              <li class="right_table">
                &nbsp;</li>
            </ul>
          </div>
        </div>
        <!-- WPA-PSK/WPA2-PSK/WPA more setting ending --></li>
    </ul>
  </div>
  <!--More Security end-->
  <li class="space"></li>
  <li class="buttonframe">
	<li class="space"></li>
    <div id="wpswifibtnhidden" align="center" >
      <input type="checkbox" name="wl_wpswifibutton" id="wl_wpswifibutton"/><%ejGetML(MLG_WLAN_BasicWirelessButtom_Str1)%>
    </div>
  </li>
  <li class="space"></li>
  <!--Button define start-->
  <li class="buttonframe">
    <div class="button_position">
      <input name="sysSubmit" id="sysSubmit" value="<%ejGetML(MLG_Common_Apply)%>" type="submit" onClick="doSubmit();" />
      &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
      <input name="Cancel" id="sysCancel" value="<%ejGetML(MLG_Common_Cancel)%>" type="reset" onClick="frmLoad();" />
    </div></li>
  <!--Button define end-->
  </ul>
  </div>
  <!--Set area end-->
  </div>
</form>
<script language="javascript">
<!-- hide
   frmLoad();
   if(TTNETMultiUser == '1')
   VisibilityLevelshow();
// done hiding -->
</script>
<br/>
<br/>
